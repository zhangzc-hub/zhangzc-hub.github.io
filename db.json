{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"node_modules/hexo-theme-volantis/source/css/Readme.md","path":"css/Readme.md","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/css/first.styl","path":"css/first.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/app.js","path":"js/app.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/aplayer.js","path":"js/plugins/aplayer.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/parallax.js","path":"js/plugins/parallax.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/rightMenu.js","path":"js/plugins/rightMenu.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/rightMenus.js","path":"js/plugins/rightMenus.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/search/hexo.js","path":"js/search/hexo.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/tags/contributors.js","path":"js/plugins/tags/contributors.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/tags/sites.js","path":"js/plugins/tags/sites.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/tags/friends.js","path":"js/plugins/tags/friends.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/Redis集群搭建.md","hash":"e6cf0deb8717139cda79d9f1f989a0ae09e0bf2e","modified":1742471962809},{"_id":"source/_posts/CentOS安装Docker.md","hash":"0bc4d8af1f230475e27b836df791b234ed9aabd6","modified":1742471951471},{"_id":"source/_posts/hello-world.md","hash":"f723510c1199ba05ead60350b9ba45fe0d0f9737","modified":1742454877563},{"_id":"source/_posts/yuque-dl.md","hash":"db15d10e175fa233ec0dcccc4b21ba0cc5131a3b","modified":1762308882006},{"_id":"source/_posts/cfssl工具制作证书.md","hash":"40dead43fdf44313bf28be6069b69cb7038399ae","modified":1762308830628},{"_id":"source/_data/firends.yml","hash":"30d678da35ad8be589ed537b84bea66b238f8248","modified":1732502854388},{"_id":"source/_posts/博客制作.md","hash":"5cc20a2a253be66519ec3492d338a1c7f3e9cde0","modified":1742471972122},{"_id":"source/about/index.md","hash":"5019819ea40fb24590d4cb5651e1c18c2311498b","modified":1732581044002},{"_id":"source/categories/index.md","hash":"6d61f6ae46a35bace9f999f89330acbe64013cce","modified":1732502854388},{"_id":"source/_posts/使用yum安装wget报错.md","hash":"69b08a187a95956edc76681e7f82a81b2dd8ed73","modified":1742454924315},{"_id":"source/friends/index.md","hash":"c2dfd4b0aac5bd326f5e598d916c5b44a8cbc6e0","modified":1732502854388},{"_id":"source/tags/index.md","hash":"62c5b86c7986b58ed3e5ded7114799f287a32930","modified":1732502854388},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/_cover/blank.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1732504436608},{"_id":"node_modules/hexo-theme-volantis/_config.yml","hash":"1d3b1d5ee64d9785683a374d58badfce3c769ca2","modified":1732504437819},{"_id":"node_modules/hexo-theme-volantis/package.json","hash":"c0629039d3f77b26877de48080edf449b3618f57","modified":1732504437656},{"_id":"node_modules/hexo-theme-volantis/languages/zh-CN.yml","hash":"3cf7e00abc512c446f8506887ee02605f7e229dd","modified":1732504437823},{"_id":"node_modules/hexo-theme-volantis/languages/zh-TW.yml","hash":"30df1cf6181375c4d05cb6dcfbdc0487ea39369c","modified":1732504437826},{"_id":"node_modules/hexo-theme-volantis/languages/en.yml","hash":"cb84db341aeab91676b603cf47bba07c57474d94","modified":1732504437822},{"_id":"node_modules/hexo-theme-volantis/layout/_pre.ejs","hash":"3ac804505c282ff8b16858037c1d2bf9305c3063","modified":1732504436080},{"_id":"node_modules/hexo-theme-volantis/layout/archive.ejs","hash":"f99913b253f8ab22f81280a6ce5145bec3cd3de6","modified":1732504436462},{"_id":"node_modules/hexo-theme-volantis/layout/category.ejs","hash":"9ee883e5f73c05b3963770b74b63d7bb7e4e1ed5","modified":1732504436722},{"_id":"node_modules/hexo-theme-volantis/layout/404.ejs","hash":"48e160ad704be637cafc433d2365fc0eb8bab8cb","modified":1732504436259},{"_id":"node_modules/hexo-theme-volantis/layout/docs.ejs","hash":"16917af05431c049aa103744a5fb2595d5848d4c","modified":1732504436848},{"_id":"node_modules/hexo-theme-volantis/layout/friends.ejs","hash":"d976c3d2180432319cc4deb503481f0c606811a6","modified":1732504436908},{"_id":"node_modules/hexo-theme-volantis/layout/layout.ejs","hash":"9fa2628f97d59796f15126ad016489d072814637","modified":1732504437205},{"_id":"node_modules/hexo-theme-volantis/layout/list.ejs","hash":"a85b2984717ee6d5058ec5635f3f287f45c3d4ba","modified":1732504437221},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/artalkcount.ejs","hash":"94c9e591e38ac00d6beafa44de4d29e70680c673","modified":1732504436519},{"_id":"node_modules/hexo-theme-volantis/layout/index.ejs","hash":"8ea7d49272b068cd1a4037846c72eb37e9823512","modified":1732504437144},{"_id":"node_modules/hexo-theme-volantis/layout/post.ejs","hash":"16917af05431c049aa103744a5fb2595d5848d4c","modified":1732504437252},{"_id":"node_modules/hexo-theme-volantis/layout/page.ejs","hash":"16917af05431c049aa103744a5fb2595d5848d4c","modified":1732504437252},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/author.ejs","hash":"68e8f198c406b6946fbf0a0f756e8a334982ba84","modified":1732504436593},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/category.ejs","hash":"e95b88bf5f8b11b4f886859cf634a72aa46c8650","modified":1732504436688},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/share.ejs","hash":"0f3b1db92319734baa8da1636340839ed2d37a7b","modified":1732504437478},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/date.ejs","hash":"ba6c554dbc6c1870debb2b87c5fa25caa089be8f","modified":1732504436826},{"_id":"node_modules/hexo-theme-volantis/layout/tag.ejs","hash":"696e7b1c70b4438e6a8d925f99cbc4222dd4035d","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/counter.ejs","hash":"1bd825605f3dacf685848b93a25269f49269b4d7","modified":1732504436787},{"_id":"node_modules/hexo-theme-volantis/LICENSE","hash":"13b0862f4ed1914abe887a47df2c3ca5adfa8f3f","modified":1732504435695},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/tags.ejs","hash":"24aae7e64ce05ddb13e793a181bfa74257a830e4","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/CHANGELOG.md","hash":"10dd4ec44677baae3cd2e099ba6731be5b97d2b2","modified":1732504437663},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/thumbnail.ejs","hash":"60045f2bf695b4be5ad3fd19db46890f1cdee68a","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/README.md","hash":"7c43923ced74698b0dfffb0ff1c53a70ad16e6fb","modified":1732504437665},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/music.ejs","hash":"2c1884e59131d47a82d2556ac28ef784b4ddaa10","modified":1732504437236},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/cover.ejs","hash":"b03a268d75dedeb8d6e29e3e352bd6cdf921545a","modified":1732504436801},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/updated.ejs","hash":"edf445ad8153419a5dc7c4ec4c8490967cd9d33d","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/walinecount.ejs","hash":"a407ec847c8f0e224efd22b7234e2921cca1d5be","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/archive.ejs","hash":"d5f776437c108c72c002b11f1d23d30b50e0079a","modified":1732504436415},{"_id":"node_modules/hexo-theme-volantis/layout/_meta/wordcount.ejs","hash":"eebaab3821af95ee64d8d56f33ca6c9c60b9b6f0","modified":1732504437512},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/article.ejs","hash":"11d61f5ce1bdc6f1fb1163e5e7a213fb5cbb6b53","modified":1732504436574},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/head.ejs","hash":"c514d24e014fbb8b28820c76fe6b3cce7353115d","modified":1732504436944},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/footer.ejs","hash":"baec06d381d8358ee6762e4b0a67d27cd0c7a511","modified":1732504436881},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/header.ejs","hash":"06ce9cd8ad7e64e83cb52cda555fd73b1c6c2b52","modified":1732504436952},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/categories.ejs","hash":"c2bc61780cab948ef8ab5076511ebccacab1cd79","modified":1732504436654},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/post.ejs","hash":"7d144c80f2980efaab6198512746c0c5d77f03db","modified":1732504437252},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/_pre.ejs","hash":"2f635098c719d9dbf0f23eeead370c6550d1ecff","modified":1732504436197},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/side.ejs","hash":"27f9df84585ffb24e2ba2423761f90f690c65787","modified":1732504437478},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/meta.ejs","hash":"ced9c966a9f4d84e485c325ef3551be218ddd033","modified":1732504437236},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/blogger.ejs","hash":"b1429acdd791cd5f00a0f0303bcd8674cf73ed52","modified":1732504436641},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/category.ejs","hash":"d8e7ad7e1418659208036a0a43cb4db2ee61abd7","modified":1732504436703},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/header.ejs","hash":"b132e332ddf12d1bb1d99480200561d8c38edd04","modified":1732504436952},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/grid.ejs","hash":"7d266197f6037f32c33bd74741730c5558417402","modified":1732504436921},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/group.ejs","hash":"2eed9614049441b51e6819f393f80faf5441870b","modified":1732504436936},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/lastupdate.ejs","hash":"c311ba4c8b255c45313dc1ab7ddafd99ec7fe8af","modified":1732504437149},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/music.ejs","hash":"2f560f3168e3811cd1d8d8a6bad9112932be9b04","modified":1732504437244},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/copyright.ejs","hash":"8e4929772970e58482f10e0867692cfcf59dee5d","modified":1732504436768},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/load.ejs","hash":"b71e0617165d5db546d22297229d7f380091fd83","modified":1732504437221},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/page.ejs","hash":"e6a20fb75a3e835a404dddd929db4d3762a367c0","modified":1732504437244},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/list.ejs","hash":"0c9319e7e81d88c721b3fe9acf6171f81faade68","modified":1732504437219},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/references.ejs","hash":"08f2dbd23fc9835f4c24bdda4cf288593d61c25a","modified":1732504437268},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/tagcloud.ejs","hash":"a68ccb41f7b589f9076a750e77e17f178af3e9d0","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/related_posts.ejs","hash":"f7a514d1f3f5ae40c6fb55d61f8b2a0bba13401c","modified":1732504437268},{"_id":"node_modules/hexo-theme-volantis/scripts/events/index.js","hash":"af7aaa4431393889671853db03c8b684265eaa50","modified":1732504437603},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/text.ejs","hash":"9302a6084c8f930532f7f8793b1b20ca1964473e","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/qrcode.ejs","hash":"128b7c6b4b2191ead4079688e55333bb97df0cdd","modified":1732504437268},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/webinfo.ejs","hash":"29b70c3e5882afa3045b1282d03f88d30ccf5e84","modified":1732504437510},{"_id":"node_modules/hexo-theme-volantis/layout/_widget/toc.ejs","hash":"200bf0096d8965e5fb7039b261317c848e36be85","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/scripts/filters/img.js","hash":"160732831bec5baf89fa07a85fec5229c3cb9cd7","modified":1732504437597},{"_id":"node_modules/hexo-theme-volantis/scripts/filters/content-visibility.js","hash":"048a8f1b80e8999d5f7a37bb8c4dabdebbebabdc","modified":1732504437551},{"_id":"node_modules/hexo-theme-volantis/source/css/style.styl","hash":"00892839230a1b05a5f9d9350baacd67d894fc85","modified":1732504437805},{"_id":"node_modules/hexo-theme-volantis/scripts/filters/replace.js","hash":"aa6fe807d7b24a60475ce8126a1be7b314cd26ba","modified":1732504437630},{"_id":"node_modules/hexo-theme-volantis/source/css/first.styl","hash":"55fe35847a1d1d831eb71288c0233efb1dd8a630","modified":1732504437732},{"_id":"node_modules/hexo-theme-volantis/scripts/filters/z-lazyload.js","hash":"df6c5b0a6eff5e655d2b8de85c646ba1e5a16535","modified":1732504437655},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/btn.js","hash":"e9b6e26f106505cf14a72524ab5e8b5bc85f362a","modified":1732504437533},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/fancybox.js","hash":"9eac73fa2d7d14ae585b302255270933641a4859","modified":1732504437564},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/contributors.js","hash":"a00573000e7ddf7a9d2f03f29fd62cb8a9752a48","modified":1732504437552},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/btns.js","hash":"648671420faa0ac00076a8c7bb011c908b83fd5a","modified":1732504437535},{"_id":"node_modules/hexo-theme-volantis/source/css/Readme.md","hash":"cf408308dcbc62f4fc2bd5aa38303b368cc88a7e","modified":1732504437674},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/folding.js","hash":"a809988c63f358e2ae903d905dc81ed80860bacd","modified":1732504437568},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/checkbox.js","hash":"0798edc6833d5978709ca5ed56aed33cea46e694","modified":1732504437543},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/friends.js","hash":"a902e1ac279014a30eda85e477c52144214cc66c","modified":1732504437572},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/dropmenu.js","hash":"19176a6edf7acc6ad31c96961e59da526f200980","modified":1732504437561},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/frame.js","hash":"e78834c005bda8f80ba86c78911b9db7566b878b","modified":1732504437569},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/md.js","hash":"66d6b7c17638e778a8796d64cd42d0c622eba67e","modified":1732504437615},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/ghcard.js","hash":"1ed7c1508180756ad4752769aa91289d37a7e23d","modified":1732504437589},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/inline-labels.js","hash":"08fbdc0ea622270e1236a28778f875c8ad2e5516","modified":1732504437611},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/image.js","hash":"63a4b3e1e3d661b6ab2b3fcfcfb657e3b632b9cb","modified":1732504437595},{"_id":"node_modules/hexo-theme-volantis/source/js/app.js","hash":"8a963d59738599a9b9a0cbce6a543c45ccb6e4e9","modified":1732504437520},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/media.js","hash":"b3871bc024d7fce9500f31073d690c4cd33bce18","modified":1732504437617},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/note.js","hash":"ac86ba50da98d9546522feaca672259620b053d8","modified":1732504437618},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/link.js","hash":"9dec9c65819d1135a7a248adaa26acbf24427cd0","modified":1732504437614},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/site.js","hash":"dd23a06f2e8a3cc70730cf199a0661777532ff0b","modified":1732504437639},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/span.js","hash":"b825115f037386797efa1b0aee3a1df21629f243","modified":1732504437642},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/table.js","hash":"ad82046fc64f932019d8a7b3e9a8ff07973a6c3b","modified":1732504437648},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/pandown.js","hash":"4d6f6dab955106ade379d6c55603e1e7eb97a107","modified":1732504437622},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/swiper.js","hash":"f0171f07f494c0b0f3f8af265344add15813a676","modified":1732504437646},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/timeline.js","hash":"9b6b88ada712a8f3a04a825cf73a409f072ed045","modified":1732504437650},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/_cover/dock.ejs","hash":"7abe0c7080dfcec063b4f52e4ca569bf0510c7c1","modified":1732504436838},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/first-style.js","hash":"ba2e2325a365704abae3f1d204b058731e21bfbf","modified":1732504437565},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/custom-files.js","hash":"8483fcdc7dbbfde40276dc3daa1ddc5e40380360","modified":1732504437559},{"_id":"node_modules/hexo-theme-volantis/scripts/tags/tabs.js","hash":"f0054f1c970cac728b3ad289a3c531c070c06896","modified":1732504437648},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/revisioned.js","hash":"57a9d91cd755f8100f149a0fe6cbb45d9c77e13c","modified":1732504437632},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/getList.js","hash":"595400c37b79599f779876808e0308ead7de0a32","modified":1732504437587},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/_cover/featured.ejs","hash":"7abe0c7080dfcec063b4f52e4ca569bf0510c7c1","modified":1732504436858},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/_cover/focus.ejs","hash":"7abe0c7080dfcec063b4f52e4ca569bf0510c7c1","modified":1732504436865},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/related-posts.js","hash":"cab8c291a8ff460b29b3248ac86827c143aca9ee","modified":1732504437627},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/scripts/index.ejs","hash":"782b9f2cf693d0a7094adac730a4d543335ea614","modified":1732504436968},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/_cover/search.ejs","hash":"2f536370d1b51fa7c33798be21e690638f0df74e","modified":1732504437478},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/scripts/content-visibility-scroll-fix.ejs","hash":"8aa467244e0976efbdc80e28dd266b0ac0bd2dc7","modified":1732504436748},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/_cover/layout.ejs","hash":"39a463ce33ce6138d40055e72118941515ba2f63","modified":1732504437155},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/scripts/_ctrl.ejs","hash":"8dd82dc0d7cd59c55d9e1239ec80c0303a4069bf","modified":1732504435885},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/analytics/script.ejs","hash":"a757c6fd89e11ab3e4cbd3e4cc02091a836fcd70","modified":1732504437268},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/darkmode/script.ejs","hash":"742f0e0988741e3eb82bb0d99a081447b45a41b1","modified":1732504437431},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/scripts/global.ejs","hash":"27a98869f648ff7aed5c290d900d4cf06e51f2f8","modified":1732504436920},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/index.ejs","hash":"462334ae298659214464f3a8af3da1c514cf76e1","modified":1732504437068},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/scripts/toc.ejs","hash":"d71bac519593ac09e9e5c521e5999925e253f4b6","modified":1732504437494},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/analytics/LCCounter.ejs","hash":"c83c4b6c3fbf37721e6e6c6e41695fa26abc770a","modified":1732504437214},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/chat/index.ejs","hash":"56d2e577fbd08859e118cfb1d1b8d230850a3675","modified":1732504437125},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/index.ejs","hash":"3d781c01f494b89d1d31d3210c100c822787c9b7","modified":1732504437134},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/aplayer/script.ejs","hash":"dc0b773f0d26c660b36625fdbd17a2d8455e6095","modified":1732504437287},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/aplayer/layout.ejs","hash":"51b4f54a165fbca56c9beec3ce19bc62f10097d9","modified":1732504437166},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/highlight/script.ejs","hash":"06befe70f47454fbfaa95245fe4cdb8d4f6f9f3c","modified":1732504437455},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/nodewaves/script.ejs","hash":"f28854fba682c345424f6217525507f0a3e2b17d","modified":1732504437463},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/end-of-support/script.ejs","hash":"b415d8e5dfca4a47c199b1adeb220ff57eaec219","modified":1732504437435},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/lazyload/script.ejs","hash":"d80dd5864200d86bc6c43d0fd1efab6538e703cf","modified":1732504437459},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/parallax/script.ejs","hash":"7c88aedd458b2c9df27e57db5c6ecb3090c58eba","modified":1732504437463},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/preload/script.ejs","hash":"1c3bf70b6df9da59c5554a921d7447e20684241d","modified":1732504437463},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/github-api/script.ejs","hash":"8c414c5c39fb6c36c2a4881463f3dc3346cc9b46","modified":1732504437440},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/pjax/animate.ejs","hash":"050f626db44ef423e5f8689447197a37f7de6e27","modified":1732504436342},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/rightmenu/layout.ejs","hash":"aa49c2498e2e61dd4ac0d68db89a1bdee86a9208","modified":1732504437177},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/pjax/pdata.ejs","hash":"eb90a00163519e6ed01a4f38380caf4dc2bd5049","modified":1732504437252},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/pjax/index.ejs","hash":"4daf9937293b6e2b4bf458d3e868da18900d2864","modified":1732504437139},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/search/script.ejs","hash":"c6525e6d76b6e968a1803fe8aea076dfc23659a0","modified":1732504437478},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/swiper/script.ejs","hash":"766ab47f4b26502fb71383ae442a1db629fe9e12","modified":1732504437478},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/rightmenus/layout.ejs","hash":"31a1787705aa13d3e0eb1aacf76bc4db869cb37a","modified":1732504437189},{"_id":"node_modules/hexo-theme-volantis/scripts/events/lib/check-configuration.js","hash":"08f383bd163383a157db177b77143c467de98a29","modified":1732504437540},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/slow-network/script.ejs","hash":"5a2f3eaadb6dbe4350e6d32094a0bad62ba240bc","modified":1732504437478},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/share/layout.ejs","hash":"f46f00d5866082bb60137b5044ead669a062bc9f","modified":1732504437199},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/scrollreveal/script.ejs","hash":"bfcd40a4c86a79d11b6ea9460f5bb6c3a60be48e","modified":1732504437463},{"_id":"node_modules/hexo-theme-volantis/scripts/events/lib/config.js","hash":"8dafa15769d43693523e435fad10b85f614a0600","modified":1732504437545},{"_id":"node_modules/hexo-theme-volantis/scripts/events/lib/render-stylus.js","hash":"36c2f32d2101eaa84041daf70393df6f3a3fa331","modified":1732504437629},{"_id":"node_modules/hexo-theme-volantis/scripts/events/lib/stellar-tag-utils.js","hash":"8d62893faf26d15d2833f8090bd6257a7282f5e2","modified":1732504437644},{"_id":"node_modules/hexo-theme-volantis/scripts/events/lib/check-environment.js","hash":"9d29a3f34ea715a0dc7cb5c2f76b5713d718e6e6","modified":1732504437541},{"_id":"node_modules/hexo-theme-volantis/source/css/_defines/AutoPrefixCSS.styl","hash":"c76f624d332c59b73c1d6b95b30b2afb560976eb","modified":1732504437686},{"_id":"node_modules/hexo-theme-volantis/source/css/_defines/color.styl","hash":"02d9bbe630f33ec2c604cb8acdddbe28431fcb05","modified":1732504437710},{"_id":"node_modules/hexo-theme-volantis/source/css/_defines/func.styl","hash":"430adedc7e6f57013e54d15e6f8dce21e9ea2579","modified":1732504437751},{"_id":"node_modules/hexo-theme-volantis/source/css/_defines/Readme.md","hash":"77d9e986d24898b98eba2010185951fd1fb8b95c","modified":1732504437668},{"_id":"node_modules/hexo-theme-volantis/source/css/_defines/fonts.styl","hash":"fa199b11b568a6b0d6fc4e87ef12ab36ac254966","modified":1732504437740},{"_id":"node_modules/hexo-theme-volantis/source/css/_first/cover_first.styl","hash":"32f0e09eba832607165096c68f70698a75d685b5","modified":1732504437714},{"_id":"node_modules/hexo-theme-volantis/source/css/_defines/layout.styl","hash":"d1bdce2e7974b1feb585adcdf95e36a054a36ec4","modified":1732504437771},{"_id":"node_modules/hexo-theme-volantis/source/css/_first/base_first.styl","hash":"0b8ae4adffce5a9243c0e7253676d03ecd4a43ba","modified":1732504437689},{"_id":"node_modules/hexo-theme-volantis/source/css/_defines/effect.styl","hash":"47db4f84182194a8a233931424c9bc79c6cf0117","modified":1732504437729},{"_id":"node_modules/hexo-theme-volantis/source/css/_first/fontfamily_first.styl","hash":"5024a9162f4787ac4234d5b8549fad40dbecf865","modified":1732504437739},{"_id":"node_modules/hexo-theme-volantis/source/css/_first/navbar_first.styl","hash":"e268d81dc78fdf9758d314cdc5cc087aec1c70e6","modified":1732504437783},{"_id":"node_modules/hexo-theme-volantis/source/css/_first/dark_first.styl","hash":"bcb419588c1972bd47869309dea43ff319440d33","modified":1732504437723},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/index.styl","hash":"835b3640c257cd229b20c088536b053b92c9796c","modified":1732504437767},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/aplayer.js","hash":"95f2e47535c8d37e90cab7726d25845cf01ca477","modified":1732504437515},{"_id":"node_modules/hexo-theme-volantis/source/css/_first/search_first.styl","hash":"955c9eb68b90b97dba0bd27909347cfc91ce68c5","modified":1732504437796},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/head/autoCanonical.js","hash":"f3ea74759129c71041371a1d77c687eb6aa88d3a","modified":1732504437524},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/parallax.js","hash":"3c3210bde6e86d7d157c34c14796abe98cb1bbd0","modified":1732504437624},{"_id":"node_modules/hexo-theme-volantis/source/js/search/hexo.js","hash":"4b4ecb0c950b95bed02e0e1274aa50c4989553a3","modified":1732504437593},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/index.js","hash":"bcb770787c77e39cdc156b7fd58cde8e00b79153","modified":1732504437607},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/rightMenu.js","hash":"cb2f17ab10127065f7b9f5f87a49921d25b287e1","modified":1732504437634},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/rightMenus.js","hash":"877f548870ea7f63a46de071a120aaea96dd4a25","modified":1732504437637},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/scripts/_ctrl/cdnCtrl.ejs","hash":"8fe3924efab31cf8a6d7ad07a2985b01a2154acb","modified":1732504436739},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/head/generate_preload_fontfamily.js","hash":"d37dbe38fa9125fdce99b2ef9e92582ed08eea82","modified":1732504437577},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/head/generate_seo.js","hash":"e0059a60cc5978be6792dcf795a2ece3a509f41a","modified":1732504437580},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/artitalk/index.ejs","hash":"98fb39a1ac55b9af0c1501b051ac2698a3684686","modified":1732504436983},{"_id":"node_modules/hexo-theme-volantis/layout/_partial/scripts/_ctrl/coverCtrl.ejs","hash":"ee3f2108e61db024466b08beddb895ad97330f63","modified":1732504436813},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/katex/index.ejs","hash":"159e21313df49ef1ab14122bfe7e02d2d4f6fcdf","modified":1732504437080},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/head/generate_title__keywords__description.js","hash":"179a07b7b2270398216a34d79595d98e30962b22","modified":1732504437585},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/mathjax/index.ejs","hash":"91a412d8324fbacd7a340e4ad031b4e917a16f2f","modified":1732504437105},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/bbtalk/index.ejs","hash":"bd513c00f6d5fb57e504db7e89c3326d9f68dd88","modified":1732504437010},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/fcircle/index.ejs","hash":"2a220187916a0474a083a8f716c0a3b9a8f57548","modified":1732504437025},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/indent/index.ejs","hash":"7d112cde9b8d1785d8c541cde94361e0bfc60f30","modified":1732504437056},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/gitter/index.ejs","hash":"e90bf8daf46f34ca9b37049154dda6d1f155d037","modified":1732504437042},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/_page_plugins/snackbar/index.ejs","hash":"bddb75f7112d2b438f462a6ebef79810ef5ac291","modified":1732504437114},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/artalk/script.ejs","hash":"799633e92efc6abb5d0a9ded8b6db70948dcddad","modified":1732504437338},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/chat/tidio/script.ejs","hash":"bb678b5e8a9fb87fc1c1e48914da3a1a052a8e02","modified":1732504437329},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/chat/gitter/script.ejs","hash":"e4f06c50c23d433a0e63fc703a35704c336ba090","modified":1732504437300},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/gitalk/script.ejs","hash":"00a20cd4a398204b1193b0e9d3fac2c5f32daad3","modified":1732504437384},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/disqusjs/script.ejs","hash":"569912aebbde81490e57ab2ce49e35bf678723f2","modified":1732504437370},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/beaudar/script.ejs","hash":"285226000b8bff1f96b8b69da268a0af79d04b98","modified":1732504437347},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/discuss/script.ejs","hash":"b8a13e121923d31a5b6870be84c69e5587f4f0ce","modified":1732504437357},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/livere/script.ejs","hash":"54340ba16d4f46ed4f3c6f67ac7ba1a2e68be67a","modified":1732504437402},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/hashover/script.ejs","hash":"7ecd8879c66b907da04093a465d346f6569cee83","modified":1732504437390},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/disqus/script.ejs","hash":"3a67befc560e6d0695f64c05d82c68ee9771a1a7","modified":1732504437363},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/waline/script.ejs","hash":"945fa1928c6bd1599134b8627b35d3dd7cd79013","modified":1732504437422},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/giscus/script.ejs","hash":"45fe8d3e47d2a990292426d14091cffa46301704","modified":1732504437377},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/isso/script.ejs","hash":"aa7c81e6df9b803966efe5eda8edbc85b924f34b","modified":1732504437395},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/utterances/script.ejs","hash":"afbb35e59b3b3af34627416ee47ecad1d564bdbc","modified":1732504437411},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/twikoo/script.ejs","hash":"c0fc694962e94a478b85ae7adb95917fc5f8f2c4","modified":1732504437407},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/vssue/script.ejs","hash":"8171fdfbe668277942eaa55847ba646532d245eb","modified":1732504437418},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/comments/z-custom/script.ejs","hash":"e5cfe25fb88b7a3dd0c68e20b2e17d44eb2a1f04","modified":1732504437426},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/article.styl","hash":"8d9fe767bb92fc57681817f21af7b2cdc07b0dc3","modified":1732504437685},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/highlight/prismjs/script.ejs","hash":"1349c07f6a1f3efca0a00f483c918d091007d9b3","modified":1732504437446},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_base/fontfamily_async.styl","hash":"48c006682b8f44681662e4b0f8d3ebfdf85add69","modified":1732504437738},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/archive.styl","hash":"a96709230abbc8d4fc40361b8fc02d4249abb4a1","modified":1732504437682},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/footer.styl","hash":"bb850b4707ee025e267e079fcf85484849cf4f41","modified":1732504437742},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/friends-simpleuser.styl","hash":"07c477e15bf75615faff5587cc82dbc6004a901a","modified":1732504437747},{"_id":"node_modules/hexo-theme-volantis/layout/_plugins/highlight/highlightjs/script.ejs","hash":"3ffdc0dea93efd49b23910fe7a295784c7053b97","modified":1732504437445},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/friends-traditional.styl","hash":"2da0419cd5874d03d7d5bafdb081beb6cb786608","modified":1732504437748},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/loading.styl","hash":"56a2b9f46edd5b87e49d11647dc9396b0d833d54","modified":1732504437771},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/md.styl","hash":"d9b25d8199d3d5260c89e8ad84f1a17531b85588","modified":1732504437771},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/main.styl","hash":"d75ac5fd9ee7cddcbaa421d676c2ae0c4501b121","modified":1732504437771},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/pagination.styl","hash":"65dacf95771fc518a06cbf301f4c0b06201d7321","modified":1732504437786},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/posts.styl","hash":"31cf7bdbb44caa173f3dfd49d98157cb6be85c6f","modified":1732504437791},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/img.styl","hash":"55d79f07b717d3e28515b41401f656d1593be624","modified":1732504437757},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/search.styl","hash":"ac9f4c4f6e1ac38757dfeae3483a55983e1491d0","modified":1732504437797},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/sidebar.styl","hash":"4b75b29b67b88ef5ee365535d521c3ee8256a1ea","modified":1732504437799},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/snackbar.styl","hash":"752a7fea5284a61fd9305d3b0fcaa43f2e64862f","modified":1732504437803},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/video.styl","hash":"680e8cf8fc5d62913dad4ccd06135caad2bb3e92","modified":1732504437817},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_base/base.styl","hash":"712eb4803dc595eb111ebd89546e6ed3fb1ec7ce","modified":1732504437693},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_layout/toc.styl","hash":"3346fbcbcbc2533997a8bf1fbbf801d9120b03ab","modified":1732504437815},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/cursor.styl","hash":"bc055048c7d017be8cf25a3385f516656c96cf66","modified":1732504437715},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/aplayer.styl","hash":"da809e1dde8adb9d1c98f0daeb52a2d920d497f7","modified":1732504437678},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/index.styl","hash":"a18de4930b88f62e557e62e8fbb9e2ce550c5d49","modified":1732504437765},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/gitalk.styl","hash":"c4c9950fd6654f87ca4f481cf3065ca4069fac48","modified":1732504437755},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/Readme.md","hash":"51986550e80990e1db23e2ee4165e5e4800e4b9f","modified":1732504437670},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/mathjax.styl","hash":"11ee86571f31f9aa61dcc48b40977dcd974d76a4","modified":1732504437771},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/fontcolor.styl","hash":"fa13f91f8be68b62210048d1481c3b23e23f939b","modified":1732504437736},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/message.styl","hash":"995b46084664f2ed2cf025c1a208089ecfe1147e","modified":1732504437781},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/dropmenu.styl","hash":"a136ebb90bedef15c1d8b8d75e09b37c3873f5e8","modified":1732504437727},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/checkbox.styl","hash":"8c62dd38914d939069d9222c54787a24cb5c31f7","modified":1732504437697},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/folding.styl","hash":"253f13e60218e0d014a1df99933f5cdba507f3b1","modified":1732504437733},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/fancybox.styl","hash":"1b4709787f9bda8ce565aa9a4aaf7f1f58751b44","modified":1732504437730},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/btns.styl","hash":"bf592cd78c146bb671217f106632b9e5bcc7c145","modified":1732504437695},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/image.styl","hash":"bb4b07841602592e421597ba8dd7110edec789d8","modified":1732504437756},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/frame.styl","hash":"6ffbb29514781aa4fa7d7653706554ce33f4525b","modified":1732504437744},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/media.styl","hash":"576c9eede3a8f9ec2ba1a970e92a49154ec3acb3","modified":1732504437771},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/friends.styl","hash":"8f9e60b94c02197e4555f923d357017742bf8d7b","modified":1732504437750},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/ghcard.styl","hash":"58adb206695a704b1f40df42e2dc10e9e9055aeb","modified":1732504437752},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/link.styl","hash":"82cdcc537612eec3e1af40d00edf80b14116c191","modified":1732504437771},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/note.styl","hash":"005d3c55c2216d7c88661f79ad466ad89fad4784","modified":1732504437784},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/sites.styl","hash":"01593f3b8a233bc2c3193796707e4ed77df217bb","modified":1732504437801},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/pjaxanimate.styl","hash":"86c80d1d1c8a02c0eb4c0b5d29ff41c9a5dd5ac3","modified":1732504437788},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/span.styl","hash":"6e9f8b453244d9241d3fceed0a56e12c86a4b446","modified":1732504437804},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/swiper.styl","hash":"819385594f1825e26074ade900835a3f4031fe42","modified":1732504437808},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/tabs.styl","hash":"a2366f4fe1d9f06e47a7a994cfc80a1edbf6c535","modified":1732504437810},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/tags/contributors.js","hash":"cf1af362cf73c83a28ae2651eb1daafaed2ec91f","modified":1732504437556},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/text.styl","hash":"b2c2f3946fb611ad052c61d7309098edbf494c86","modified":1732504437812},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/table.styl","hash":"ef07ab4fe8a391ea9039fbe53333aaf58e3ce033","modified":1732504437809},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/lib/blogposting.js","hash":"f8543b0460c9a5b23ee43d8ed49e018c1c627439","modified":1732504437528},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/lib/organization.js","hash":"02c08f0362aec5d310b8c7e69823cd88ed49ea5e","modified":1732504437620},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/tag.json","hash":"506f87e397f258b097ba24ce16c33b5353bab462","modified":1732504437661},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/tags/friends.js","hash":"7d53cf366638d0e254f7f26de01c8892710d1d23","modified":1732504437575},{"_id":"node_modules/hexo-theme-volantis/source/js/plugins/tags/sites.js","hash":"47b0ff4a3ccea2da9b60023cb4288f979504b0c7","modified":1732504437640},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/lib/config.js","hash":"e4c3c23e58f0bac72010f962d92da641445e748a","modified":1732504437548},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/lib/breadcrumblist.js","hash":"df6316082af2df061f16bb01d5b5d3478f98c662","modified":1732504437529},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/lib/index.js","hash":"41e4af773dfb4755752cb74a6d70e4b5b0c1ce4d","modified":1732504437608},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_tag-plugins/timeline.styl","hash":"f84f411a3b7dcdbfd4fb19ac4e0f91300c5e19be","modified":1732504437814},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/lib/person.js","hash":"afca448311d62a44566d9471594a43495a6be6db","modified":1732504437626},{"_id":"node_modules/hexo-theme-volantis/scripts/helpers/structured-data/lib/website.js","hash":"556f28164d31b3898d06cb8f76472bc6547bb1db","modified":1732504437652},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/index.styl","hash":"6c681c760fa63425e7564c0d68532bb5ac95690a","modified":1732504437761},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_dark/dark_async.styl","hash":"a5da6f0b232a767057321fa51e382fd2d86bd98d","modified":1732504437719},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_dark/dark_plugins.styl","hash":"c56c2271847809e21e4938d770577622aeb161aa","modified":1732504437726},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/prismjs/clipboard.styl","hash":"0f92935e3bb9732b6e1cc7f305577144f1fe99a8","modified":1732504437708},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/prismjs/index.styl","hash":"215face68fab1c31cfa8d4c21941c72efe54cb78","modified":1732504437763},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/clipboard.styl","hash":"6818ba853fd6a319ff4eb50d228b1d625db9a0fd","modified":1732504437703},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_rightmenu/reading.styl","hash":"cb01065424dbd32c79b973b06fcdbc1c72917bc6","modified":1732504437792},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_rightmenu/rightmenu.styl","hash":"ef456a92173c303b61015f3581450aa14f0d2b41","modified":1732504437793},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/prismjs/language.styl","hash":"3af7fae25a0e2c54f0aacb1d8cbe383d5c1e60a5","modified":1732504437769},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/language.styl","hash":"4fade2fe067f557d3b420d0b9a9d88d18feb9a72","modified":1732504437768},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/index.styl","hash":"38089b686a0cfdde555539c1c0c5b3fe402afada","modified":1732504437758},{"_id":"node_modules/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/color.styl","hash":"319ccc46d5d387ee14a22e0de1a518288331629b","modified":1732504437712},{"_id":"public/content.json","hash":"aec69905dba2ce26b9717323c4fe94fa09e29a57","modified":1762309306461},{"_id":"public/about/index.html","hash":"4019e887639b9461f6c1d75a5164d0c5264c9018","modified":1762309306461},{"_id":"public/friends/index.html","hash":"19596af98a35b79c5b67ccb4760628a0c66ea395","modified":1762309306461},{"_id":"public/tags/index.html","hash":"e3ee5e4a46f77e73930130242d829461b068db42","modified":1762309306461},{"_id":"public/categories/index.html","hash":"a360e4d9ad427bbf6413472d36e303c6f50d6450","modified":1762309306461},{"_id":"public/2025/07/01/cfssl工具制作证书/index.html","hash":"71d174561c1db6214c931daf03efa004abbb3941","modified":1762241192062},{"_id":"public/2025/05/21/yuque-dl/index.html","hash":"56df4486058e0f5bccf471a13c2f8d0f735bf815","modified":1762241192062},{"_id":"public/2025/03/20/Redis集群搭建/index.html","hash":"13de257abacfb7ae5763aab68945d97d5290304b","modified":1762309306461},{"_id":"public/2024/01/13/使用yum安装wget报错/index.html","hash":"6c42850a36474648389f21f67dec3e7e18929d81","modified":1762309306461},{"_id":"public/2023/12/19/CentOS安装Docker/index.html","hash":"222947734464f5fb158ade3221d9cec8059ee2c4","modified":1762309306461},{"_id":"public/2023/11/25/博客制作/index.html","hash":"06798eeec88e7ecc0af7ca311b591bea19ebeac6","modified":1762309306461},{"_id":"public/archives/index.html","hash":"20725bc0fff7a8a0d8d860813ec8e3c2dd062bdb","modified":1762309306461},{"_id":"public/2023/10/24/hello-world/index.html","hash":"f4be48b8c1d9b3331c0202945c123d213ff9eb42","modified":1762309306461},{"_id":"public/archives/2023/index.html","hash":"63ce8e796db06725b783df8f5afb807c92719d99","modified":1762309306461},{"_id":"public/archives/2023/10/index.html","hash":"92b7c5317895ae52f76b3311c5bbae3580435451","modified":1762309306461},{"_id":"public/archives/2023/11/index.html","hash":"4135395c82a9d0ace88e7652adf587bf3f6ba0ac","modified":1762309306461},{"_id":"public/archives/2023/12/index.html","hash":"b74032dee4c65f1ba0a4980ee34fcfe64b55cd12","modified":1762309306461},{"_id":"public/archives/2024/01/index.html","hash":"7eca6c87fa88ec3051ea9a1eda0764871929ec4b","modified":1762309306461},{"_id":"public/archives/2024/index.html","hash":"341fd8a8114c823fa1dfaaccfcf9aa723cc8cefb","modified":1762309306461},{"_id":"public/archives/2025/index.html","hash":"8c332119f3863c19e834a16499756ce0390142d5","modified":1762309306461},{"_id":"public/archives/2025/03/index.html","hash":"26ee5bc8b45435bc8c16cdc07951a1711392dc72","modified":1762309306461},{"_id":"public/archives/2025/05/index.html","hash":"54e7d667679f9310e0b0ed9fc4802fcab6173afb","modified":1762241192062},{"_id":"public/archives/2025/07/index.html","hash":"adafbfbfbe4d4336671c9157c2a30d41739242ea","modified":1762241192062},{"_id":"public/categories/Linux/index.html","hash":"5d465c8fd515d9700d57fa45ffd856c177646466","modified":1762309306461},{"_id":"public/categories/ssl/index.html","hash":"c106801bcc7b81b432f4a0e4caf829af4ca6ba11","modified":1762309306461},{"_id":"public/categories/Hello-World/index.html","hash":"dc65f30286d8af21761400d360fa7b349e03bad3","modified":1762309306461},{"_id":"public/categories/cmd/index.html","hash":"e38ff6a2b4bdc659ab8dd0f0375bca2e5eeea7a3","modified":1762309306461},{"_id":"public/categories/hexo/index.html","hash":"d6e33e25949a63c48fb9347bc76998c3d57d5e38","modified":1762309306461},{"_id":"public/tags/redis/index.html","hash":"acf7f72a57245a1a2f7ea8e7bde07f07440e2377","modified":1762309306461},{"_id":"public/tags/docker/index.html","hash":"45bfb30ee3f4ac4ed208afaa892c2bf85b9d4687","modified":1762309306461},{"_id":"public/tags/ssl/index.html","hash":"c92adc7293a16a3840f9cbe6f0824a8be80dd7bd","modified":1762309306461},{"_id":"public/index.html","hash":"aba0c1e4ff4250ba7c40daa1e097706c97e288b2","modified":1762309306461},{"_id":"public/tags/Hello-World/index.html","hash":"cd0b45b84c6427ac1501dbe22572178044ab40ec","modified":1762309306461},{"_id":"public/tags/yum/index.html","hash":"fa5cf4fccbaa1b3a9d161eadf980824f9a4cbf68","modified":1762309306461},{"_id":"public/tags/博客/index.html","hash":"984d72eb63367bc8511389b272af7ca382fad049","modified":1762309306461},{"_id":"public/tags/语雀/index.html","hash":"9636582a7bc27b1cf84c24442093adc92542624d","modified":1762309306461},{"_id":"public/css/Readme.html","hash":"942e993f16d5c13b617561506efbed0088016a5d","modified":1751350717104},{"_id":"public/css/style.css","hash":"5ddec98cb15d4c238d5601e675140a87c3f2e182","modified":1751350717104},{"_id":"public/js/plugins/parallax.js","hash":"3c3210bde6e86d7d157c34c14796abe98cb1bbd0","modified":1751350717104},{"_id":"public/css/first.css","hash":"0aa53d87bc3fcff9f199d8fdc8d4fdac17120861","modified":1751350717104},{"_id":"public/js/plugins/rightMenu.js","hash":"58d3b19e244f20cb24b0c24120d3f00fc26dc5fe","modified":1751350717104},{"_id":"public/js/plugins/rightMenus.js","hash":"2532b97ea0215add163f74216a23b3f8f4949407","modified":1751350717104},{"_id":"public/js/plugins/aplayer.js","hash":"95f2e47535c8d37e90cab7726d25845cf01ca477","modified":1751350717104},{"_id":"public/js/plugins/tags/contributors.js","hash":"cf1af362cf73c83a28ae2651eb1daafaed2ec91f","modified":1751350717104},{"_id":"public/js/plugins/tags/sites.js","hash":"47b0ff4a3ccea2da9b60023cb4288f979504b0c7","modified":1751350717104},{"_id":"public/js/search/hexo.js","hash":"4b4ecb0c950b95bed02e0e1274aa50c4989553a3","modified":1751350717104},{"_id":"public/js/plugins/tags/friends.js","hash":"7d53cf366638d0e254f7f26de01c8892710d1d23","modified":1751350717104},{"_id":"public/js/app.js","hash":"8a963d59738599a9b9a0cbce6a543c45ccb6e4e9","modified":1751350717104},{"_id":"source/_posts/SpringCache框架的使用.md","hash":"1eda82bc82b723ef1ab69fd305b7c9a509efbc78","modified":1762227332336},{"_id":"public/2024/08/08/SpringCache框架的使用/index.html","hash":"f0d35c9b21bc32a486029cbaa5d7a941c2661536","modified":1762309306461},{"_id":"public/categories/Java/index.html","hash":"0d2992650cb53b44e373cf484ff33e8679773a73","modified":1762309306461},{"_id":"public/archives/2024/08/index.html","hash":"2023801803e79e5ac214f1553c115a5573418bae","modified":1762309306461},{"_id":"source/_posts/MySQL主从复制+读写分离.md","hash":"5926d9a9491489dc766fbc075ec66fe0f6893e0b","modified":1762308810696},{"_id":"public/2025/08/13/MySQL主从复制+读写分离/index.html","hash":"0ad4d4a304f26f14b24f4774480d79f3697b0778","modified":1762241192062},{"_id":"public/categories/MySQL/index.html","hash":"7f0ef0056eae1e310cafdf1b29aaa084b4774330","modified":1762309306461},{"_id":"public/archives/2025/08/index.html","hash":"b1766f541f5d804432f004c9d007e9efe8873b67","modified":1762241192062},{"_id":"public/tags/MySQL/index.html","hash":"e47a8da09451b9ffb1d42bc97206a44187a0d79d","modified":1762309306461},{"_id":"source/_posts/若依框架中使用Velocity模块引擎改造代码生成功能.md","hash":"3076b464717ed945f1d3390ab1107d50eae1d4ef","modified":1762308907748},{"_id":"public/2025/11/04/若依框架中使用Velocity模块引擎改造代码生成功能/index.html","hash":"c99a4ad1ee74bb44c9a8e483bf882e48dab41a55","modified":1762241192062},{"_id":"public/archives/2025/11/index.html","hash":"3de598593a80199e283123c884bb47fe84796930","modified":1762241192062},{"_id":"public/tags/若依/index.html","hash":"290686e2d3f55637d82874908d54277751fb0002","modified":1762309306461},{"_id":"source/_posts/MySQL常见数据类型.md","hash":"d860010f7d0bfbb3cf0c5e9b0f3677946f0f93a3","modified":1762309227322},{"_id":"public/2024/08/13/MySQL主从复制+读写分离/index.html","hash":"4d6c176b7761a591300961e2f99dd1d356f8e167","modified":1762309306461},{"_id":"public/2025/09/04/若依框架中使用Velocity模块引擎改造代码生成功能/index.html","hash":"7f76a4052b7c50f5dc095f7a43ae1c8a787e1fdd","modified":1762309306461},{"_id":"public/2024/04/05/MySQL常见数据类型/index.html","hash":"4fa3c39b86a687cd5d8ae3cb8cbb6ffe8136fb90","modified":1762309306461},{"_id":"public/2024/05/21/yuque-dl/index.html","hash":"3cc2a238b9df1d252cff180154135b3929291701","modified":1762309306461},{"_id":"public/2024/07/01/cfssl工具制作证书/index.html","hash":"86bc746150992ff45d9737fe6e34842103d9397c","modified":1762309306461},{"_id":"public/archives/page/2/index.html","hash":"98379d83e7cc8939990f43c2417b8d3ecb24af13","modified":1762309306461},{"_id":"public/archives/2024/04/index.html","hash":"50ed511ffece972e142313a9570a2aba9f50cb6f","modified":1762309306461},{"_id":"public/archives/2024/05/index.html","hash":"a4425b1f3a2a96cc38ea62d474bd0c487a738950","modified":1762309306461},{"_id":"public/archives/2024/07/index.html","hash":"b377203412839a99467bd298b75ad6ae9db919af","modified":1762309306461},{"_id":"public/archives/2025/09/index.html","hash":"3832aa238dd94fbd124e6bc573ab0c4263d7e532","modified":1762309306461},{"_id":"public/page/2/index.html","hash":"b290e17385318fdf558511cad86ebb3b77832172","modified":1762309306461}],"Category":[{"name":"Linux","_id":"cmck4zyrd0004t0amay293dk5"},{"name":"ssl","_id":"cmck4zyrh000bt0am0g674ay6"},{"name":"Hello World","_id":"cmck4zyrk000lt0amgpw1dykj"},{"name":"cmd","_id":"cmck4zyrk000qt0am35jbetna"},{"name":"hexo","_id":"cmck4zyrl000ut0amgxa6ae4v"},{"name":"Java","_id":"cme2819co00019wam3h18ecda"},{"name":"MySQL","_id":"cme9p6cff0001xoam3gm3dqgg"}],"Data":[{"_id":"firends","data":[{"group":"分组1","description":"友情链接","items":[{"title":"ZhangZC","avatar":null,"url":"https://www.baidu.com","screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}],"Page":[{"layout":"docs","seo_title":"关于","bottom_meta":false,"sidebar":[],"twikoo":{"placeholder":"有什么想对我说的呢？"},"_content":"\n### **技术与梦想的交汇点 —— 我的故事**\n\n大家好，欢迎来到我的小天地！我是ZC，一名对科技充满热情的探索者。在这个日新月异的时代，我坚信技术不仅仅是工具，更是改变世界的力量。今天，我想与大家分享我的旅程，以及那些激励我前行的故事。\n\n#### **一、起点**\n\n我的故事始于一个普通的小城市。从小我就对电子设备充满了好奇，经常拆解家里的收音机、遥控器等，试图了解它们是如何工作的。这份好奇心随着年龄的增长而愈发强烈，最终引领我走上了计算机科学的道路。\n\n#### **二、求学之路**\n\n大学时期，我选择了计算机科学作为我的专业。在校园里，我不仅学到了编程的基础知识，更重要的是，我学会了如何思考问题、解决问题。参与各类项目比赛的经历让我意识到，团队合作与创新思维同样重要。这些宝贵的经验为我后来的职业生涯打下了坚实的基础。\n\n#### **三、职业发展**\n\n毕业后，我加入了一家知名的互联网公司，担任软件工程师一职。在这里，我有幸参与到多个大型项目的开发中，见证了从概念设计到产品上线的全过程。这段经历极大地拓宽了我的视野，也加深了我对技术变革社会潜力的认识。\n\n随着时间的推移，我逐渐意识到，仅仅作为一名开发者并不足以满足我对世界的渴望。我渴望将自己的想法与更多人分享，于是决定开设这个博客，希望能够成为一个连接技术与人文的桥梁。\n\n#### **四、创建博客**\n\n创建这个博客的目的很简单：分享知识、激发灵感、促进交流。我希望通过撰写技术文章、行业观察以及个人感悟，不仅能够帮助读者解决实际问题，更能激发他们对未来的想象。我相信，每个人都有潜力成为改变世界的一份子。\n\n#### **五、展望未来**\n\n未来，我将继续走在技术的前沿，不断学习新的知识和技术。同时，我也希望通过这个平台，与更多的志同道合者相遇，共同探讨技术如何更好地服务于人类社会。无论前方道路如何变化，我都将保持初心，勇敢前行。\n\n感谢每一位访问者，因为有了你们的支持与陪伴，这段旅程才更加精彩。期待在未来的日子里，我们能够一起见证更多的奇迹发生。","source":"about/index.md","raw":"---\nlayout: docs\nseo_title: 关于\nbottom_meta: false\nsidebar: []\ntwikoo:\n  placeholder: 有什么想对我说的呢？\n---\n\n### **技术与梦想的交汇点 —— 我的故事**\n\n大家好，欢迎来到我的小天地！我是ZC，一名对科技充满热情的探索者。在这个日新月异的时代，我坚信技术不仅仅是工具，更是改变世界的力量。今天，我想与大家分享我的旅程，以及那些激励我前行的故事。\n\n#### **一、起点**\n\n我的故事始于一个普通的小城市。从小我就对电子设备充满了好奇，经常拆解家里的收音机、遥控器等，试图了解它们是如何工作的。这份好奇心随着年龄的增长而愈发强烈，最终引领我走上了计算机科学的道路。\n\n#### **二、求学之路**\n\n大学时期，我选择了计算机科学作为我的专业。在校园里，我不仅学到了编程的基础知识，更重要的是，我学会了如何思考问题、解决问题。参与各类项目比赛的经历让我意识到，团队合作与创新思维同样重要。这些宝贵的经验为我后来的职业生涯打下了坚实的基础。\n\n#### **三、职业发展**\n\n毕业后，我加入了一家知名的互联网公司，担任软件工程师一职。在这里，我有幸参与到多个大型项目的开发中，见证了从概念设计到产品上线的全过程。这段经历极大地拓宽了我的视野，也加深了我对技术变革社会潜力的认识。\n\n随着时间的推移，我逐渐意识到，仅仅作为一名开发者并不足以满足我对世界的渴望。我渴望将自己的想法与更多人分享，于是决定开设这个博客，希望能够成为一个连接技术与人文的桥梁。\n\n#### **四、创建博客**\n\n创建这个博客的目的很简单：分享知识、激发灵感、促进交流。我希望通过撰写技术文章、行业观察以及个人感悟，不仅能够帮助读者解决实际问题，更能激发他们对未来的想象。我相信，每个人都有潜力成为改变世界的一份子。\n\n#### **五、展望未来**\n\n未来，我将继续走在技术的前沿，不断学习新的知识和技术。同时，我也希望通过这个平台，与更多的志同道合者相遇，共同探讨技术如何更好地服务于人类社会。无论前方道路如何变化，我都将保持初心，勇敢前行。\n\n感谢每一位访问者，因为有了你们的支持与陪伴，这段旅程才更加精彩。期待在未来的日子里，我们能够一起见证更多的奇迹发生。","date":"2024-11-26T00:30:44.002Z","updated":"2024-11-26T00:30:44.002Z","path":"about/index.html","title":"","comments":1,"_id":"cmck4zyr70000t0am230w3yzg","content":"<h3 id=\"技术与梦想的交汇点-——-我的故事\"><a href=\"#技术与梦想的交汇点-——-我的故事\" class=\"headerlink\" title=\"技术与梦想的交汇点 —— 我的故事\"></a><strong>技术与梦想的交汇点 —— 我的故事</strong></h3><p>大家好，欢迎来到我的小天地！我是ZC，一名对科技充满热情的探索者。在这个日新月异的时代，我坚信技术不仅仅是工具，更是改变世界的力量。今天，我想与大家分享我的旅程，以及那些激励我前行的故事。</p>\n<h4 id=\"一、起点\"><a href=\"#一、起点\" class=\"headerlink\" title=\"一、起点\"></a><strong>一、起点</strong></h4><p>我的故事始于一个普通的小城市。从小我就对电子设备充满了好奇，经常拆解家里的收音机、遥控器等，试图了解它们是如何工作的。这份好奇心随着年龄的增长而愈发强烈，最终引领我走上了计算机科学的道路。</p>\n<h4 id=\"二、求学之路\"><a href=\"#二、求学之路\" class=\"headerlink\" title=\"二、求学之路\"></a><strong>二、求学之路</strong></h4><p>大学时期，我选择了计算机科学作为我的专业。在校园里，我不仅学到了编程的基础知识，更重要的是，我学会了如何思考问题、解决问题。参与各类项目比赛的经历让我意识到，团队合作与创新思维同样重要。这些宝贵的经验为我后来的职业生涯打下了坚实的基础。</p>\n<h4 id=\"三、职业发展\"><a href=\"#三、职业发展\" class=\"headerlink\" title=\"三、职业发展\"></a><strong>三、职业发展</strong></h4><p>毕业后，我加入了一家知名的互联网公司，担任软件工程师一职。在这里，我有幸参与到多个大型项目的开发中，见证了从概念设计到产品上线的全过程。这段经历极大地拓宽了我的视野，也加深了我对技术变革社会潜力的认识。</p>\n<p>随着时间的推移，我逐渐意识到，仅仅作为一名开发者并不足以满足我对世界的渴望。我渴望将自己的想法与更多人分享，于是决定开设这个博客，希望能够成为一个连接技术与人文的桥梁。</p>\n<h4 id=\"四、创建博客\"><a href=\"#四、创建博客\" class=\"headerlink\" title=\"四、创建博客\"></a><strong>四、创建博客</strong></h4><p>创建这个博客的目的很简单：分享知识、激发灵感、促进交流。我希望通过撰写技术文章、行业观察以及个人感悟，不仅能够帮助读者解决实际问题，更能激发他们对未来的想象。我相信，每个人都有潜力成为改变世界的一份子。</p>\n<h4 id=\"五、展望未来\"><a href=\"#五、展望未来\" class=\"headerlink\" title=\"五、展望未来\"></a><strong>五、展望未来</strong></h4><p>未来，我将继续走在技术的前沿，不断学习新的知识和技术。同时，我也希望通过这个平台，与更多的志同道合者相遇，共同探讨技术如何更好地服务于人类社会。无论前方道路如何变化，我都将保持初心，勇敢前行。</p>\n<p>感谢每一位访问者，因为有了你们的支持与陪伴，这段旅程才更加精彩。期待在未来的日子里，我们能够一起见证更多的奇迹发生。</p>\n","excerpt":"","more":"<h3 id=\"技术与梦想的交汇点-——-我的故事\"><a href=\"#技术与梦想的交汇点-——-我的故事\" class=\"headerlink\" title=\"技术与梦想的交汇点 —— 我的故事\"></a><strong>技术与梦想的交汇点 —— 我的故事</strong></h3><p>大家好，欢迎来到我的小天地！我是ZC，一名对科技充满热情的探索者。在这个日新月异的时代，我坚信技术不仅仅是工具，更是改变世界的力量。今天，我想与大家分享我的旅程，以及那些激励我前行的故事。</p>\n<h4 id=\"一、起点\"><a href=\"#一、起点\" class=\"headerlink\" title=\"一、起点\"></a><strong>一、起点</strong></h4><p>我的故事始于一个普通的小城市。从小我就对电子设备充满了好奇，经常拆解家里的收音机、遥控器等，试图了解它们是如何工作的。这份好奇心随着年龄的增长而愈发强烈，最终引领我走上了计算机科学的道路。</p>\n<h4 id=\"二、求学之路\"><a href=\"#二、求学之路\" class=\"headerlink\" title=\"二、求学之路\"></a><strong>二、求学之路</strong></h4><p>大学时期，我选择了计算机科学作为我的专业。在校园里，我不仅学到了编程的基础知识，更重要的是，我学会了如何思考问题、解决问题。参与各类项目比赛的经历让我意识到，团队合作与创新思维同样重要。这些宝贵的经验为我后来的职业生涯打下了坚实的基础。</p>\n<h4 id=\"三、职业发展\"><a href=\"#三、职业发展\" class=\"headerlink\" title=\"三、职业发展\"></a><strong>三、职业发展</strong></h4><p>毕业后，我加入了一家知名的互联网公司，担任软件工程师一职。在这里，我有幸参与到多个大型项目的开发中，见证了从概念设计到产品上线的全过程。这段经历极大地拓宽了我的视野，也加深了我对技术变革社会潜力的认识。</p>\n<p>随着时间的推移，我逐渐意识到，仅仅作为一名开发者并不足以满足我对世界的渴望。我渴望将自己的想法与更多人分享，于是决定开设这个博客，希望能够成为一个连接技术与人文的桥梁。</p>\n<h4 id=\"四、创建博客\"><a href=\"#四、创建博客\" class=\"headerlink\" title=\"四、创建博客\"></a><strong>四、创建博客</strong></h4><p>创建这个博客的目的很简单：分享知识、激发灵感、促进交流。我希望通过撰写技术文章、行业观察以及个人感悟，不仅能够帮助读者解决实际问题，更能激发他们对未来的想象。我相信，每个人都有潜力成为改变世界的一份子。</p>\n<h4 id=\"五、展望未来\"><a href=\"#五、展望未来\" class=\"headerlink\" title=\"五、展望未来\"></a><strong>五、展望未来</strong></h4><p>未来，我将继续走在技术的前沿，不断学习新的知识和技术。同时，我也希望通过这个平台，与更多的志同道合者相遇，共同探讨技术如何更好地服务于人类社会。无论前方道路如何变化，我都将保持初心，勇敢前行。</p>\n<p>感谢每一位访问者，因为有了你们的支持与陪伴，这段旅程才更加精彩。期待在未来的日子里，我们能够一起见证更多的奇迹发生。</p>\n"},{"layout":"tag","index":true,"title":"所有标签","_content":"","source":"tags/index.md","raw":"---\nlayout: tag\nindex: true\ntitle: 所有标签\n---","date":"2024-11-25T11:22:46.949Z","updated":"2024-11-25T02:47:34.388Z","path":"tags/index.html","comments":1,"_id":"cmck4zyrc0002t0amb9kg4roy","content":"","excerpt":"","more":""},{"layout":"friends","title":"我的朋友们","_content":"\n这里写友链上方的内容。\n\n<!-- more -->\n\n这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。","source":"friends/index.md","raw":"---\nlayout: friends # 必须\ntitle: 我的朋友们 # 可选，这是友链页的标题\n---\n\n这里写友链上方的内容。\n\n<!-- more -->\n\n这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。","date":"2024-11-25T11:22:55.110Z","updated":"2024-11-25T02:47:34.388Z","path":"friends/index.html","comments":1,"_id":"cmck4zyrf0006t0amgqif0bkx","content":"<p>这里写友链上方的内容。</p>\n<span id=\"more\"></span>\n\n<p>这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。</p>\n","excerpt":"<p>这里写友链上方的内容。</p>","more":"<p>这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。</p>"},{"layout":"category","index":true,"title":"所有分类","_content":"","source":"categories/index.md","raw":"---\nlayout: category\nindex: true\ntitle: 所有分类\n---","date":"2024-11-25T11:23:05.900Z","updated":"2024-11-25T02:47:34.388Z","path":"categories/index.html","comments":1,"_id":"cmck4zyrf0008t0amap9j5dnz","content":"","excerpt":"","more":""}],"Post":[{"title":"CentOS安装Docker\\Docker-compose","date":"2023-12-19T05:53:20.000Z","_content":"\n# CentOS安装Docker\\Docker-compose\n\n\n\n# CentOS安装Docker\n\n## 1、卸载（可选）\n\n如果之前安装过旧版本的Docker，可以使用下面命令卸载：\n\n```\nyum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-selinux \\\n                  docker-engine-selinux \\\n                  docker-engine \\\n                  docker-ce\n```\n\n## 2、安装docker\n\n首先需要大家虚拟机联网，安装yum工具\n\n```\nyum install -y yum-utils \\\n           device-mapper-persistent-data \\\n           lvm2 --skip-broken\n```\n\n然后更新本地镜像源：\n\n```\n# 设置docker镜像源\nyum-config-manager \\\n    --add-repo \\\n    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n    \n#将所有的 download.docker.com 替换为 mirrors.aliyun.com/docker-ce\nsed -i 's/download.docker.com/mirrors.aliyun.com\\/docker-ce/g' /etc/yum.repos.d/docker-ce.repo\n\n#输入以下命令来更新 yum 缓存\nyum makecache fast\n```\n\n然后输入命令：\n\n```\nyum install -y docker-ce\n```\n\ndocker-ce为社区免费版本。稍等片刻，docker即可安装成功。\n\n## 3、启动docker\n\nDocker应用需要用到各种端口，逐一去修改防火墙设置。\n\n这里展示直接关闭防火墙的命令\n\n```\n# 关闭\nsystemctl stop firewalld\n# 禁止开机启动防火墙\nsystemctl disable firewalld\n```\n\n通过命令启动docker：\n\n```\nsystemctl start docker  # 启动docker服务\n\nsystemctl stop docker  # 停止docker服务\n\nsystemctl restart docker  # 重启docker服务\n\nsystemctl enable docker  # 开机自启docker服务\n\nsystemctl start docker  # 启动docker服务\n```\n\n然后输入命令，可以查看docker版本：\n\n```\ndocker -v\n```\n\n## 4、配置镜像加速\n\ndocker官方镜像仓库网速较差，导致拉取镜像失败，如下面这种错误，\n\n```\ndocker pull 报错 Error response from daemon: Get “https://registry-1.docker.io/v2/“\n```\n\n我们需要设置国内镜像服务：\n\n解决方案如下：\n\n```\nvi /etc/docker/daemon.json\n```\n\n添加以下内容：\n\n```\n{\n  \"data-root\": \"/home/docker-root\",\n  \"registry-mirrors\": [\n  \t\"https://registry.dockercn.com\",\n  \t\"https://0mmuy3ea.mirror.aliyuncs.com/\",\"https://docker.m.daocloud.io/\"\n  \t]\n}\n```\n\n然后保存\n\n```\n:wq\n```\n\n重启docker\n\n```\nsystemctl daemon-reload\nsystemctl restart  docker\n```\n\n# centos安装docker-compose\n\n## 1、最新版本查询\n\nDocker Compose 的最新版本会不断更新，你可以通过以下几种方式来查看目前的最新版本：\n\n- **官方发布页面**：访问 [Docker Compose 的 GitHub 发布页面](https://github.com/docker/compose/releases)，该页面会列出所有的版本信息，页面上显示的最新版本就是目前可获取的最新版本。\n- **命令行查看**：如果你已经安装了 Docker Compose，在终端中执行 `docker-compose version` 命令，就能看到当前安装的版本。要是想知道是否有更新版本，还是要参考官方发布页面。\n\n## 2、安装最新版本\n\n如果要安装最新版本的 Docker Compose，可以参考以下步骤（以 Linux 系统为例）：\n\n```\n# 获取最新稳定版本号\nCOMPOSE_VERSION=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep 'tag_name' | cut -d\\\" -f4)\n\n# 下载指定版本的 Docker Compose\nsudo curl -L \"https://github.com/docker/compose/releases/download/${COMPOSE_VERSION}/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n\n# 添加可执行权限\nsudo chmod +x /usr/local/bin/docker-compose\n\n# 验证安装\ndocker-compose --version\n```\n\n上述脚本会自动获取最新版本号并完成 Docker Compose 的下载和安装，最后验证安装是否成功。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-41-14.jpg)\n\n## 3、获取最新版本补全脚本\n\n若要使用最新版本的 Docker Compose 补全脚本，你可以把命令中的版本号替换成最新版本。获取最新版本号的方式有多种，例如访问 [Docker Compose 的 GitHub 发布页面](https://github.com/docker/compose/releases)。\n\n假设你已经得知最新版本是 `v2.20.3`（实际使用时请替换为真正的最新版本），可以使用如下命令获取对应版本的补全脚本：\n\n```\nsudo curl -L https://raw.githubusercontent.com/docker/compose/v2.20.3/contrib/completion/bash/docker-compose > /etc/bash_completion.d/docker-compose\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-43-19.jpg)\n\n运行完该命令后，重新打开一个终端让补全功能生效。\n\n## 4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\n\n当你下载了 `compose-2.34.0.tar.gz` 文件后，通常意味着你下载的是 Docker Compose 的源码包，下面为你介绍安装 Docker Compose 的操作步骤：\n\n### 1. 解压文件\n\n你需要使用 `tar` 命令来解压下载的 `compose-2.34.0.tar.gz` 文件。在终端中执行以下命令：\n\nbash\n\n```\ntar -zxvf compose-2.34.0.tar.gz\n```\n\n该命令会将压缩包解压到当前目录下，解压后会生成一个名为 `compose-2.34.0` 的文件夹。\n\n### 2. 进入解压后的目录\n\n使用 `cd` 命令进入解压后的文件夹：\n\nbash\n\n```\ncd compose-2.34.0\n```\n\n### 3. 构建并安装 Docker Compose\n\n一般情况下，你可以使用 `make` 命令来构建和安装 Docker Compose。不过在执行 `make` 命令之前，需要确保你的系统已经安装了 `make` 工具和其他必要的依赖项。执行以下命令：\n\nbash\n\n```\nmake\nsudo make install\n```\n\n- `make` 命令会根据 `Makefile` 文件中的规则来编译和构建 Docker Compose。\n- `sudo make install` 命令会将构建好的二进制文件安装到系统中，使其可以在全局范围内使用。\n\n### 4. 验证安装\n\n安装完成后，你可以使用以下命令来验证 Docker Compose 是否安装成功：\n\nbash\n\n```\ndocker-compose --version\n```\n\n如果输出显示 Docker Compose 的版本为 2.34.0，则说明安装成功。\n\n### 可能遇到的问题及解决办法\n\n- **缺少依赖项**：如果在执行 `make` 命令时出现错误，提示缺少某些依赖项，你需要安装这些依赖项。常见的依赖项包括 `go` 语言环境等。你可以根据错误提示安装相应的依赖项。\n- **权限问题**：如果在执行 `sudo make install` 命令时遇到权限问题，确保你具有足够的权限。通常使用 `sudo` 命令可以解决权限问题。","source":"_posts/CentOS安装Docker.md","raw":"---\ntitle: CentOS安装Docker\\Docker-compose\ndate: 2023-12-19 13:53:20\ntags:\n- docker\ncategories:\n- Linux\n---\n\n# CentOS安装Docker\\Docker-compose\n\n\n\n# CentOS安装Docker\n\n## 1、卸载（可选）\n\n如果之前安装过旧版本的Docker，可以使用下面命令卸载：\n\n```\nyum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-selinux \\\n                  docker-engine-selinux \\\n                  docker-engine \\\n                  docker-ce\n```\n\n## 2、安装docker\n\n首先需要大家虚拟机联网，安装yum工具\n\n```\nyum install -y yum-utils \\\n           device-mapper-persistent-data \\\n           lvm2 --skip-broken\n```\n\n然后更新本地镜像源：\n\n```\n# 设置docker镜像源\nyum-config-manager \\\n    --add-repo \\\n    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n    \n#将所有的 download.docker.com 替换为 mirrors.aliyun.com/docker-ce\nsed -i 's/download.docker.com/mirrors.aliyun.com\\/docker-ce/g' /etc/yum.repos.d/docker-ce.repo\n\n#输入以下命令来更新 yum 缓存\nyum makecache fast\n```\n\n然后输入命令：\n\n```\nyum install -y docker-ce\n```\n\ndocker-ce为社区免费版本。稍等片刻，docker即可安装成功。\n\n## 3、启动docker\n\nDocker应用需要用到各种端口，逐一去修改防火墙设置。\n\n这里展示直接关闭防火墙的命令\n\n```\n# 关闭\nsystemctl stop firewalld\n# 禁止开机启动防火墙\nsystemctl disable firewalld\n```\n\n通过命令启动docker：\n\n```\nsystemctl start docker  # 启动docker服务\n\nsystemctl stop docker  # 停止docker服务\n\nsystemctl restart docker  # 重启docker服务\n\nsystemctl enable docker  # 开机自启docker服务\n\nsystemctl start docker  # 启动docker服务\n```\n\n然后输入命令，可以查看docker版本：\n\n```\ndocker -v\n```\n\n## 4、配置镜像加速\n\ndocker官方镜像仓库网速较差，导致拉取镜像失败，如下面这种错误，\n\n```\ndocker pull 报错 Error response from daemon: Get “https://registry-1.docker.io/v2/“\n```\n\n我们需要设置国内镜像服务：\n\n解决方案如下：\n\n```\nvi /etc/docker/daemon.json\n```\n\n添加以下内容：\n\n```\n{\n  \"data-root\": \"/home/docker-root\",\n  \"registry-mirrors\": [\n  \t\"https://registry.dockercn.com\",\n  \t\"https://0mmuy3ea.mirror.aliyuncs.com/\",\"https://docker.m.daocloud.io/\"\n  \t]\n}\n```\n\n然后保存\n\n```\n:wq\n```\n\n重启docker\n\n```\nsystemctl daemon-reload\nsystemctl restart  docker\n```\n\n# centos安装docker-compose\n\n## 1、最新版本查询\n\nDocker Compose 的最新版本会不断更新，你可以通过以下几种方式来查看目前的最新版本：\n\n- **官方发布页面**：访问 [Docker Compose 的 GitHub 发布页面](https://github.com/docker/compose/releases)，该页面会列出所有的版本信息，页面上显示的最新版本就是目前可获取的最新版本。\n- **命令行查看**：如果你已经安装了 Docker Compose，在终端中执行 `docker-compose version` 命令，就能看到当前安装的版本。要是想知道是否有更新版本，还是要参考官方发布页面。\n\n## 2、安装最新版本\n\n如果要安装最新版本的 Docker Compose，可以参考以下步骤（以 Linux 系统为例）：\n\n```\n# 获取最新稳定版本号\nCOMPOSE_VERSION=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep 'tag_name' | cut -d\\\" -f4)\n\n# 下载指定版本的 Docker Compose\nsudo curl -L \"https://github.com/docker/compose/releases/download/${COMPOSE_VERSION}/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n\n# 添加可执行权限\nsudo chmod +x /usr/local/bin/docker-compose\n\n# 验证安装\ndocker-compose --version\n```\n\n上述脚本会自动获取最新版本号并完成 Docker Compose 的下载和安装，最后验证安装是否成功。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-41-14.jpg)\n\n## 3、获取最新版本补全脚本\n\n若要使用最新版本的 Docker Compose 补全脚本，你可以把命令中的版本号替换成最新版本。获取最新版本号的方式有多种，例如访问 [Docker Compose 的 GitHub 发布页面](https://github.com/docker/compose/releases)。\n\n假设你已经得知最新版本是 `v2.20.3`（实际使用时请替换为真正的最新版本），可以使用如下命令获取对应版本的补全脚本：\n\n```\nsudo curl -L https://raw.githubusercontent.com/docker/compose/v2.20.3/contrib/completion/bash/docker-compose > /etc/bash_completion.d/docker-compose\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-43-19.jpg)\n\n运行完该命令后，重新打开一个终端让补全功能生效。\n\n## 4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\n\n当你下载了 `compose-2.34.0.tar.gz` 文件后，通常意味着你下载的是 Docker Compose 的源码包，下面为你介绍安装 Docker Compose 的操作步骤：\n\n### 1. 解压文件\n\n你需要使用 `tar` 命令来解压下载的 `compose-2.34.0.tar.gz` 文件。在终端中执行以下命令：\n\nbash\n\n```\ntar -zxvf compose-2.34.0.tar.gz\n```\n\n该命令会将压缩包解压到当前目录下，解压后会生成一个名为 `compose-2.34.0` 的文件夹。\n\n### 2. 进入解压后的目录\n\n使用 `cd` 命令进入解压后的文件夹：\n\nbash\n\n```\ncd compose-2.34.0\n```\n\n### 3. 构建并安装 Docker Compose\n\n一般情况下，你可以使用 `make` 命令来构建和安装 Docker Compose。不过在执行 `make` 命令之前，需要确保你的系统已经安装了 `make` 工具和其他必要的依赖项。执行以下命令：\n\nbash\n\n```\nmake\nsudo make install\n```\n\n- `make` 命令会根据 `Makefile` 文件中的规则来编译和构建 Docker Compose。\n- `sudo make install` 命令会将构建好的二进制文件安装到系统中，使其可以在全局范围内使用。\n\n### 4. 验证安装\n\n安装完成后，你可以使用以下命令来验证 Docker Compose 是否安装成功：\n\nbash\n\n```\ndocker-compose --version\n```\n\n如果输出显示 Docker Compose 的版本为 2.34.0，则说明安装成功。\n\n### 可能遇到的问题及解决办法\n\n- **缺少依赖项**：如果在执行 `make` 命令时出现错误，提示缺少某些依赖项，你需要安装这些依赖项。常见的依赖项包括 `go` 语言环境等。你可以根据错误提示安装相应的依赖项。\n- **权限问题**：如果在执行 `sudo make install` 命令时遇到权限问题，确保你具有足够的权限。通常使用 `sudo` 命令可以解决权限问题。","slug":"CentOS安装Docker","published":1,"updated":"2025-03-20T11:59:11.471Z","comments":1,"layout":"post","photos":[],"_id":"cmck4zyra0001t0am67c6c7ro","content":"<h1 id=\"CentOS安装Docker-Docker-compose\"><a href=\"#CentOS安装Docker-Docker-compose\" class=\"headerlink\" title=\"CentOS安装Docker\\Docker-compose\"></a>CentOS安装Docker\\Docker-compose</h1><h1 id=\"CentOS安装Docker\"><a href=\"#CentOS安装Docker\" class=\"headerlink\" title=\"CentOS安装Docker\"></a>CentOS安装Docker</h1><h2 id=\"1、卸载（可选）\"><a href=\"#1、卸载（可选）\" class=\"headerlink\" title=\"1、卸载（可选）\"></a>1、卸载（可选）</h2><p>如果之前安装过旧版本的Docker，可以使用下面命令卸载：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove docker \\</span><br><span class=\"line\">                  docker-client \\</span><br><span class=\"line\">                  docker-client-latest \\</span><br><span class=\"line\">                  docker-common \\</span><br><span class=\"line\">                  docker-latest \\</span><br><span class=\"line\">                  docker-latest-logrotate \\</span><br><span class=\"line\">                  docker-logrotate \\</span><br><span class=\"line\">                  docker-selinux \\</span><br><span class=\"line\">                  docker-engine-selinux \\</span><br><span class=\"line\">                  docker-engine \\</span><br><span class=\"line\">                  docker-ce</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、安装docker\"><a href=\"#2、安装docker\" class=\"headerlink\" title=\"2、安装docker\"></a>2、安装docker</h2><p>首先需要大家虚拟机联网，安装yum工具</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y yum-utils \\</span><br><span class=\"line\">           device-mapper-persistent-data \\</span><br><span class=\"line\">           lvm2 --skip-broken</span><br></pre></td></tr></table></figure>\n\n<p>然后更新本地镜像源：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 设置docker镜像源</span><br><span class=\"line\">yum-config-manager \\</span><br><span class=\"line\">    --add-repo \\</span><br><span class=\"line\">    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class=\"line\">    </span><br><span class=\"line\">#将所有的 download.docker.com 替换为 mirrors.aliyun.com/docker-ce</span><br><span class=\"line\">sed -i &#x27;s/download.docker.com/mirrors.aliyun.com\\/docker-ce/g&#x27; /etc/yum.repos.d/docker-ce.repo</span><br><span class=\"line\"></span><br><span class=\"line\">#输入以下命令来更新 yum 缓存</span><br><span class=\"line\">yum makecache fast</span><br></pre></td></tr></table></figure>\n\n<p>然后输入命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y docker-ce</span><br></pre></td></tr></table></figure>\n\n<p>docker-ce为社区免费版本。稍等片刻，docker即可安装成功。</p>\n<h2 id=\"3、启动docker\"><a href=\"#3、启动docker\" class=\"headerlink\" title=\"3、启动docker\"></a>3、启动docker</h2><p>Docker应用需要用到各种端口，逐一去修改防火墙设置。</p>\n<p>这里展示直接关闭防火墙的命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 关闭</span><br><span class=\"line\">systemctl stop firewalld</span><br><span class=\"line\"># 禁止开机启动防火墙</span><br><span class=\"line\">systemctl disable firewalld</span><br></pre></td></tr></table></figure>\n\n<p>通过命令启动docker：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start docker  # 启动docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl stop docker  # 停止docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl restart docker  # 重启docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable docker  # 开机自启docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start docker  # 启动docker服务</span><br></pre></td></tr></table></figure>\n\n<p>然后输入命令，可以查看docker版本：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4、配置镜像加速\"><a href=\"#4、配置镜像加速\" class=\"headerlink\" title=\"4、配置镜像加速\"></a>4、配置镜像加速</h2><p>docker官方镜像仓库网速较差，导致拉取镜像失败，如下面这种错误，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull 报错 Error response from daemon: Get “https://registry-1.docker.io/v2/“</span><br></pre></td></tr></table></figure>\n\n<p>我们需要设置国内镜像服务：</p>\n<p>解决方案如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>\n\n<p>添加以下内容：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;data-root&quot;: &quot;/home/docker-root&quot;,</span><br><span class=\"line\">  &quot;registry-mirrors&quot;: [</span><br><span class=\"line\">  \t&quot;https://registry.dockercn.com&quot;,</span><br><span class=\"line\">  \t&quot;https://0mmuy3ea.mirror.aliyuncs.com/&quot;,&quot;https://docker.m.daocloud.io/&quot;</span><br><span class=\"line\">  \t]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后保存</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:wq</span><br></pre></td></tr></table></figure>\n\n<p>重启docker</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl daemon-reload</span><br><span class=\"line\">systemctl restart  docker</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"centos安装docker-compose\"><a href=\"#centos安装docker-compose\" class=\"headerlink\" title=\"centos安装docker-compose\"></a>centos安装docker-compose</h1><h2 id=\"1、最新版本查询\"><a href=\"#1、最新版本查询\" class=\"headerlink\" title=\"1、最新版本查询\"></a>1、最新版本查询</h2><p>Docker Compose 的最新版本会不断更新，你可以通过以下几种方式来查看目前的最新版本：</p>\n<ul>\n<li><strong>官方发布页面</strong>：访问 <a href=\"https://github.com/docker/compose/releases\">Docker Compose 的 GitHub 发布页面</a>，该页面会列出所有的版本信息，页面上显示的最新版本就是目前可获取的最新版本。</li>\n<li><strong>命令行查看</strong>：如果你已经安装了 Docker Compose，在终端中执行 <code>docker-compose version</code> 命令，就能看到当前安装的版本。要是想知道是否有更新版本，还是要参考官方发布页面。</li>\n</ul>\n<h2 id=\"2、安装最新版本\"><a href=\"#2、安装最新版本\" class=\"headerlink\" title=\"2、安装最新版本\"></a>2、安装最新版本</h2><p>如果要安装最新版本的 Docker Compose，可以参考以下步骤（以 Linux 系统为例）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 获取最新稳定版本号</span><br><span class=\"line\">COMPOSE_VERSION=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep &#x27;tag_name&#x27; | cut -d\\&quot; -f4)</span><br><span class=\"line\"></span><br><span class=\"line\"># 下载指定版本的 Docker Compose</span><br><span class=\"line\">sudo curl -L &quot;https://github.com/docker/compose/releases/download/$&#123;COMPOSE_VERSION&#125;/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class=\"line\"></span><br><span class=\"line\"># 添加可执行权限</span><br><span class=\"line\">sudo chmod +x /usr/local/bin/docker-compose</span><br><span class=\"line\"></span><br><span class=\"line\"># 验证安装</span><br><span class=\"line\">docker-compose --version</span><br></pre></td></tr></table></figure>\n\n<p>上述脚本会自动获取最新版本号并完成 Docker Compose 的下载和安装，最后验证安装是否成功。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-41-14.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-41-14.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h2 id=\"3、获取最新版本补全脚本\"><a href=\"#3、获取最新版本补全脚本\" class=\"headerlink\" title=\"3、获取最新版本补全脚本\"></a>3、获取最新版本补全脚本</h2><p>若要使用最新版本的 Docker Compose 补全脚本，你可以把命令中的版本号替换成最新版本。获取最新版本号的方式有多种，例如访问 <a href=\"https://github.com/docker/compose/releases\">Docker Compose 的 GitHub 发布页面</a>。</p>\n<p>假设你已经得知最新版本是 <code>v2.20.3</code>（实际使用时请替换为真正的最新版本），可以使用如下命令获取对应版本的补全脚本：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo curl -L https://raw.githubusercontent.com/docker/compose/v2.20.3/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-43-19.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-43-19.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>运行完该命令后，重新打开一个终端让补全功能生效。</p>\n<h2 id=\"4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\"><a href=\"#4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\" class=\"headerlink\" title=\"4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\"></a>4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：</h2><p>当你下载了 <code>compose-2.34.0.tar.gz</code> 文件后，通常意味着你下载的是 Docker Compose 的源码包，下面为你介绍安装 Docker Compose 的操作步骤：</p>\n<h3 id=\"1-解压文件\"><a href=\"#1-解压文件\" class=\"headerlink\" title=\"1. 解压文件\"></a>1. 解压文件</h3><p>你需要使用 <code>tar</code> 命令来解压下载的 <code>compose-2.34.0.tar.gz</code> 文件。在终端中执行以下命令：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf compose-2.34.0.tar.gz</span><br></pre></td></tr></table></figure>\n\n<p>该命令会将压缩包解压到当前目录下，解压后会生成一个名为 <code>compose-2.34.0</code> 的文件夹。</p>\n<h3 id=\"2-进入解压后的目录\"><a href=\"#2-进入解压后的目录\" class=\"headerlink\" title=\"2. 进入解压后的目录\"></a>2. 进入解压后的目录</h3><p>使用 <code>cd</code> 命令进入解压后的文件夹：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd compose-2.34.0</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-构建并安装-Docker-Compose\"><a href=\"#3-构建并安装-Docker-Compose\" class=\"headerlink\" title=\"3. 构建并安装 Docker Compose\"></a>3. 构建并安装 Docker Compose</h3><p>一般情况下，你可以使用 <code>make</code> 命令来构建和安装 Docker Compose。不过在执行 <code>make</code> 命令之前，需要确保你的系统已经安装了 <code>make</code> 工具和其他必要的依赖项。执行以下命令：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>make</code> 命令会根据 <code>Makefile</code> 文件中的规则来编译和构建 Docker Compose。</li>\n<li><code>sudo make install</code> 命令会将构建好的二进制文件安装到系统中，使其可以在全局范围内使用。</li>\n</ul>\n<h3 id=\"4-验证安装\"><a href=\"#4-验证安装\" class=\"headerlink\" title=\"4. 验证安装\"></a>4. 验证安装</h3><p>安装完成后，你可以使用以下命令来验证 Docker Compose 是否安装成功：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose --version</span><br></pre></td></tr></table></figure>\n\n<p>如果输出显示 Docker Compose 的版本为 2.34.0，则说明安装成功。</p>\n<h3 id=\"可能遇到的问题及解决办法\"><a href=\"#可能遇到的问题及解决办法\" class=\"headerlink\" title=\"可能遇到的问题及解决办法\"></a>可能遇到的问题及解决办法</h3><ul>\n<li><strong>缺少依赖项</strong>：如果在执行 <code>make</code> 命令时出现错误，提示缺少某些依赖项，你需要安装这些依赖项。常见的依赖项包括 <code>go</code> 语言环境等。你可以根据错误提示安装相应的依赖项。</li>\n<li><strong>权限问题</strong>：如果在执行 <code>sudo make install</code> 命令时遇到权限问题，确保你具有足够的权限。通常使用 <code>sudo</code> 命令可以解决权限问题。</li>\n</ul>\n","excerpt":"","more":"<h1 id=\"CentOS安装Docker-Docker-compose\"><a href=\"#CentOS安装Docker-Docker-compose\" class=\"headerlink\" title=\"CentOS安装Docker\\Docker-compose\"></a>CentOS安装Docker\\Docker-compose</h1><h1 id=\"CentOS安装Docker\"><a href=\"#CentOS安装Docker\" class=\"headerlink\" title=\"CentOS安装Docker\"></a>CentOS安装Docker</h1><h2 id=\"1、卸载（可选）\"><a href=\"#1、卸载（可选）\" class=\"headerlink\" title=\"1、卸载（可选）\"></a>1、卸载（可选）</h2><p>如果之前安装过旧版本的Docker，可以使用下面命令卸载：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove docker \\</span><br><span class=\"line\">                  docker-client \\</span><br><span class=\"line\">                  docker-client-latest \\</span><br><span class=\"line\">                  docker-common \\</span><br><span class=\"line\">                  docker-latest \\</span><br><span class=\"line\">                  docker-latest-logrotate \\</span><br><span class=\"line\">                  docker-logrotate \\</span><br><span class=\"line\">                  docker-selinux \\</span><br><span class=\"line\">                  docker-engine-selinux \\</span><br><span class=\"line\">                  docker-engine \\</span><br><span class=\"line\">                  docker-ce</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、安装docker\"><a href=\"#2、安装docker\" class=\"headerlink\" title=\"2、安装docker\"></a>2、安装docker</h2><p>首先需要大家虚拟机联网，安装yum工具</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y yum-utils \\</span><br><span class=\"line\">           device-mapper-persistent-data \\</span><br><span class=\"line\">           lvm2 --skip-broken</span><br></pre></td></tr></table></figure>\n\n<p>然后更新本地镜像源：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 设置docker镜像源</span><br><span class=\"line\">yum-config-manager \\</span><br><span class=\"line\">    --add-repo \\</span><br><span class=\"line\">    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class=\"line\">    </span><br><span class=\"line\">#将所有的 download.docker.com 替换为 mirrors.aliyun.com/docker-ce</span><br><span class=\"line\">sed -i &#x27;s/download.docker.com/mirrors.aliyun.com\\/docker-ce/g&#x27; /etc/yum.repos.d/docker-ce.repo</span><br><span class=\"line\"></span><br><span class=\"line\">#输入以下命令来更新 yum 缓存</span><br><span class=\"line\">yum makecache fast</span><br></pre></td></tr></table></figure>\n\n<p>然后输入命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y docker-ce</span><br></pre></td></tr></table></figure>\n\n<p>docker-ce为社区免费版本。稍等片刻，docker即可安装成功。</p>\n<h2 id=\"3、启动docker\"><a href=\"#3、启动docker\" class=\"headerlink\" title=\"3、启动docker\"></a>3、启动docker</h2><p>Docker应用需要用到各种端口，逐一去修改防火墙设置。</p>\n<p>这里展示直接关闭防火墙的命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 关闭</span><br><span class=\"line\">systemctl stop firewalld</span><br><span class=\"line\"># 禁止开机启动防火墙</span><br><span class=\"line\">systemctl disable firewalld</span><br></pre></td></tr></table></figure>\n\n<p>通过命令启动docker：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start docker  # 启动docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl stop docker  # 停止docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl restart docker  # 重启docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable docker  # 开机自启docker服务</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start docker  # 启动docker服务</span><br></pre></td></tr></table></figure>\n\n<p>然后输入命令，可以查看docker版本：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4、配置镜像加速\"><a href=\"#4、配置镜像加速\" class=\"headerlink\" title=\"4、配置镜像加速\"></a>4、配置镜像加速</h2><p>docker官方镜像仓库网速较差，导致拉取镜像失败，如下面这种错误，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull 报错 Error response from daemon: Get “https://registry-1.docker.io/v2/“</span><br></pre></td></tr></table></figure>\n\n<p>我们需要设置国内镜像服务：</p>\n<p>解决方案如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>\n\n<p>添加以下内容：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;data-root&quot;: &quot;/home/docker-root&quot;,</span><br><span class=\"line\">  &quot;registry-mirrors&quot;: [</span><br><span class=\"line\">  \t&quot;https://registry.dockercn.com&quot;,</span><br><span class=\"line\">  \t&quot;https://0mmuy3ea.mirror.aliyuncs.com/&quot;,&quot;https://docker.m.daocloud.io/&quot;</span><br><span class=\"line\">  \t]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后保存</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:wq</span><br></pre></td></tr></table></figure>\n\n<p>重启docker</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl daemon-reload</span><br><span class=\"line\">systemctl restart  docker</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"centos安装docker-compose\"><a href=\"#centos安装docker-compose\" class=\"headerlink\" title=\"centos安装docker-compose\"></a>centos安装docker-compose</h1><h2 id=\"1、最新版本查询\"><a href=\"#1、最新版本查询\" class=\"headerlink\" title=\"1、最新版本查询\"></a>1、最新版本查询</h2><p>Docker Compose 的最新版本会不断更新，你可以通过以下几种方式来查看目前的最新版本：</p>\n<ul>\n<li><strong>官方发布页面</strong>：访问 <a href=\"https://github.com/docker/compose/releases\">Docker Compose 的 GitHub 发布页面</a>，该页面会列出所有的版本信息，页面上显示的最新版本就是目前可获取的最新版本。</li>\n<li><strong>命令行查看</strong>：如果你已经安装了 Docker Compose，在终端中执行 <code>docker-compose version</code> 命令，就能看到当前安装的版本。要是想知道是否有更新版本，还是要参考官方发布页面。</li>\n</ul>\n<h2 id=\"2、安装最新版本\"><a href=\"#2、安装最新版本\" class=\"headerlink\" title=\"2、安装最新版本\"></a>2、安装最新版本</h2><p>如果要安装最新版本的 Docker Compose，可以参考以下步骤（以 Linux 系统为例）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 获取最新稳定版本号</span><br><span class=\"line\">COMPOSE_VERSION=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep &#x27;tag_name&#x27; | cut -d\\&quot; -f4)</span><br><span class=\"line\"></span><br><span class=\"line\"># 下载指定版本的 Docker Compose</span><br><span class=\"line\">sudo curl -L &quot;https://github.com/docker/compose/releases/download/$&#123;COMPOSE_VERSION&#125;/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class=\"line\"></span><br><span class=\"line\"># 添加可执行权限</span><br><span class=\"line\">sudo chmod +x /usr/local/bin/docker-compose</span><br><span class=\"line\"></span><br><span class=\"line\"># 验证安装</span><br><span class=\"line\">docker-compose --version</span><br></pre></td></tr></table></figure>\n\n<p>上述脚本会自动获取最新版本号并完成 Docker Compose 的下载和安装，最后验证安装是否成功。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-41-14.jpg\"></p>\n<h2 id=\"3、获取最新版本补全脚本\"><a href=\"#3、获取最新版本补全脚本\" class=\"headerlink\" title=\"3、获取最新版本补全脚本\"></a>3、获取最新版本补全脚本</h2><p>若要使用最新版本的 Docker Compose 补全脚本，你可以把命令中的版本号替换成最新版本。获取最新版本号的方式有多种，例如访问 <a href=\"https://github.com/docker/compose/releases\">Docker Compose 的 GitHub 发布页面</a>。</p>\n<p>假设你已经得知最新版本是 <code>v2.20.3</code>（实际使用时请替换为真正的最新版本），可以使用如下命令获取对应版本的补全脚本：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo curl -L https://raw.githubusercontent.com/docker/compose/v2.20.3/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-43-19.jpg\"></p>\n<p>运行完该命令后，重新打开一个终端让补全功能生效。</p>\n<h2 id=\"4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\"><a href=\"#4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\" class=\"headerlink\" title=\"4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：\"></a>4、当使用命令无法安装时，可以下载源文件进行安装，步骤如下：</h2><p>当你下载了 <code>compose-2.34.0.tar.gz</code> 文件后，通常意味着你下载的是 Docker Compose 的源码包，下面为你介绍安装 Docker Compose 的操作步骤：</p>\n<h3 id=\"1-解压文件\"><a href=\"#1-解压文件\" class=\"headerlink\" title=\"1. 解压文件\"></a>1. 解压文件</h3><p>你需要使用 <code>tar</code> 命令来解压下载的 <code>compose-2.34.0.tar.gz</code> 文件。在终端中执行以下命令：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf compose-2.34.0.tar.gz</span><br></pre></td></tr></table></figure>\n\n<p>该命令会将压缩包解压到当前目录下，解压后会生成一个名为 <code>compose-2.34.0</code> 的文件夹。</p>\n<h3 id=\"2-进入解压后的目录\"><a href=\"#2-进入解压后的目录\" class=\"headerlink\" title=\"2. 进入解压后的目录\"></a>2. 进入解压后的目录</h3><p>使用 <code>cd</code> 命令进入解压后的文件夹：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd compose-2.34.0</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-构建并安装-Docker-Compose\"><a href=\"#3-构建并安装-Docker-Compose\" class=\"headerlink\" title=\"3. 构建并安装 Docker Compose\"></a>3. 构建并安装 Docker Compose</h3><p>一般情况下，你可以使用 <code>make</code> 命令来构建和安装 Docker Compose。不过在执行 <code>make</code> 命令之前，需要确保你的系统已经安装了 <code>make</code> 工具和其他必要的依赖项。执行以下命令：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>make</code> 命令会根据 <code>Makefile</code> 文件中的规则来编译和构建 Docker Compose。</li>\n<li><code>sudo make install</code> 命令会将构建好的二进制文件安装到系统中，使其可以在全局范围内使用。</li>\n</ul>\n<h3 id=\"4-验证安装\"><a href=\"#4-验证安装\" class=\"headerlink\" title=\"4. 验证安装\"></a>4. 验证安装</h3><p>安装完成后，你可以使用以下命令来验证 Docker Compose 是否安装成功：</p>\n<p>bash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose --version</span><br></pre></td></tr></table></figure>\n\n<p>如果输出显示 Docker Compose 的版本为 2.34.0，则说明安装成功。</p>\n<h3 id=\"可能遇到的问题及解决办法\"><a href=\"#可能遇到的问题及解决办法\" class=\"headerlink\" title=\"可能遇到的问题及解决办法\"></a>可能遇到的问题及解决办法</h3><ul>\n<li><strong>缺少依赖项</strong>：如果在执行 <code>make</code> 命令时出现错误，提示缺少某些依赖项，你需要安装这些依赖项。常见的依赖项包括 <code>go</code> 语言环境等。你可以根据错误提示安装相应的依赖项。</li>\n<li><strong>权限问题</strong>：如果在执行 <code>sudo make install</code> 命令时遇到权限问题，确保你具有足够的权限。通常使用 <code>sudo</code> 命令可以解决权限问题。</li>\n</ul>\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-41-14.jpg","popularPost_tmp_gaData":{"updated":"Thu Mar 20 2025 19:59:11 GMT+0800 (中国标准时间)","title":"CentOS安装Docker\\Docker-compose","path":"2023/12/19/CentOS安装Docker/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-19_14-41-14.jpg","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2023-12-19T05:53:20.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2023-12-19T05:53:20.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"Linux","tags":["docker"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"cfssl工具制作证书","date":"2024-07-01T05:35:02.000Z","_content":"\n# **cfssl工具制作证书**\n\n## 安装cfssl\n\n[去git下载二进制文件]: https://github.com/cloudflare/cfssl/releases\t\"点击下载文件\"\n\n下载文件 \n\n```\ncfssl_1.6.5_linux_amd64   cfssl-certinfo_1.6.5_linux_amd64    cfssljson_1.6.5_linux_amd64\n```\n\n\n\n```java\n# 赋权限\n$ chmod +x cffs*\n# 移动到 /usr/local/bin\n$ mv cfssl_1.6.1_linux_amd64 /usr/local/bin/cfssl\n$ mv cfssl-certinfo_1.6.1_linux_amd64 /usr/local/bin/cfssl-certinfo\n$ mv cfssljson_1.6.1_linux_amd64 /usr/local/bin/cfssljson\n```\n\n## 生成根证书\n\n```\n# 根证书请求配置文件\n$ vim ca-csr.json\n\n{\n        \"CN\": \"ltdw\",\n        \"key\": {\n                \"algo\": \"rsa\",\n                \"size\": 2048\n        },\n        \"names\": [{\n                \"C\": \"CN\",\n                \"ST\": \"Beijing\",\n                \"L\": \"beijing\",\n                \"O\": \"ltdw\",\n                \"OU\": \"ltdw\"\n        }]\n}\n\n# 生成证书\n$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca\n\n# -base ca 指定生成的证书名称\n```\n\n`CN` 证书名称\n\n`C` Country， 国家\n\n`L` Locality，地区，城市\n\n`O` Organization Name，组织名称，公司名称\n\n`OU` Organization Unit Name，组织单位名称，公司部门\n\n`ST` State，州，省\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-01_16-25-38.jpg)\n\n## 通过ca签发服务器证书\n\n```\n# 服务器证书请求配置文件\nvim 192.168.1.101-csr.json\n\n{\n    \"CN\": \"192.168.1.101\",\n    \"hosts\": [\n      \"192.168.1.101\",\n      \"kube-master\"\n    ],\n    \"key\": {\n        \"algo\": \"rsa\",\n        \"size\": 2048\n    },\n    \"names\": [\n        {\n            \"C\": \"CN\",\n            \"L\": \"BeiJing\",\n            \"ST\": \"BeiJing\",\n            \"O\": \"ltdw\",\n            \"OU\": \"ltdw\"\n        }\n    ]\n}\n\n\n# 生成证书策略文件\n$ cat ca-config.json\n{\n  \"signing\": {\n    \"default\": {\n      \"expiry\": \"87600h\"\n    },\n    \"profiles\": {\n      \"server\": {\n        \"expiry\": \"87600h\",\n        \"usages\": [\n          \"signing\",\n          \"key encipherment\",\n          \"server auth\",\n          \"client auth\"\n        ]\n      },\n      \"intermediate\": {\n        \"expiry\": \"87600h\",\n        \"usages\": [\n          \"signing\",\n          \"key encipherment\",\n          \"cert sign\",\n          \"crl sign\",\n          \"server auth\",\n          \"client auth\"\n        ]\n      }\n    }\n  }\n}\n\n\n# 生成证书\n$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=intermediate 192.168.1.101-csr.json | cfssljson -bare 192.168.1.101\n# 单独生成csr文件\n$ cfssl genkey csr.json | cfssljson -bare 192.168.1.101\n# 证书和私钥合并成pfx\n$ openssl pkcs12 -export -out certificate.pfx -inkey private_key.pem -in certificate.pem -certfile intermediate_cert.pem\n# pfx 提取证书和私钥\n$ openssl pkcs12 -in certificate.pfx -nocerts -nodes -out private_key.pem\n$ openssl pkcs12 -in certificate.pfx -clcerts -nokeys -out certificate.pem\n$ openssl verify -CAfile ca.pem intermediate.pem \n```\n\n- 默认策略，指定了证书的有效期是一年(8760h)\n- `usages.signing`, 表示该证书可用于签名其它证书；生成的 ca.pem 证书中 CA=TRUE\n- `usages.server auth`：表示 client 可以用该 CA 对 server 提供的证书进行验证\n\n- `usages.client auth`：表示 server 可以用该 CA 对 client 提供的证书进行验证\n\n## 证书格式转换\n\n```\n# pem > crt\n$ openssl x509 -in ca.pem -out ca.crt\n\n# pem > key\n$ openssl rsa -in ca.pem -out ca.key\n```\n\n\n\n## 挂载\n\n在Linux操作系统中, 把192.168.1.101-key.pem和192.168.1.101.pem 挂载到nginx下\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_11-26-30.jpg)\n\n本地计算机安装ca.crt证书 双击-安装证书-本地计算机-将所有证书都放入下列存储-受信任的根证书颁发机构\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_14-11-48.jpg)\n","source":"_posts/cfssl工具制作证书.md","raw":"---\ntitle: cfssl工具制作证书\ndate: 2024-07-01 13:35:02\ntags:\n- ssl\ncategories:\n- ssl\n---\n\n# **cfssl工具制作证书**\n\n## 安装cfssl\n\n[去git下载二进制文件]: https://github.com/cloudflare/cfssl/releases\t\"点击下载文件\"\n\n下载文件 \n\n```\ncfssl_1.6.5_linux_amd64   cfssl-certinfo_1.6.5_linux_amd64    cfssljson_1.6.5_linux_amd64\n```\n\n\n\n```java\n# 赋权限\n$ chmod +x cffs*\n# 移动到 /usr/local/bin\n$ mv cfssl_1.6.1_linux_amd64 /usr/local/bin/cfssl\n$ mv cfssl-certinfo_1.6.1_linux_amd64 /usr/local/bin/cfssl-certinfo\n$ mv cfssljson_1.6.1_linux_amd64 /usr/local/bin/cfssljson\n```\n\n## 生成根证书\n\n```\n# 根证书请求配置文件\n$ vim ca-csr.json\n\n{\n        \"CN\": \"ltdw\",\n        \"key\": {\n                \"algo\": \"rsa\",\n                \"size\": 2048\n        },\n        \"names\": [{\n                \"C\": \"CN\",\n                \"ST\": \"Beijing\",\n                \"L\": \"beijing\",\n                \"O\": \"ltdw\",\n                \"OU\": \"ltdw\"\n        }]\n}\n\n# 生成证书\n$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca\n\n# -base ca 指定生成的证书名称\n```\n\n`CN` 证书名称\n\n`C` Country， 国家\n\n`L` Locality，地区，城市\n\n`O` Organization Name，组织名称，公司名称\n\n`OU` Organization Unit Name，组织单位名称，公司部门\n\n`ST` State，州，省\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-01_16-25-38.jpg)\n\n## 通过ca签发服务器证书\n\n```\n# 服务器证书请求配置文件\nvim 192.168.1.101-csr.json\n\n{\n    \"CN\": \"192.168.1.101\",\n    \"hosts\": [\n      \"192.168.1.101\",\n      \"kube-master\"\n    ],\n    \"key\": {\n        \"algo\": \"rsa\",\n        \"size\": 2048\n    },\n    \"names\": [\n        {\n            \"C\": \"CN\",\n            \"L\": \"BeiJing\",\n            \"ST\": \"BeiJing\",\n            \"O\": \"ltdw\",\n            \"OU\": \"ltdw\"\n        }\n    ]\n}\n\n\n# 生成证书策略文件\n$ cat ca-config.json\n{\n  \"signing\": {\n    \"default\": {\n      \"expiry\": \"87600h\"\n    },\n    \"profiles\": {\n      \"server\": {\n        \"expiry\": \"87600h\",\n        \"usages\": [\n          \"signing\",\n          \"key encipherment\",\n          \"server auth\",\n          \"client auth\"\n        ]\n      },\n      \"intermediate\": {\n        \"expiry\": \"87600h\",\n        \"usages\": [\n          \"signing\",\n          \"key encipherment\",\n          \"cert sign\",\n          \"crl sign\",\n          \"server auth\",\n          \"client auth\"\n        ]\n      }\n    }\n  }\n}\n\n\n# 生成证书\n$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=intermediate 192.168.1.101-csr.json | cfssljson -bare 192.168.1.101\n# 单独生成csr文件\n$ cfssl genkey csr.json | cfssljson -bare 192.168.1.101\n# 证书和私钥合并成pfx\n$ openssl pkcs12 -export -out certificate.pfx -inkey private_key.pem -in certificate.pem -certfile intermediate_cert.pem\n# pfx 提取证书和私钥\n$ openssl pkcs12 -in certificate.pfx -nocerts -nodes -out private_key.pem\n$ openssl pkcs12 -in certificate.pfx -clcerts -nokeys -out certificate.pem\n$ openssl verify -CAfile ca.pem intermediate.pem \n```\n\n- 默认策略，指定了证书的有效期是一年(8760h)\n- `usages.signing`, 表示该证书可用于签名其它证书；生成的 ca.pem 证书中 CA=TRUE\n- `usages.server auth`：表示 client 可以用该 CA 对 server 提供的证书进行验证\n\n- `usages.client auth`：表示 server 可以用该 CA 对 client 提供的证书进行验证\n\n## 证书格式转换\n\n```\n# pem > crt\n$ openssl x509 -in ca.pem -out ca.crt\n\n# pem > key\n$ openssl rsa -in ca.pem -out ca.key\n```\n\n\n\n## 挂载\n\n在Linux操作系统中, 把192.168.1.101-key.pem和192.168.1.101.pem 挂载到nginx下\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_11-26-30.jpg)\n\n本地计算机安装ca.crt证书 双击-安装证书-本地计算机-将所有证书都放入下列存储-受信任的根证书颁发机构\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_14-11-48.jpg)\n","slug":"cfssl工具制作证书","published":1,"updated":"2025-11-05T02:13:50.628Z","_id":"cmck4zyrc0003t0amd29efswv","comments":1,"layout":"post","photos":[],"content":"<h1 id=\"cfssl工具制作证书\"><a href=\"#cfssl工具制作证书\" class=\"headerlink\" title=\"cfssl工具制作证书\"></a><strong>cfssl工具制作证书</strong></h1><h2 id=\"安装cfssl\"><a href=\"#安装cfssl\" class=\"headerlink\" title=\"安装cfssl\"></a>安装cfssl</h2><p>[去git下载二进制文件]: <a href=\"https://github.com/cloudflare/cfssl/releases\">https://github.com/cloudflare/cfssl/releases</a>\t“点击下载文件”</p>\n<p>下载文件 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cfssl_1.6.5_linux_amd64   cfssl-certinfo_1.6.5_linux_amd64    cfssljson_1.6.5_linux_amd64</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 赋权限</span><br><span class=\"line\">$ chmod +x cffs*</span><br><span class=\"line\"># 移动到 /usr/local/bin</span><br><span class=\"line\">$ mv cfssl_1<span class=\"number\">.6</span>.1_linux_amd64 /usr/local/bin/cfssl</span><br><span class=\"line\">$ mv cfssl-certinfo_1<span class=\"number\">.6</span>.1_linux_amd64 /usr/local/bin/cfssl-certinfo</span><br><span class=\"line\">$ mv cfssljson_1<span class=\"number\">.6</span>.1_linux_amd64 /usr/local/bin/cfssljson</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"生成根证书\"><a href=\"#生成根证书\" class=\"headerlink\" title=\"生成根证书\"></a>生成根证书</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 根证书请求配置文件</span><br><span class=\"line\">$ vim ca-csr.json</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">        &quot;CN&quot;: &quot;ltdw&quot;,</span><br><span class=\"line\">        &quot;key&quot;: &#123;</span><br><span class=\"line\">                &quot;algo&quot;: &quot;rsa&quot;,</span><br><span class=\"line\">                &quot;size&quot;: 2048</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &quot;names&quot;: [&#123;</span><br><span class=\"line\">                &quot;C&quot;: &quot;CN&quot;,</span><br><span class=\"line\">                &quot;ST&quot;: &quot;Beijing&quot;,</span><br><span class=\"line\">                &quot;L&quot;: &quot;beijing&quot;,</span><br><span class=\"line\">                &quot;O&quot;: &quot;ltdw&quot;,</span><br><span class=\"line\">                &quot;OU&quot;: &quot;ltdw&quot;</span><br><span class=\"line\">        &#125;]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 生成证书</span><br><span class=\"line\">$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca</span><br><span class=\"line\"></span><br><span class=\"line\"># -base ca 指定生成的证书名称</span><br></pre></td></tr></table></figure>\n\n<p><code>CN</code> 证书名称</p>\n<p><code>C</code> Country， 国家</p>\n<p><code>L</code> Locality，地区，城市</p>\n<p><code>O</code> Organization Name，组织名称，公司名称</p>\n<p><code>OU</code> Organization Unit Name，组织单位名称，公司部门</p>\n<p><code>ST</code> State，州，省</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-01_16-25-38.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-01_16-25-38.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h2 id=\"通过ca签发服务器证书\"><a href=\"#通过ca签发服务器证书\" class=\"headerlink\" title=\"通过ca签发服务器证书\"></a>通过ca签发服务器证书</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 服务器证书请求配置文件</span><br><span class=\"line\">vim 192.168.1.101-csr.json</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;CN&quot;: &quot;192.168.1.101&quot;,</span><br><span class=\"line\">    &quot;hosts&quot;: [</span><br><span class=\"line\">      &quot;192.168.1.101&quot;,</span><br><span class=\"line\">      &quot;kube-master&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;key&quot;: &#123;</span><br><span class=\"line\">        &quot;algo&quot;: &quot;rsa&quot;,</span><br><span class=\"line\">        &quot;size&quot;: 2048</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;names&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;C&quot;: &quot;CN&quot;,</span><br><span class=\"line\">            &quot;L&quot;: &quot;BeiJing&quot;,</span><br><span class=\"line\">            &quot;ST&quot;: &quot;BeiJing&quot;,</span><br><span class=\"line\">            &quot;O&quot;: &quot;ltdw&quot;,</span><br><span class=\"line\">            &quot;OU&quot;: &quot;ltdw&quot;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># 生成证书策略文件</span><br><span class=\"line\">$ cat ca-config.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;signing&quot;: &#123;</span><br><span class=\"line\">    &quot;default&quot;: &#123;</span><br><span class=\"line\">      &quot;expiry&quot;: &quot;87600h&quot;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;profiles&quot;: &#123;</span><br><span class=\"line\">      &quot;server&quot;: &#123;</span><br><span class=\"line\">        &quot;expiry&quot;: &quot;87600h&quot;,</span><br><span class=\"line\">        &quot;usages&quot;: [</span><br><span class=\"line\">          &quot;signing&quot;,</span><br><span class=\"line\">          &quot;key encipherment&quot;,</span><br><span class=\"line\">          &quot;server auth&quot;,</span><br><span class=\"line\">          &quot;client auth&quot;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &quot;intermediate&quot;: &#123;</span><br><span class=\"line\">        &quot;expiry&quot;: &quot;87600h&quot;,</span><br><span class=\"line\">        &quot;usages&quot;: [</span><br><span class=\"line\">          &quot;signing&quot;,</span><br><span class=\"line\">          &quot;key encipherment&quot;,</span><br><span class=\"line\">          &quot;cert sign&quot;,</span><br><span class=\"line\">          &quot;crl sign&quot;,</span><br><span class=\"line\">          &quot;server auth&quot;,</span><br><span class=\"line\">          &quot;client auth&quot;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># 生成证书</span><br><span class=\"line\">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=intermediate 192.168.1.101-csr.json | cfssljson -bare 192.168.1.101</span><br><span class=\"line\"># 单独生成csr文件</span><br><span class=\"line\">$ cfssl genkey csr.json | cfssljson -bare 192.168.1.101</span><br><span class=\"line\"># 证书和私钥合并成pfx</span><br><span class=\"line\">$ openssl pkcs12 -export -out certificate.pfx -inkey private_key.pem -in certificate.pem -certfile intermediate_cert.pem</span><br><span class=\"line\"># pfx 提取证书和私钥</span><br><span class=\"line\">$ openssl pkcs12 -in certificate.pfx -nocerts -nodes -out private_key.pem</span><br><span class=\"line\">$ openssl pkcs12 -in certificate.pfx -clcerts -nokeys -out certificate.pem</span><br><span class=\"line\">$ openssl verify -CAfile ca.pem intermediate.pem </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>默认策略，指定了证书的有效期是一年(8760h)</p>\n</li>\n<li><p><code>usages.signing</code>, 表示该证书可用于签名其它证书；生成的 ca.pem 证书中 CA&#x3D;TRUE</p>\n</li>\n<li><p><code>usages.server auth</code>：表示 client 可以用该 CA 对 server 提供的证书进行验证</p>\n</li>\n<li><p><code>usages.client auth</code>：表示 server 可以用该 CA 对 client 提供的证书进行验证</p>\n</li>\n</ul>\n<h2 id=\"证书格式转换\"><a href=\"#证书格式转换\" class=\"headerlink\" title=\"证书格式转换\"></a>证书格式转换</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># pem &gt; crt</span><br><span class=\"line\">$ openssl x509 -in ca.pem -out ca.crt</span><br><span class=\"line\"></span><br><span class=\"line\"># pem &gt; key</span><br><span class=\"line\">$ openssl rsa -in ca.pem -out ca.key</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"挂载\"><a href=\"#挂载\" class=\"headerlink\" title=\"挂载\"></a>挂载</h2><p>在Linux操作系统中, 把192.168.1.101-key.pem和192.168.1.101.pem 挂载到nginx下</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_11-26-30.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_11-26-30.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>本地计算机安装ca.crt证书 双击-安装证书-本地计算机-将所有证书都放入下列存储-受信任的根证书颁发机构</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_14-11-48.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_14-11-48.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n","excerpt":"","more":"<h1 id=\"cfssl工具制作证书\"><a href=\"#cfssl工具制作证书\" class=\"headerlink\" title=\"cfssl工具制作证书\"></a><strong>cfssl工具制作证书</strong></h1><h2 id=\"安装cfssl\"><a href=\"#安装cfssl\" class=\"headerlink\" title=\"安装cfssl\"></a>安装cfssl</h2><p>[去git下载二进制文件]: <a href=\"https://github.com/cloudflare/cfssl/releases\">https://github.com/cloudflare/cfssl/releases</a>\t“点击下载文件”</p>\n<p>下载文件 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cfssl_1.6.5_linux_amd64   cfssl-certinfo_1.6.5_linux_amd64    cfssljson_1.6.5_linux_amd64</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 赋权限</span><br><span class=\"line\">$ chmod +x cffs*</span><br><span class=\"line\"># 移动到 /usr/local/bin</span><br><span class=\"line\">$ mv cfssl_1<span class=\"number\">.6</span>.1_linux_amd64 /usr/local/bin/cfssl</span><br><span class=\"line\">$ mv cfssl-certinfo_1<span class=\"number\">.6</span>.1_linux_amd64 /usr/local/bin/cfssl-certinfo</span><br><span class=\"line\">$ mv cfssljson_1<span class=\"number\">.6</span>.1_linux_amd64 /usr/local/bin/cfssljson</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"生成根证书\"><a href=\"#生成根证书\" class=\"headerlink\" title=\"生成根证书\"></a>生成根证书</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 根证书请求配置文件</span><br><span class=\"line\">$ vim ca-csr.json</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">        &quot;CN&quot;: &quot;ltdw&quot;,</span><br><span class=\"line\">        &quot;key&quot;: &#123;</span><br><span class=\"line\">                &quot;algo&quot;: &quot;rsa&quot;,</span><br><span class=\"line\">                &quot;size&quot;: 2048</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &quot;names&quot;: [&#123;</span><br><span class=\"line\">                &quot;C&quot;: &quot;CN&quot;,</span><br><span class=\"line\">                &quot;ST&quot;: &quot;Beijing&quot;,</span><br><span class=\"line\">                &quot;L&quot;: &quot;beijing&quot;,</span><br><span class=\"line\">                &quot;O&quot;: &quot;ltdw&quot;,</span><br><span class=\"line\">                &quot;OU&quot;: &quot;ltdw&quot;</span><br><span class=\"line\">        &#125;]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 生成证书</span><br><span class=\"line\">$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca</span><br><span class=\"line\"></span><br><span class=\"line\"># -base ca 指定生成的证书名称</span><br></pre></td></tr></table></figure>\n\n<p><code>CN</code> 证书名称</p>\n<p><code>C</code> Country， 国家</p>\n<p><code>L</code> Locality，地区，城市</p>\n<p><code>O</code> Organization Name，组织名称，公司名称</p>\n<p><code>OU</code> Organization Unit Name，组织单位名称，公司部门</p>\n<p><code>ST</code> State，州，省</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-01_16-25-38.jpg\"></p>\n<h2 id=\"通过ca签发服务器证书\"><a href=\"#通过ca签发服务器证书\" class=\"headerlink\" title=\"通过ca签发服务器证书\"></a>通过ca签发服务器证书</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 服务器证书请求配置文件</span><br><span class=\"line\">vim 192.168.1.101-csr.json</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;CN&quot;: &quot;192.168.1.101&quot;,</span><br><span class=\"line\">    &quot;hosts&quot;: [</span><br><span class=\"line\">      &quot;192.168.1.101&quot;,</span><br><span class=\"line\">      &quot;kube-master&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;key&quot;: &#123;</span><br><span class=\"line\">        &quot;algo&quot;: &quot;rsa&quot;,</span><br><span class=\"line\">        &quot;size&quot;: 2048</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;names&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;C&quot;: &quot;CN&quot;,</span><br><span class=\"line\">            &quot;L&quot;: &quot;BeiJing&quot;,</span><br><span class=\"line\">            &quot;ST&quot;: &quot;BeiJing&quot;,</span><br><span class=\"line\">            &quot;O&quot;: &quot;ltdw&quot;,</span><br><span class=\"line\">            &quot;OU&quot;: &quot;ltdw&quot;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># 生成证书策略文件</span><br><span class=\"line\">$ cat ca-config.json</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;signing&quot;: &#123;</span><br><span class=\"line\">    &quot;default&quot;: &#123;</span><br><span class=\"line\">      &quot;expiry&quot;: &quot;87600h&quot;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;profiles&quot;: &#123;</span><br><span class=\"line\">      &quot;server&quot;: &#123;</span><br><span class=\"line\">        &quot;expiry&quot;: &quot;87600h&quot;,</span><br><span class=\"line\">        &quot;usages&quot;: [</span><br><span class=\"line\">          &quot;signing&quot;,</span><br><span class=\"line\">          &quot;key encipherment&quot;,</span><br><span class=\"line\">          &quot;server auth&quot;,</span><br><span class=\"line\">          &quot;client auth&quot;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &quot;intermediate&quot;: &#123;</span><br><span class=\"line\">        &quot;expiry&quot;: &quot;87600h&quot;,</span><br><span class=\"line\">        &quot;usages&quot;: [</span><br><span class=\"line\">          &quot;signing&quot;,</span><br><span class=\"line\">          &quot;key encipherment&quot;,</span><br><span class=\"line\">          &quot;cert sign&quot;,</span><br><span class=\"line\">          &quot;crl sign&quot;,</span><br><span class=\"line\">          &quot;server auth&quot;,</span><br><span class=\"line\">          &quot;client auth&quot;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># 生成证书</span><br><span class=\"line\">$ cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=intermediate 192.168.1.101-csr.json | cfssljson -bare 192.168.1.101</span><br><span class=\"line\"># 单独生成csr文件</span><br><span class=\"line\">$ cfssl genkey csr.json | cfssljson -bare 192.168.1.101</span><br><span class=\"line\"># 证书和私钥合并成pfx</span><br><span class=\"line\">$ openssl pkcs12 -export -out certificate.pfx -inkey private_key.pem -in certificate.pem -certfile intermediate_cert.pem</span><br><span class=\"line\"># pfx 提取证书和私钥</span><br><span class=\"line\">$ openssl pkcs12 -in certificate.pfx -nocerts -nodes -out private_key.pem</span><br><span class=\"line\">$ openssl pkcs12 -in certificate.pfx -clcerts -nokeys -out certificate.pem</span><br><span class=\"line\">$ openssl verify -CAfile ca.pem intermediate.pem </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>默认策略，指定了证书的有效期是一年(8760h)</p>\n</li>\n<li><p><code>usages.signing</code>, 表示该证书可用于签名其它证书；生成的 ca.pem 证书中 CA&#x3D;TRUE</p>\n</li>\n<li><p><code>usages.server auth</code>：表示 client 可以用该 CA 对 server 提供的证书进行验证</p>\n</li>\n<li><p><code>usages.client auth</code>：表示 server 可以用该 CA 对 client 提供的证书进行验证</p>\n</li>\n</ul>\n<h2 id=\"证书格式转换\"><a href=\"#证书格式转换\" class=\"headerlink\" title=\"证书格式转换\"></a>证书格式转换</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># pem &gt; crt</span><br><span class=\"line\">$ openssl x509 -in ca.pem -out ca.crt</span><br><span class=\"line\"></span><br><span class=\"line\"># pem &gt; key</span><br><span class=\"line\">$ openssl rsa -in ca.pem -out ca.key</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"挂载\"><a href=\"#挂载\" class=\"headerlink\" title=\"挂载\"></a>挂载</h2><p>在Linux操作系统中, 把192.168.1.101-key.pem和192.168.1.101.pem 挂载到nginx下</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_11-26-30.jpg\"></p>\n<p>本地计算机安装ca.crt证书 双击-安装证书-本地计算机-将所有证书都放入下列存储-受信任的根证书颁发机构</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-07-01_14-11-48.jpg\"></p>\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-01_16-25-38.jpg","popularPost_tmp_gaData":{"updated":"Wed Nov 05 2025 10:13:50 GMT+0800 (中国标准时间)","title":"cfssl工具制作证书","path":"2024/07/01/cfssl工具制作证书/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-01_16-25-38.jpg","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2024-07-01T05:35:02.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2024-07-01T05:35:02.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"ssl","tags":["ssl"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"Redis集群搭建","date":"2025-03-20T06:36:00.000Z","_content":"\n# Redis集群搭建\n\n## 1、Redis主从集群\n\n### 1.1、集群结构\n\n搭建的主从集群结构如图：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_14-40-01.jpg)\n\n共包含三个节点，一个主节点，两个从节点。\n\n在同一台虚拟机中开启3个redis实例，模拟主从集群，信息如下：\n\n| IP              | PORT | 角色   |\n| --------------- | ---- | ------ |\n| 192.168.150.101 | 7001 | master |\n| 192.168.150.101 | 7002 | slave  |\n| 192.168.150.101 | 7003 | slave  |\n\n\n\n### 1.2、**准备实例和配置**\n\n要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。\n\n1）创建目录\n\n创建三个文件夹，名字分别叫7001、7002、7003：\n\n```\n# 进入/tmp目录\ncd /tmp\n# 创建目录\nmkdir 7001 7002 7003\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-11-14.jpg)\n\n2）恢复原始配置\n\n修改redis-6.2.4/redis.conf文件，将其中的持久化模式改为默认的RDB模式，AOF保持关闭状态。\n\n```\n# 开启RDB\n# save \"\"\nsave 3600 1\nsave 300 100\nsave 60 10000\n\n# 关闭AOF\nappendonly no\n```\n\n3）拷贝配置文件到每个实例目录\n\n然后将redis-6.2.4/redis.conf文件拷贝到三个目录中（在/tmp目录执行下列命令）：\n\n```\n# 方式一：逐个拷贝\ncp redis-6.2.4/redis.conf 7001\ncp redis-6.2.4/redis.conf 7002\ncp redis-6.2.4/redis.conf 7003\n# 方式二：管道组合命令，一键拷贝\necho 7001 7002 7003 | xargs -t -n 1 cp redis-6.2.4/redis.conf\n```\n\n4）修改每个实例的端口、工作目录\n\n修改每个文件夹内的配置文件，将端口分别修改为7001、7002、7003，将rdb文件保存位置都修改为自己所在目录（在/tmp目录执行下列命令）：\n\n```\nsed -i -e 's/6379/7001/g' -e 's/dir .\\//dir \\/tmp\\/7001\\//g' 7001/redis.conf\nsed -i -e 's/6379/7002/g' -e 's/dir .\\//dir \\/tmp\\/7002\\//g' 7002/redis.conf\nsed -i -e 's/6379/7003/g' -e 's/dir .\\//dir \\/tmp\\/7003\\//g' 7003/redis.conf\n```\n\n5）修改每个实例的声明IP\n\n虚拟机本身有多个IP，为了避免将来混乱，需要在redis.conf文件中指定每一个实例的绑定ip信息，格式如下：\n\n```\n# redis实例的声明 IP\nreplica-announce-ip 192.168.150.101\n```\n\n每个目录都要改，我们一键完成修改（在/tmp目录执行下列命令）：\n\n```\n# 逐一执行\nsed -i '1a replica-announce-ip 192.168.150.101' 7001/redis.conf\nsed -i '1a replica-announce-ip 192.168.150.101' 7002/redis.conf\nsed -i '1a replica-announce-ip 192.168.150.101' 7003/redis.conf\n\n# 或者一键修改\nprintf '%s\\n' 7001 7002 7003 | xargs -I{} -t sed -i '1a replica-announce-ip 192.168.150.101' {}/redis.conf\n```\n\n\n\n### 1.3、启动\n\n```\n# 第1个\nredis-server 7001/redis.conf\n# 第2个\nredis-server 7002/redis.conf\n# 第3个\nredis-server 7003/redis.conf\n或\n./redis-6.2.4/src/redis-server ./7001/redis.conf\n./redis-6.2.4/src/redis-server ./7002/redis.conf\n./redis-6.2.4/src/redis-server ./7003/redis.conf\n```\n\n启动后：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-12-26.jpg)\n\n```\n# 如果要一键停止，可以运行下面命令：\nprintf '%s\\n' 7001 7002 7003 | xargs -I{} -t redis-cli -p {} shutdown\n```\n\n\n\n### 1.4、开启主从关系\n\n现在三个实例还没有任何关系，要配置主从可以使用replicaof 或者slaveof（5.0以前）命令。\n\n有临时和永久两种模式：\n\n-  修改配置文件（永久生效） \n\nslaveof  \n\n-  使用redis-cli客户端连接到redis服务，执行slaveof命令（重启后失效）： \n\n```\nslaveof <masterip> <masterport>\n```\n\n**注意**：在5.0以后新增命令replicaof，与salveof效果一致。\n\n这里我们为了演示方便，使用方式二。\n\n通过redis-cli命令连接7002，执行下面命令：\n\n```\n# 连接 7002\nredis-cli -p 7002\n# 执行slaveof\nslaveof 124.183.178.142 7001\n```\n\n通过redis-cli命令连接7003，执行下面命令：\n\n```\n# 连接 7003\nredis-cli -p 7003\n# 执行slaveof\nslaveof 192.168.150.101 7001\n```\n\n然后连接 7001节点，查看集群状态：\n\n```\n# 连接 7001\nredis-cli -p 7001\n# 查看状态\ninfo replication\n```\n\n结果：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-22-47.jpg)\n\n### 1.5、测试\n\n执行下列操作以测试：\n\n-  利用redis-cli连接7001，执行\n\n```\nset num 123 \n```\n\n-  利用redis-cli连接7002，执行\n\n```\nget num，再执行\nset num 666 \n```\n\n-  利用redis-cli连接7003，执行\n\n```\nget num，再执行\nset num 888 \n```\n\n可以发现，只有在7001这个master节点上可以执行写操作，7002和7003这两个slave节点只能执行读操作。\n\n\n\n## 2、**搭建哨兵集群**\n\n### 2.1、**集群结构**\n\n这里我们搭建一个三节点形成的Sentinel集群，来监管之前的Redis主从集群。如图：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-36-19.jpg)\n\n三个sentinel实例信息如下：\n\n| 节点 | IP              | PORT  |\n| ---- | --------------- | ----- |\n| s1   | 192.168.150.101 | 27001 |\n| s2   | 192.168.150.101 | 27002 |\n| s3   | 192.168.150.101 | 27003 |\n\n### **3.2.准备实例和配置**\n\n要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。\n\n我们创建三个文件夹，名字分别叫s1、s2、s3：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 创建目录\nmkdir s1 s2 s3\n```\n\n然后我们在s1目录创建一个sentinel.conf文件，添加下面的内容：\n\n```java\nport 27001\nsentinel announce-ip 192.168.150.101\nsentinel monitor mymaster 192.168.150.101 7001 2\nsentinel down-after-milliseconds mymaster 5000\nsentinel failover-timeout mymaster 60000\ndir \"/tmp/s1\"\n```\n\n解读：\n\n- port 27001  ：是当前sentinel实例的端口\n\n- sentinel monitor mymaster 192.168.150.101 7001 2   ：指定主节点信息 \n\n- mymaster  ：主节点名称，自定义，任意写\n\n- 192.168.150.101 7001  ：主节点的ip和端口\n\n- 2  ：选举master时的quorum值\n\n然后将s1/sentinel.conf文件拷贝到s2、s3两个目录中（在/tmp目录执行下列命令）：\n\n```java\n# 方式一：逐个拷贝\ncp s1/sentinel.conf s2\ncp s1/sentinel.conf s3\n# 方式二：管道组合命令，一键拷贝\necho s2 s3 | xargs -t -n 1 cp s1/sentinel.conf\n```\n\n修改s2、s3两个文件夹内的配置文件，将端口分别修改为27002、27003：\n\n```java\nsed -i -e 's/27001/27002/g' -e 's/s1/s2/g' s2/sentinel.conf\nsed -i -e 's/27001/27003/g' -e 's/s1/s3/g' s3/sentinel.conf\n```\n\n### 2.3、启动\n\n为了方便查看日志，我们打开3个ssh窗口，分别启动3个redis实例，启动命令：\n\n```java\n# 第1个\nredis-sentinel s1/sentinel.conf\n./redis-6.2.4/src/redis-sentinel ./s1/sentinel.conf\n# 第2个\nredis-sentinel s2/sentinel.conf\n./redis-6.2.4/src/redis-sentinel ./s2/sentinel.conf\n# 第3个\nredis-sentinel s3/sentinel.conf\n./redis-6.2.4/src/redis-sentinel ./s3/sentinel.conf\n```\n\n启动后：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-39-20.jpg)\n\n### 2.3、测试\n\n尝试让master节点7001宕机，查看sentinel日志：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-42-35.jpg)\n\n查看7003的日志：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-20.jpg)\n\n查看7002的日志：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-38.jpg)\n\n## 3、搭建分片集群\n\n### 3.1、**集群结构**\n\n分片集群需要的节点数量较多，这里我们搭建一个最小的分片集群，包含3个master节点，每个master包含一个slave节点，结构如下：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-45-49.jpg)\n\n这里我们会在同一台虚拟机中开启6个redis实例，模拟分片集群，信息如下：\n\n| IP              | PORT | 角色   |\n| --------------- | ---- | ------ |\n| 192.168.150.101 | 7001 | master |\n| 192.168.150.101 | 7002 | master |\n| 192.168.150.101 | 7003 | master |\n| 192.168.150.101 | 8001 | slave  |\n| 192.168.150.101 | 8002 | slave  |\n| 192.168.150.101 | 8003 | slave  |\n\n### 3.2、**准备实例和配置**\n\n删除之前的7001、7002、7003这几个目录，重新创建出7001、7002、7003、8001、8002、8003目录：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 删除旧的，避免配置干扰\nrm -rf 7001 7002 7003\n# 创建目录\nmkdir 7001 7002 7003 8001 8002 8003\n```\n\n在/tmp下准备一个新的redis.conf文件，内容如下：\n\n```java\nport 6379\n# 开启集群功能\ncluster-enabled yes\n# 集群的配置文件名称，不需要我们创建，由redis自己维护\ncluster-config-file /tmp/6379/nodes.conf\n# 节点心跳失败的超时时间\ncluster-node-timeout 5000\n# 持久化文件存放目录\ndir /tmp/6379\n# 绑定地址\nbind 0.0.0.0\n# 让redis后台运行,守护进程\ndaemonize yes\n# 注册的实例ip\nreplica-announce-ip 192.168.150.101\n# 保护模式\nprotected-mode no\n# 数据库数量\ndatabases 1\n# 日志\nlogfile /tmp/6379/run.log\n```\n\n将这个文件拷贝到每个目录下：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 执行拷贝\necho 7001 7002 7003 8001 8002 8003 | xargs -t -n 1 cp redis.conf\n```\n\n修改每个目录下的redis.conf，将其中的6379修改为与所在目录一致：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 修改配置文件\nprintf '%s\\n' 7001 7002 7003 8001 8002 8003 | xargs -I{} -t sed -i 's/6379/{}/g' {}/redis.conf\n```\n\n### 3.3、**启动**\n\n因为已经配置了后台启动模式，所以可以直接启动服务：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 一键启动所有服务\nprintf '%s\\n' 7001 7002 7003 8001 8002 8003 | xargs -I{} -t redis-server {}/redis.conf\n```\n\n通过ps查看状态：\n\n```java\nps -ef | grep redis\n```\n\n发现服务都已经正常启动：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-48-58.jpg)\n\n如果要关闭所有进程，可以执行命令：\n\n```java\nps -ef | grep redis | awk '{print $2}' | xargs kill\n```\n\n或者（推荐这种方式）：\n\n```java\nprintf '%s\\n' 7001 7002 7003 8001 8002 8003 | xargs -I{} -t redis-cli -p {} shutdown\n```\n\n### 3.4、**创建集群**\n\n虽然服务启动了，但是目前每个服务之间都是独立的，没有任何关联。\n\n我们需要执行命令来创建集群，在Redis5.0之前创建集群比较麻烦，5.0之后集群管理命令都集成到了redis-cli中。\n\n1）Redis5.0之前\n\nRedis5.0之前集群命令都是用redis安装包下的src/redis-trib.rb来实现的。因为redis-trib.rb是有ruby语言编写的所以需要安装ruby环境。\n\n```java\n# 安装依赖\nyum -y install zlib ruby rubygems\ngem install redis\n```\n\n然后通过命令来管理集群：\n\n```java\n# 进入redis的src目录\ncd /tmp/redis-6.2.4/src\n# 创建集群\n./redis-trib.rb create --replicas 1 192.168.150.101:7001 192.168.150.101:7002 192.168.150.101:7003 192.168.150.101:8001 192.168.150.101:8002 192.168.150.101:8003\n```\n\n2）Redis5.0以后\n\n我们使用的是Redis6.2.4版本，集群管理以及集成到了redis-cli中，格式如下：\n\n```java\nredis-cli --cluster create --cluster-replicas 1 192.168.150.101:7001 192.168.150.101:7002 192.168.150.101:7003 192.168.150.101:8001 192.168.150.101:8002 192.168.150.101:8003\n```\n\n命令说明：\n\n- redis-cli --cluster\n\n或者\n\n./redis-trib.rb：代表集群操作命令\n\n- create\n\n：代表是创建集群\n\n- --replicas 1\n\n或者\n\n--cluster-replicas 1 ：指定集群中每个master的副本个数为1，此时\n\n节点总数 ÷ (replicas + 1) 得到的就是master的数量。因此节点列表中的前n个就是master，其它节点都是slave节点，随机分配到不同master\n\n运行后的样子：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-42.jpg)\n\n这里输入yes，则集群开始创建：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-53.jpg)\n\n通过命令可以查看集群状态：\n\n```java\nredis-cli -p 7001 cluster nodes\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-52-08.jpg)\n\n### 3.5、测试\n\n尝试连接7001节点，存储一个数据：\n\n```java\n# 连接\nredis-cli -p 7001\n# 存储数据\nset num 123\n# 读取数据\nget num\n# 再次存储\nset a 1\n```\n\n结果悲剧了：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-06.jpg)\n\n集群操作时，需要给redis-cli加上-c参数才可以：\n\n```java\nredis-cli -c -p 7001\n```\n\n这次可以了：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-23.jpg)\n","source":"_posts/Redis集群搭建.md","raw":"---\ntitle: Redis集群搭建\ndate: 2025-03-20 14:36:00\ntags:\n- redis\ncategories:\n- Linux\n---\n\n# Redis集群搭建\n\n## 1、Redis主从集群\n\n### 1.1、集群结构\n\n搭建的主从集群结构如图：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_14-40-01.jpg)\n\n共包含三个节点，一个主节点，两个从节点。\n\n在同一台虚拟机中开启3个redis实例，模拟主从集群，信息如下：\n\n| IP              | PORT | 角色   |\n| --------------- | ---- | ------ |\n| 192.168.150.101 | 7001 | master |\n| 192.168.150.101 | 7002 | slave  |\n| 192.168.150.101 | 7003 | slave  |\n\n\n\n### 1.2、**准备实例和配置**\n\n要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。\n\n1）创建目录\n\n创建三个文件夹，名字分别叫7001、7002、7003：\n\n```\n# 进入/tmp目录\ncd /tmp\n# 创建目录\nmkdir 7001 7002 7003\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-11-14.jpg)\n\n2）恢复原始配置\n\n修改redis-6.2.4/redis.conf文件，将其中的持久化模式改为默认的RDB模式，AOF保持关闭状态。\n\n```\n# 开启RDB\n# save \"\"\nsave 3600 1\nsave 300 100\nsave 60 10000\n\n# 关闭AOF\nappendonly no\n```\n\n3）拷贝配置文件到每个实例目录\n\n然后将redis-6.2.4/redis.conf文件拷贝到三个目录中（在/tmp目录执行下列命令）：\n\n```\n# 方式一：逐个拷贝\ncp redis-6.2.4/redis.conf 7001\ncp redis-6.2.4/redis.conf 7002\ncp redis-6.2.4/redis.conf 7003\n# 方式二：管道组合命令，一键拷贝\necho 7001 7002 7003 | xargs -t -n 1 cp redis-6.2.4/redis.conf\n```\n\n4）修改每个实例的端口、工作目录\n\n修改每个文件夹内的配置文件，将端口分别修改为7001、7002、7003，将rdb文件保存位置都修改为自己所在目录（在/tmp目录执行下列命令）：\n\n```\nsed -i -e 's/6379/7001/g' -e 's/dir .\\//dir \\/tmp\\/7001\\//g' 7001/redis.conf\nsed -i -e 's/6379/7002/g' -e 's/dir .\\//dir \\/tmp\\/7002\\//g' 7002/redis.conf\nsed -i -e 's/6379/7003/g' -e 's/dir .\\//dir \\/tmp\\/7003\\//g' 7003/redis.conf\n```\n\n5）修改每个实例的声明IP\n\n虚拟机本身有多个IP，为了避免将来混乱，需要在redis.conf文件中指定每一个实例的绑定ip信息，格式如下：\n\n```\n# redis实例的声明 IP\nreplica-announce-ip 192.168.150.101\n```\n\n每个目录都要改，我们一键完成修改（在/tmp目录执行下列命令）：\n\n```\n# 逐一执行\nsed -i '1a replica-announce-ip 192.168.150.101' 7001/redis.conf\nsed -i '1a replica-announce-ip 192.168.150.101' 7002/redis.conf\nsed -i '1a replica-announce-ip 192.168.150.101' 7003/redis.conf\n\n# 或者一键修改\nprintf '%s\\n' 7001 7002 7003 | xargs -I{} -t sed -i '1a replica-announce-ip 192.168.150.101' {}/redis.conf\n```\n\n\n\n### 1.3、启动\n\n```\n# 第1个\nredis-server 7001/redis.conf\n# 第2个\nredis-server 7002/redis.conf\n# 第3个\nredis-server 7003/redis.conf\n或\n./redis-6.2.4/src/redis-server ./7001/redis.conf\n./redis-6.2.4/src/redis-server ./7002/redis.conf\n./redis-6.2.4/src/redis-server ./7003/redis.conf\n```\n\n启动后：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-12-26.jpg)\n\n```\n# 如果要一键停止，可以运行下面命令：\nprintf '%s\\n' 7001 7002 7003 | xargs -I{} -t redis-cli -p {} shutdown\n```\n\n\n\n### 1.4、开启主从关系\n\n现在三个实例还没有任何关系，要配置主从可以使用replicaof 或者slaveof（5.0以前）命令。\n\n有临时和永久两种模式：\n\n-  修改配置文件（永久生效） \n\nslaveof  \n\n-  使用redis-cli客户端连接到redis服务，执行slaveof命令（重启后失效）： \n\n```\nslaveof <masterip> <masterport>\n```\n\n**注意**：在5.0以后新增命令replicaof，与salveof效果一致。\n\n这里我们为了演示方便，使用方式二。\n\n通过redis-cli命令连接7002，执行下面命令：\n\n```\n# 连接 7002\nredis-cli -p 7002\n# 执行slaveof\nslaveof 124.183.178.142 7001\n```\n\n通过redis-cli命令连接7003，执行下面命令：\n\n```\n# 连接 7003\nredis-cli -p 7003\n# 执行slaveof\nslaveof 192.168.150.101 7001\n```\n\n然后连接 7001节点，查看集群状态：\n\n```\n# 连接 7001\nredis-cli -p 7001\n# 查看状态\ninfo replication\n```\n\n结果：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-22-47.jpg)\n\n### 1.5、测试\n\n执行下列操作以测试：\n\n-  利用redis-cli连接7001，执行\n\n```\nset num 123 \n```\n\n-  利用redis-cli连接7002，执行\n\n```\nget num，再执行\nset num 666 \n```\n\n-  利用redis-cli连接7003，执行\n\n```\nget num，再执行\nset num 888 \n```\n\n可以发现，只有在7001这个master节点上可以执行写操作，7002和7003这两个slave节点只能执行读操作。\n\n\n\n## 2、**搭建哨兵集群**\n\n### 2.1、**集群结构**\n\n这里我们搭建一个三节点形成的Sentinel集群，来监管之前的Redis主从集群。如图：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-36-19.jpg)\n\n三个sentinel实例信息如下：\n\n| 节点 | IP              | PORT  |\n| ---- | --------------- | ----- |\n| s1   | 192.168.150.101 | 27001 |\n| s2   | 192.168.150.101 | 27002 |\n| s3   | 192.168.150.101 | 27003 |\n\n### **3.2.准备实例和配置**\n\n要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。\n\n我们创建三个文件夹，名字分别叫s1、s2、s3：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 创建目录\nmkdir s1 s2 s3\n```\n\n然后我们在s1目录创建一个sentinel.conf文件，添加下面的内容：\n\n```java\nport 27001\nsentinel announce-ip 192.168.150.101\nsentinel monitor mymaster 192.168.150.101 7001 2\nsentinel down-after-milliseconds mymaster 5000\nsentinel failover-timeout mymaster 60000\ndir \"/tmp/s1\"\n```\n\n解读：\n\n- port 27001  ：是当前sentinel实例的端口\n\n- sentinel monitor mymaster 192.168.150.101 7001 2   ：指定主节点信息 \n\n- mymaster  ：主节点名称，自定义，任意写\n\n- 192.168.150.101 7001  ：主节点的ip和端口\n\n- 2  ：选举master时的quorum值\n\n然后将s1/sentinel.conf文件拷贝到s2、s3两个目录中（在/tmp目录执行下列命令）：\n\n```java\n# 方式一：逐个拷贝\ncp s1/sentinel.conf s2\ncp s1/sentinel.conf s3\n# 方式二：管道组合命令，一键拷贝\necho s2 s3 | xargs -t -n 1 cp s1/sentinel.conf\n```\n\n修改s2、s3两个文件夹内的配置文件，将端口分别修改为27002、27003：\n\n```java\nsed -i -e 's/27001/27002/g' -e 's/s1/s2/g' s2/sentinel.conf\nsed -i -e 's/27001/27003/g' -e 's/s1/s3/g' s3/sentinel.conf\n```\n\n### 2.3、启动\n\n为了方便查看日志，我们打开3个ssh窗口，分别启动3个redis实例，启动命令：\n\n```java\n# 第1个\nredis-sentinel s1/sentinel.conf\n./redis-6.2.4/src/redis-sentinel ./s1/sentinel.conf\n# 第2个\nredis-sentinel s2/sentinel.conf\n./redis-6.2.4/src/redis-sentinel ./s2/sentinel.conf\n# 第3个\nredis-sentinel s3/sentinel.conf\n./redis-6.2.4/src/redis-sentinel ./s3/sentinel.conf\n```\n\n启动后：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-39-20.jpg)\n\n### 2.3、测试\n\n尝试让master节点7001宕机，查看sentinel日志：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-42-35.jpg)\n\n查看7003的日志：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-20.jpg)\n\n查看7002的日志：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-38.jpg)\n\n## 3、搭建分片集群\n\n### 3.1、**集群结构**\n\n分片集群需要的节点数量较多，这里我们搭建一个最小的分片集群，包含3个master节点，每个master包含一个slave节点，结构如下：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-45-49.jpg)\n\n这里我们会在同一台虚拟机中开启6个redis实例，模拟分片集群，信息如下：\n\n| IP              | PORT | 角色   |\n| --------------- | ---- | ------ |\n| 192.168.150.101 | 7001 | master |\n| 192.168.150.101 | 7002 | master |\n| 192.168.150.101 | 7003 | master |\n| 192.168.150.101 | 8001 | slave  |\n| 192.168.150.101 | 8002 | slave  |\n| 192.168.150.101 | 8003 | slave  |\n\n### 3.2、**准备实例和配置**\n\n删除之前的7001、7002、7003这几个目录，重新创建出7001、7002、7003、8001、8002、8003目录：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 删除旧的，避免配置干扰\nrm -rf 7001 7002 7003\n# 创建目录\nmkdir 7001 7002 7003 8001 8002 8003\n```\n\n在/tmp下准备一个新的redis.conf文件，内容如下：\n\n```java\nport 6379\n# 开启集群功能\ncluster-enabled yes\n# 集群的配置文件名称，不需要我们创建，由redis自己维护\ncluster-config-file /tmp/6379/nodes.conf\n# 节点心跳失败的超时时间\ncluster-node-timeout 5000\n# 持久化文件存放目录\ndir /tmp/6379\n# 绑定地址\nbind 0.0.0.0\n# 让redis后台运行,守护进程\ndaemonize yes\n# 注册的实例ip\nreplica-announce-ip 192.168.150.101\n# 保护模式\nprotected-mode no\n# 数据库数量\ndatabases 1\n# 日志\nlogfile /tmp/6379/run.log\n```\n\n将这个文件拷贝到每个目录下：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 执行拷贝\necho 7001 7002 7003 8001 8002 8003 | xargs -t -n 1 cp redis.conf\n```\n\n修改每个目录下的redis.conf，将其中的6379修改为与所在目录一致：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 修改配置文件\nprintf '%s\\n' 7001 7002 7003 8001 8002 8003 | xargs -I{} -t sed -i 's/6379/{}/g' {}/redis.conf\n```\n\n### 3.3、**启动**\n\n因为已经配置了后台启动模式，所以可以直接启动服务：\n\n```java\n# 进入/tmp目录\ncd /tmp\n# 一键启动所有服务\nprintf '%s\\n' 7001 7002 7003 8001 8002 8003 | xargs -I{} -t redis-server {}/redis.conf\n```\n\n通过ps查看状态：\n\n```java\nps -ef | grep redis\n```\n\n发现服务都已经正常启动：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-48-58.jpg)\n\n如果要关闭所有进程，可以执行命令：\n\n```java\nps -ef | grep redis | awk '{print $2}' | xargs kill\n```\n\n或者（推荐这种方式）：\n\n```java\nprintf '%s\\n' 7001 7002 7003 8001 8002 8003 | xargs -I{} -t redis-cli -p {} shutdown\n```\n\n### 3.4、**创建集群**\n\n虽然服务启动了，但是目前每个服务之间都是独立的，没有任何关联。\n\n我们需要执行命令来创建集群，在Redis5.0之前创建集群比较麻烦，5.0之后集群管理命令都集成到了redis-cli中。\n\n1）Redis5.0之前\n\nRedis5.0之前集群命令都是用redis安装包下的src/redis-trib.rb来实现的。因为redis-trib.rb是有ruby语言编写的所以需要安装ruby环境。\n\n```java\n# 安装依赖\nyum -y install zlib ruby rubygems\ngem install redis\n```\n\n然后通过命令来管理集群：\n\n```java\n# 进入redis的src目录\ncd /tmp/redis-6.2.4/src\n# 创建集群\n./redis-trib.rb create --replicas 1 192.168.150.101:7001 192.168.150.101:7002 192.168.150.101:7003 192.168.150.101:8001 192.168.150.101:8002 192.168.150.101:8003\n```\n\n2）Redis5.0以后\n\n我们使用的是Redis6.2.4版本，集群管理以及集成到了redis-cli中，格式如下：\n\n```java\nredis-cli --cluster create --cluster-replicas 1 192.168.150.101:7001 192.168.150.101:7002 192.168.150.101:7003 192.168.150.101:8001 192.168.150.101:8002 192.168.150.101:8003\n```\n\n命令说明：\n\n- redis-cli --cluster\n\n或者\n\n./redis-trib.rb：代表集群操作命令\n\n- create\n\n：代表是创建集群\n\n- --replicas 1\n\n或者\n\n--cluster-replicas 1 ：指定集群中每个master的副本个数为1，此时\n\n节点总数 ÷ (replicas + 1) 得到的就是master的数量。因此节点列表中的前n个就是master，其它节点都是slave节点，随机分配到不同master\n\n运行后的样子：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-42.jpg)\n\n这里输入yes，则集群开始创建：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-53.jpg)\n\n通过命令可以查看集群状态：\n\n```java\nredis-cli -p 7001 cluster nodes\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-52-08.jpg)\n\n### 3.5、测试\n\n尝试连接7001节点，存储一个数据：\n\n```java\n# 连接\nredis-cli -p 7001\n# 存储数据\nset num 123\n# 读取数据\nget num\n# 再次存储\nset a 1\n```\n\n结果悲剧了：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-06.jpg)\n\n集群操作时，需要给redis-cli加上-c参数才可以：\n\n```java\nredis-cli -c -p 7001\n```\n\n这次可以了：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-23.jpg)\n","slug":"Redis集群搭建","published":1,"updated":"2025-03-20T11:59:22.809Z","comments":1,"layout":"post","photos":[],"_id":"cmck4zyrf0007t0am1vz09i00","content":"<h1 id=\"Redis集群搭建\"><a href=\"#Redis集群搭建\" class=\"headerlink\" title=\"Redis集群搭建\"></a>Redis集群搭建</h1><h2 id=\"1、Redis主从集群\"><a href=\"#1、Redis主从集群\" class=\"headerlink\" title=\"1、Redis主从集群\"></a>1、Redis主从集群</h2><h3 id=\"1-1、集群结构\"><a href=\"#1-1、集群结构\" class=\"headerlink\" title=\"1.1、集群结构\"></a>1.1、集群结构</h3><p>搭建的主从集群结构如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_14-40-01.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_14-40-01.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>共包含三个节点，一个主节点，两个从节点。</p>\n<p>在同一台虚拟机中开启3个redis实例，模拟主从集群，信息如下：</p>\n<table>\n<thead>\n<tr>\n<th>IP</th>\n<th>PORT</th>\n<th>角色</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>192.168.150.101</td>\n<td>7001</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7002</td>\n<td>slave</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7003</td>\n<td>slave</td>\n</tr>\n</tbody></table>\n<h3 id=\"1-2、准备实例和配置\"><a href=\"#1-2、准备实例和配置\" class=\"headerlink\" title=\"1.2、准备实例和配置\"></a>1.2、<strong>准备实例和配置</strong></h3><p>要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。</p>\n<p>1）创建目录</p>\n<p>创建三个文件夹，名字分别叫7001、7002、7003：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 创建目录</span><br><span class=\"line\">mkdir 7001 7002 7003</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-11-14.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-11-14.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>2）恢复原始配置</p>\n<p>修改redis-6.2.4&#x2F;redis.conf文件，将其中的持久化模式改为默认的RDB模式，AOF保持关闭状态。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 开启RDB</span><br><span class=\"line\"># save &quot;&quot;</span><br><span class=\"line\">save 3600 1</span><br><span class=\"line\">save 300 100</span><br><span class=\"line\">save 60 10000</span><br><span class=\"line\"></span><br><span class=\"line\"># 关闭AOF</span><br><span class=\"line\">appendonly no</span><br></pre></td></tr></table></figure>\n\n<p>3）拷贝配置文件到每个实例目录</p>\n<p>然后将redis-6.2.4&#x2F;redis.conf文件拷贝到三个目录中（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 方式一：逐个拷贝</span><br><span class=\"line\">cp redis-6.2.4/redis.conf 7001</span><br><span class=\"line\">cp redis-6.2.4/redis.conf 7002</span><br><span class=\"line\">cp redis-6.2.4/redis.conf 7003</span><br><span class=\"line\"># 方式二：管道组合命令，一键拷贝</span><br><span class=\"line\">echo 7001 7002 7003 | xargs -t -n 1 cp redis-6.2.4/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>4）修改每个实例的端口、工作目录</p>\n<p>修改每个文件夹内的配置文件，将端口分别修改为7001、7002、7003，将rdb文件保存位置都修改为自己所在目录（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sed -i -e &#x27;s/6379/7001/g&#x27; -e &#x27;s/dir .\\//dir \\/tmp\\/7001\\//g&#x27; 7001/redis.conf</span><br><span class=\"line\">sed -i -e &#x27;s/6379/7002/g&#x27; -e &#x27;s/dir .\\//dir \\/tmp\\/7002\\//g&#x27; 7002/redis.conf</span><br><span class=\"line\">sed -i -e &#x27;s/6379/7003/g&#x27; -e &#x27;s/dir .\\//dir \\/tmp\\/7003\\//g&#x27; 7003/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>5）修改每个实例的声明IP</p>\n<p>虚拟机本身有多个IP，为了避免将来混乱，需要在redis.conf文件中指定每一个实例的绑定ip信息，格式如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># redis实例的声明 IP</span><br><span class=\"line\">replica-announce-ip 192.168.150.101</span><br></pre></td></tr></table></figure>\n\n<p>每个目录都要改，我们一键完成修改（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 逐一执行</span><br><span class=\"line\">sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; 7001/redis.conf</span><br><span class=\"line\">sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; 7002/redis.conf</span><br><span class=\"line\">sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; 7003/redis.conf</span><br><span class=\"line\"></span><br><span class=\"line\"># 或者一键修改</span><br><span class=\"line\">printf &#x27;%s\\n&#x27; 7001 7002 7003 | xargs -I&#123;&#125; -t sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; &#123;&#125;/redis.conf</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"1-3、启动\"><a href=\"#1-3、启动\" class=\"headerlink\" title=\"1.3、启动\"></a>1.3、启动</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 第1个</span><br><span class=\"line\">redis-server 7001/redis.conf</span><br><span class=\"line\"># 第2个</span><br><span class=\"line\">redis-server 7002/redis.conf</span><br><span class=\"line\"># 第3个</span><br><span class=\"line\">redis-server 7003/redis.conf</span><br><span class=\"line\">或</span><br><span class=\"line\">./redis-6.2.4/src/redis-server ./7001/redis.conf</span><br><span class=\"line\">./redis-6.2.4/src/redis-server ./7002/redis.conf</span><br><span class=\"line\">./redis-6.2.4/src/redis-server ./7003/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>启动后：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-12-26.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-12-26.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 如果要一键停止，可以运行下面命令：</span><br><span class=\"line\">printf &#x27;%s\\n&#x27; 7001 7002 7003 | xargs -I&#123;&#125; -t redis-cli -p &#123;&#125; shutdown</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"1-4、开启主从关系\"><a href=\"#1-4、开启主从关系\" class=\"headerlink\" title=\"1.4、开启主从关系\"></a>1.4、开启主从关系</h3><p>现在三个实例还没有任何关系，要配置主从可以使用replicaof 或者slaveof（5.0以前）命令。</p>\n<p>有临时和永久两种模式：</p>\n<ul>\n<li>修改配置文件（永久生效）</li>\n</ul>\n<p>slaveof  </p>\n<ul>\n<li>使用redis-cli客户端连接到redis服务，执行slaveof命令（重启后失效）：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：在5.0以后新增命令replicaof，与salveof效果一致。</p>\n<p>这里我们为了演示方便，使用方式二。</p>\n<p>通过redis-cli命令连接7002，执行下面命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接 7002</span><br><span class=\"line\">redis-cli -p 7002</span><br><span class=\"line\"># 执行slaveof</span><br><span class=\"line\">slaveof 124.183.178.142 7001</span><br></pre></td></tr></table></figure>\n\n<p>通过redis-cli命令连接7003，执行下面命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接 7003</span><br><span class=\"line\">redis-cli -p 7003</span><br><span class=\"line\"># 执行slaveof</span><br><span class=\"line\">slaveof 192.168.150.101 7001</span><br></pre></td></tr></table></figure>\n\n<p>然后连接 7001节点，查看集群状态：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接 7001</span><br><span class=\"line\">redis-cli -p 7001</span><br><span class=\"line\"># 查看状态</span><br><span class=\"line\">info replication</span><br></pre></td></tr></table></figure>\n\n<p>结果：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-22-47.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-22-47.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h3 id=\"1-5、测试\"><a href=\"#1-5、测试\" class=\"headerlink\" title=\"1.5、测试\"></a>1.5、测试</h3><p>执行下列操作以测试：</p>\n<ul>\n<li>利用redis-cli连接7001，执行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set num 123 </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>利用redis-cli连接7002，执行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get num，再执行</span><br><span class=\"line\">set num 666 </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>利用redis-cli连接7003，执行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get num，再执行</span><br><span class=\"line\">set num 888 </span><br></pre></td></tr></table></figure>\n\n<p>可以发现，只有在7001这个master节点上可以执行写操作，7002和7003这两个slave节点只能执行读操作。</p>\n<h2 id=\"2、搭建哨兵集群\"><a href=\"#2、搭建哨兵集群\" class=\"headerlink\" title=\"2、搭建哨兵集群\"></a>2、<strong>搭建哨兵集群</strong></h2><h3 id=\"2-1、集群结构\"><a href=\"#2-1、集群结构\" class=\"headerlink\" title=\"2.1、集群结构\"></a>2.1、<strong>集群结构</strong></h3><p>这里我们搭建一个三节点形成的Sentinel集群，来监管之前的Redis主从集群。如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-36-19.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-36-19.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>三个sentinel实例信息如下：</p>\n<table>\n<thead>\n<tr>\n<th>节点</th>\n<th>IP</th>\n<th>PORT</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>s1</td>\n<td>192.168.150.101</td>\n<td>27001</td>\n</tr>\n<tr>\n<td>s2</td>\n<td>192.168.150.101</td>\n<td>27002</td>\n</tr>\n<tr>\n<td>s3</td>\n<td>192.168.150.101</td>\n<td>27003</td>\n</tr>\n</tbody></table>\n<h3 id=\"3-2-准备实例和配置\"><a href=\"#3-2-准备实例和配置\" class=\"headerlink\" title=\"3.2.准备实例和配置\"></a><strong>3.2.准备实例和配置</strong></h3><p>要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。</p>\n<p>我们创建三个文件夹，名字分别叫s1、s2、s3：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 创建目录</span><br><span class=\"line\">mkdir s1 s2 s3</span><br></pre></td></tr></table></figure>\n\n<p>然后我们在s1目录创建一个sentinel.conf文件，添加下面的内容：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">port <span class=\"number\">27001</span></span><br><span class=\"line\">sentinel announce-ip <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span></span><br><span class=\"line\">sentinel monitor mymaster <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span> <span class=\"number\">7001</span> <span class=\"number\">2</span></span><br><span class=\"line\">sentinel down-after-milliseconds mymaster <span class=\"number\">5000</span></span><br><span class=\"line\">sentinel failover-timeout mymaster <span class=\"number\">60000</span></span><br><span class=\"line\">dir <span class=\"string\">&quot;/tmp/s1&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>解读：</p>\n<ul>\n<li><p>port 27001  ：是当前sentinel实例的端口</p>\n</li>\n<li><p>sentinel monitor mymaster 192.168.150.101 7001 2   ：指定主节点信息 </p>\n</li>\n<li><p>mymaster  ：主节点名称，自定义，任意写</p>\n</li>\n<li><p>192.168.150.101 7001  ：主节点的ip和端口</p>\n</li>\n<li><p>2  ：选举master时的quorum值</p>\n</li>\n</ul>\n<p>然后将s1&#x2F;sentinel.conf文件拷贝到s2、s3两个目录中（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 方式一：逐个拷贝</span><br><span class=\"line\">cp s1/sentinel.conf s2</span><br><span class=\"line\">cp s1/sentinel.conf s3</span><br><span class=\"line\"># 方式二：管道组合命令，一键拷贝</span><br><span class=\"line\">echo s2 s3 | xargs -t -n <span class=\"number\">1</span> cp s1/sentinel.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改s2、s3两个文件夹内的配置文件，将端口分别修改为27002、27003：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sed -i -e <span class=\"string\">&#x27;s/27001/27002/g&#x27;</span> -e <span class=\"string\">&#x27;s/s1/s2/g&#x27;</span> s2/sentinel.conf</span><br><span class=\"line\">sed -i -e <span class=\"string\">&#x27;s/27001/27003/g&#x27;</span> -e <span class=\"string\">&#x27;s/s1/s3/g&#x27;</span> s3/sentinel.conf</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-3、启动\"><a href=\"#2-3、启动\" class=\"headerlink\" title=\"2.3、启动\"></a>2.3、启动</h3><p>为了方便查看日志，我们打开3个ssh窗口，分别启动3个redis实例，启动命令：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 第<span class=\"number\">1</span>个</span><br><span class=\"line\">redis-sentinel s1/sentinel.conf</span><br><span class=\"line\">./redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src/redis-sentinel ./s1/sentinel.conf</span><br><span class=\"line\"># 第<span class=\"number\">2</span>个</span><br><span class=\"line\">redis-sentinel s2/sentinel.conf</span><br><span class=\"line\">./redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src/redis-sentinel ./s2/sentinel.conf</span><br><span class=\"line\"># 第<span class=\"number\">3</span>个</span><br><span class=\"line\">redis-sentinel s3/sentinel.conf</span><br><span class=\"line\">./redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src/redis-sentinel ./s3/sentinel.conf</span><br></pre></td></tr></table></figure>\n\n<p>启动后：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-39-20.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-39-20.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h3 id=\"2-3、测试\"><a href=\"#2-3、测试\" class=\"headerlink\" title=\"2.3、测试\"></a>2.3、测试</h3><p>尝试让master节点7001宕机，查看sentinel日志：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-42-35.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-42-35.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>查看7003的日志：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-20.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-20.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>查看7002的日志：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-38.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-38.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h2 id=\"3、搭建分片集群\"><a href=\"#3、搭建分片集群\" class=\"headerlink\" title=\"3、搭建分片集群\"></a>3、搭建分片集群</h2><h3 id=\"3-1、集群结构\"><a href=\"#3-1、集群结构\" class=\"headerlink\" title=\"3.1、集群结构\"></a>3.1、<strong>集群结构</strong></h3><p>分片集群需要的节点数量较多，这里我们搭建一个最小的分片集群，包含3个master节点，每个master包含一个slave节点，结构如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-45-49.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-45-49.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>这里我们会在同一台虚拟机中开启6个redis实例，模拟分片集群，信息如下：</p>\n<table>\n<thead>\n<tr>\n<th>IP</th>\n<th>PORT</th>\n<th>角色</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>192.168.150.101</td>\n<td>7001</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7002</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7003</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>8001</td>\n<td>slave</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>8002</td>\n<td>slave</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>8003</td>\n<td>slave</td>\n</tr>\n</tbody></table>\n<h3 id=\"3-2、准备实例和配置\"><a href=\"#3-2、准备实例和配置\" class=\"headerlink\" title=\"3.2、准备实例和配置\"></a>3.2、<strong>准备实例和配置</strong></h3><p>删除之前的7001、7002、7003这几个目录，重新创建出7001、7002、7003、8001、8002、8003目录：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 删除旧的，避免配置干扰</span><br><span class=\"line\">rm -rf <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span></span><br><span class=\"line\"># 创建目录</span><br><span class=\"line\">mkdir <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span></span><br></pre></td></tr></table></figure>\n\n<p>在&#x2F;tmp下准备一个新的redis.conf文件，内容如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">port <span class=\"number\">6379</span></span><br><span class=\"line\"># 开启集群功能</span><br><span class=\"line\">cluster-enabled yes</span><br><span class=\"line\"># 集群的配置文件名称，不需要我们创建，由redis自己维护</span><br><span class=\"line\">cluster-config-file /tmp/<span class=\"number\">6379</span>/nodes.conf</span><br><span class=\"line\"># 节点心跳失败的超时时间</span><br><span class=\"line\">cluster-node-timeout <span class=\"number\">5000</span></span><br><span class=\"line\"># 持久化文件存放目录</span><br><span class=\"line\">dir /tmp/<span class=\"number\">6379</span></span><br><span class=\"line\"># 绑定地址</span><br><span class=\"line\">bind <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span></span><br><span class=\"line\"># 让redis后台运行,守护进程</span><br><span class=\"line\">daemonize yes</span><br><span class=\"line\"># 注册的实例ip</span><br><span class=\"line\">replica-announce-ip <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span></span><br><span class=\"line\"># 保护模式</span><br><span class=\"line\"><span class=\"keyword\">protected</span>-mode no</span><br><span class=\"line\"># 数据库数量</span><br><span class=\"line\">databases <span class=\"number\">1</span></span><br><span class=\"line\"># 日志</span><br><span class=\"line\">logfile /tmp/<span class=\"number\">6379</span>/run.log</span><br></pre></td></tr></table></figure>\n\n<p>将这个文件拷贝到每个目录下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 执行拷贝</span><br><span class=\"line\">echo <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -t -n <span class=\"number\">1</span> cp redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改每个目录下的redis.conf，将其中的6379修改为与所在目录一致：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 修改配置文件</span><br><span class=\"line\">printf <span class=\"string\">&#x27;%s\\n&#x27;</span> <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -I&#123;&#125; -t sed -i <span class=\"string\">&#x27;s/6379/&#123;&#125;/g&#x27;</span> &#123;&#125;/redis.conf</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-3、启动\"><a href=\"#3-3、启动\" class=\"headerlink\" title=\"3.3、启动\"></a>3.3、<strong>启动</strong></h3><p>因为已经配置了后台启动模式，所以可以直接启动服务：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 一键启动所有服务</span><br><span class=\"line\">printf <span class=\"string\">&#x27;%s\\n&#x27;</span> <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -I&#123;&#125; -t redis-server &#123;&#125;/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>通过ps查看状态：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep redis</span><br></pre></td></tr></table></figure>\n\n<p>发现服务都已经正常启动：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-48-58.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-48-58.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>如果要关闭所有进程，可以执行命令：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep redis | awk <span class=\"string\">&#x27;&#123;print $2&#125;&#x27;</span> | xargs kill</span><br></pre></td></tr></table></figure>\n\n<p>或者（推荐这种方式）：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">printf <span class=\"string\">&#x27;%s\\n&#x27;</span> <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -I&#123;&#125; -t redis-cli -p &#123;&#125; shutdown</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-4、创建集群\"><a href=\"#3-4、创建集群\" class=\"headerlink\" title=\"3.4、创建集群\"></a>3.4、<strong>创建集群</strong></h3><p>虽然服务启动了，但是目前每个服务之间都是独立的，没有任何关联。</p>\n<p>我们需要执行命令来创建集群，在Redis5.0之前创建集群比较麻烦，5.0之后集群管理命令都集成到了redis-cli中。</p>\n<p>1）Redis5.0之前</p>\n<p>Redis5.0之前集群命令都是用redis安装包下的src&#x2F;redis-trib.rb来实现的。因为redis-trib.rb是有ruby语言编写的所以需要安装ruby环境。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 安装依赖</span><br><span class=\"line\">yum -y install zlib ruby rubygems</span><br><span class=\"line\">gem install redis</span><br></pre></td></tr></table></figure>\n\n<p>然后通过命令来管理集群：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入redis的src目录</span><br><span class=\"line\">cd /tmp/redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src</span><br><span class=\"line\"># 创建集群</span><br><span class=\"line\">./redis-trib.rb create --replicas <span class=\"number\">1</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7003</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8003</span></span><br></pre></td></tr></table></figure>\n\n<p>2）Redis5.0以后</p>\n<p>我们使用的是Redis6.2.4版本，集群管理以及集成到了redis-cli中，格式如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli --cluster create --cluster-replicas <span class=\"number\">1</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7003</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8003</span></span><br></pre></td></tr></table></figure>\n\n<p>命令说明：</p>\n<ul>\n<li>redis-cli –cluster</li>\n</ul>\n<p>或者</p>\n<p>.&#x2F;redis-trib.rb：代表集群操作命令</p>\n<ul>\n<li>create</li>\n</ul>\n<p>：代表是创建集群</p>\n<ul>\n<li>–replicas 1</li>\n</ul>\n<p>或者</p>\n<p>–cluster-replicas 1 ：指定集群中每个master的副本个数为1，此时</p>\n<p>节点总数 ÷ (replicas + 1) 得到的就是master的数量。因此节点列表中的前n个就是master，其它节点都是slave节点，随机分配到不同master</p>\n<p>运行后的样子：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-42.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-42.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>这里输入yes，则集群开始创建：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-53.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-53.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>通过命令可以查看集群状态：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli -p <span class=\"number\">7001</span> cluster nodes</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-52-08.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-52-08.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h3 id=\"3-5、测试\"><a href=\"#3-5、测试\" class=\"headerlink\" title=\"3.5、测试\"></a>3.5、测试</h3><p>尝试连接7001节点，存储一个数据：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接</span><br><span class=\"line\">redis-cli -p <span class=\"number\">7001</span></span><br><span class=\"line\"># 存储数据</span><br><span class=\"line\">set num <span class=\"number\">123</span></span><br><span class=\"line\"># 读取数据</span><br><span class=\"line\">get num</span><br><span class=\"line\"># 再次存储</span><br><span class=\"line\">set a <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<p>结果悲剧了：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-06.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-06.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>集群操作时，需要给redis-cli加上-c参数才可以：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli -c -p <span class=\"number\">7001</span></span><br></pre></td></tr></table></figure>\n\n<p>这次可以了：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-23.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-23.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n","excerpt":"","more":"<h1 id=\"Redis集群搭建\"><a href=\"#Redis集群搭建\" class=\"headerlink\" title=\"Redis集群搭建\"></a>Redis集群搭建</h1><h2 id=\"1、Redis主从集群\"><a href=\"#1、Redis主从集群\" class=\"headerlink\" title=\"1、Redis主从集群\"></a>1、Redis主从集群</h2><h3 id=\"1-1、集群结构\"><a href=\"#1-1、集群结构\" class=\"headerlink\" title=\"1.1、集群结构\"></a>1.1、集群结构</h3><p>搭建的主从集群结构如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_14-40-01.jpg\"></p>\n<p>共包含三个节点，一个主节点，两个从节点。</p>\n<p>在同一台虚拟机中开启3个redis实例，模拟主从集群，信息如下：</p>\n<table>\n<thead>\n<tr>\n<th>IP</th>\n<th>PORT</th>\n<th>角色</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>192.168.150.101</td>\n<td>7001</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7002</td>\n<td>slave</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7003</td>\n<td>slave</td>\n</tr>\n</tbody></table>\n<h3 id=\"1-2、准备实例和配置\"><a href=\"#1-2、准备实例和配置\" class=\"headerlink\" title=\"1.2、准备实例和配置\"></a>1.2、<strong>准备实例和配置</strong></h3><p>要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。</p>\n<p>1）创建目录</p>\n<p>创建三个文件夹，名字分别叫7001、7002、7003：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 创建目录</span><br><span class=\"line\">mkdir 7001 7002 7003</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-11-14.jpg\"></p>\n<p>2）恢复原始配置</p>\n<p>修改redis-6.2.4&#x2F;redis.conf文件，将其中的持久化模式改为默认的RDB模式，AOF保持关闭状态。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 开启RDB</span><br><span class=\"line\"># save &quot;&quot;</span><br><span class=\"line\">save 3600 1</span><br><span class=\"line\">save 300 100</span><br><span class=\"line\">save 60 10000</span><br><span class=\"line\"></span><br><span class=\"line\"># 关闭AOF</span><br><span class=\"line\">appendonly no</span><br></pre></td></tr></table></figure>\n\n<p>3）拷贝配置文件到每个实例目录</p>\n<p>然后将redis-6.2.4&#x2F;redis.conf文件拷贝到三个目录中（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 方式一：逐个拷贝</span><br><span class=\"line\">cp redis-6.2.4/redis.conf 7001</span><br><span class=\"line\">cp redis-6.2.4/redis.conf 7002</span><br><span class=\"line\">cp redis-6.2.4/redis.conf 7003</span><br><span class=\"line\"># 方式二：管道组合命令，一键拷贝</span><br><span class=\"line\">echo 7001 7002 7003 | xargs -t -n 1 cp redis-6.2.4/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>4）修改每个实例的端口、工作目录</p>\n<p>修改每个文件夹内的配置文件，将端口分别修改为7001、7002、7003，将rdb文件保存位置都修改为自己所在目录（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sed -i -e &#x27;s/6379/7001/g&#x27; -e &#x27;s/dir .\\//dir \\/tmp\\/7001\\//g&#x27; 7001/redis.conf</span><br><span class=\"line\">sed -i -e &#x27;s/6379/7002/g&#x27; -e &#x27;s/dir .\\//dir \\/tmp\\/7002\\//g&#x27; 7002/redis.conf</span><br><span class=\"line\">sed -i -e &#x27;s/6379/7003/g&#x27; -e &#x27;s/dir .\\//dir \\/tmp\\/7003\\//g&#x27; 7003/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>5）修改每个实例的声明IP</p>\n<p>虚拟机本身有多个IP，为了避免将来混乱，需要在redis.conf文件中指定每一个实例的绑定ip信息，格式如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># redis实例的声明 IP</span><br><span class=\"line\">replica-announce-ip 192.168.150.101</span><br></pre></td></tr></table></figure>\n\n<p>每个目录都要改，我们一键完成修改（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 逐一执行</span><br><span class=\"line\">sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; 7001/redis.conf</span><br><span class=\"line\">sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; 7002/redis.conf</span><br><span class=\"line\">sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; 7003/redis.conf</span><br><span class=\"line\"></span><br><span class=\"line\"># 或者一键修改</span><br><span class=\"line\">printf &#x27;%s\\n&#x27; 7001 7002 7003 | xargs -I&#123;&#125; -t sed -i &#x27;1a replica-announce-ip 192.168.150.101&#x27; &#123;&#125;/redis.conf</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"1-3、启动\"><a href=\"#1-3、启动\" class=\"headerlink\" title=\"1.3、启动\"></a>1.3、启动</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 第1个</span><br><span class=\"line\">redis-server 7001/redis.conf</span><br><span class=\"line\"># 第2个</span><br><span class=\"line\">redis-server 7002/redis.conf</span><br><span class=\"line\"># 第3个</span><br><span class=\"line\">redis-server 7003/redis.conf</span><br><span class=\"line\">或</span><br><span class=\"line\">./redis-6.2.4/src/redis-server ./7001/redis.conf</span><br><span class=\"line\">./redis-6.2.4/src/redis-server ./7002/redis.conf</span><br><span class=\"line\">./redis-6.2.4/src/redis-server ./7003/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>启动后：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-12-26.jpg\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 如果要一键停止，可以运行下面命令：</span><br><span class=\"line\">printf &#x27;%s\\n&#x27; 7001 7002 7003 | xargs -I&#123;&#125; -t redis-cli -p &#123;&#125; shutdown</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"1-4、开启主从关系\"><a href=\"#1-4、开启主从关系\" class=\"headerlink\" title=\"1.4、开启主从关系\"></a>1.4、开启主从关系</h3><p>现在三个实例还没有任何关系，要配置主从可以使用replicaof 或者slaveof（5.0以前）命令。</p>\n<p>有临时和永久两种模式：</p>\n<ul>\n<li>修改配置文件（永久生效）</li>\n</ul>\n<p>slaveof  </p>\n<ul>\n<li>使用redis-cli客户端连接到redis服务，执行slaveof命令（重启后失效）：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：在5.0以后新增命令replicaof，与salveof效果一致。</p>\n<p>这里我们为了演示方便，使用方式二。</p>\n<p>通过redis-cli命令连接7002，执行下面命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接 7002</span><br><span class=\"line\">redis-cli -p 7002</span><br><span class=\"line\"># 执行slaveof</span><br><span class=\"line\">slaveof 124.183.178.142 7001</span><br></pre></td></tr></table></figure>\n\n<p>通过redis-cli命令连接7003，执行下面命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接 7003</span><br><span class=\"line\">redis-cli -p 7003</span><br><span class=\"line\"># 执行slaveof</span><br><span class=\"line\">slaveof 192.168.150.101 7001</span><br></pre></td></tr></table></figure>\n\n<p>然后连接 7001节点，查看集群状态：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接 7001</span><br><span class=\"line\">redis-cli -p 7001</span><br><span class=\"line\"># 查看状态</span><br><span class=\"line\">info replication</span><br></pre></td></tr></table></figure>\n\n<p>结果：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-22-47.jpg\"></p>\n<h3 id=\"1-5、测试\"><a href=\"#1-5、测试\" class=\"headerlink\" title=\"1.5、测试\"></a>1.5、测试</h3><p>执行下列操作以测试：</p>\n<ul>\n<li>利用redis-cli连接7001，执行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set num 123 </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>利用redis-cli连接7002，执行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get num，再执行</span><br><span class=\"line\">set num 666 </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>利用redis-cli连接7003，执行</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get num，再执行</span><br><span class=\"line\">set num 888 </span><br></pre></td></tr></table></figure>\n\n<p>可以发现，只有在7001这个master节点上可以执行写操作，7002和7003这两个slave节点只能执行读操作。</p>\n<h2 id=\"2、搭建哨兵集群\"><a href=\"#2、搭建哨兵集群\" class=\"headerlink\" title=\"2、搭建哨兵集群\"></a>2、<strong>搭建哨兵集群</strong></h2><h3 id=\"2-1、集群结构\"><a href=\"#2-1、集群结构\" class=\"headerlink\" title=\"2.1、集群结构\"></a>2.1、<strong>集群结构</strong></h3><p>这里我们搭建一个三节点形成的Sentinel集群，来监管之前的Redis主从集群。如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-36-19.jpg\"></p>\n<p>三个sentinel实例信息如下：</p>\n<table>\n<thead>\n<tr>\n<th>节点</th>\n<th>IP</th>\n<th>PORT</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>s1</td>\n<td>192.168.150.101</td>\n<td>27001</td>\n</tr>\n<tr>\n<td>s2</td>\n<td>192.168.150.101</td>\n<td>27002</td>\n</tr>\n<tr>\n<td>s3</td>\n<td>192.168.150.101</td>\n<td>27003</td>\n</tr>\n</tbody></table>\n<h3 id=\"3-2-准备实例和配置\"><a href=\"#3-2-准备实例和配置\" class=\"headerlink\" title=\"3.2.准备实例和配置\"></a><strong>3.2.准备实例和配置</strong></h3><p>要在同一台虚拟机开启3个实例，必须准备三份不同的配置文件和目录，配置文件所在目录也就是工作目录。</p>\n<p>我们创建三个文件夹，名字分别叫s1、s2、s3：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 创建目录</span><br><span class=\"line\">mkdir s1 s2 s3</span><br></pre></td></tr></table></figure>\n\n<p>然后我们在s1目录创建一个sentinel.conf文件，添加下面的内容：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">port <span class=\"number\">27001</span></span><br><span class=\"line\">sentinel announce-ip <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span></span><br><span class=\"line\">sentinel monitor mymaster <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span> <span class=\"number\">7001</span> <span class=\"number\">2</span></span><br><span class=\"line\">sentinel down-after-milliseconds mymaster <span class=\"number\">5000</span></span><br><span class=\"line\">sentinel failover-timeout mymaster <span class=\"number\">60000</span></span><br><span class=\"line\">dir <span class=\"string\">&quot;/tmp/s1&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>解读：</p>\n<ul>\n<li><p>port 27001  ：是当前sentinel实例的端口</p>\n</li>\n<li><p>sentinel monitor mymaster 192.168.150.101 7001 2   ：指定主节点信息 </p>\n</li>\n<li><p>mymaster  ：主节点名称，自定义，任意写</p>\n</li>\n<li><p>192.168.150.101 7001  ：主节点的ip和端口</p>\n</li>\n<li><p>2  ：选举master时的quorum值</p>\n</li>\n</ul>\n<p>然后将s1&#x2F;sentinel.conf文件拷贝到s2、s3两个目录中（在&#x2F;tmp目录执行下列命令）：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 方式一：逐个拷贝</span><br><span class=\"line\">cp s1/sentinel.conf s2</span><br><span class=\"line\">cp s1/sentinel.conf s3</span><br><span class=\"line\"># 方式二：管道组合命令，一键拷贝</span><br><span class=\"line\">echo s2 s3 | xargs -t -n <span class=\"number\">1</span> cp s1/sentinel.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改s2、s3两个文件夹内的配置文件，将端口分别修改为27002、27003：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sed -i -e <span class=\"string\">&#x27;s/27001/27002/g&#x27;</span> -e <span class=\"string\">&#x27;s/s1/s2/g&#x27;</span> s2/sentinel.conf</span><br><span class=\"line\">sed -i -e <span class=\"string\">&#x27;s/27001/27003/g&#x27;</span> -e <span class=\"string\">&#x27;s/s1/s3/g&#x27;</span> s3/sentinel.conf</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-3、启动\"><a href=\"#2-3、启动\" class=\"headerlink\" title=\"2.3、启动\"></a>2.3、启动</h3><p>为了方便查看日志，我们打开3个ssh窗口，分别启动3个redis实例，启动命令：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 第<span class=\"number\">1</span>个</span><br><span class=\"line\">redis-sentinel s1/sentinel.conf</span><br><span class=\"line\">./redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src/redis-sentinel ./s1/sentinel.conf</span><br><span class=\"line\"># 第<span class=\"number\">2</span>个</span><br><span class=\"line\">redis-sentinel s2/sentinel.conf</span><br><span class=\"line\">./redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src/redis-sentinel ./s2/sentinel.conf</span><br><span class=\"line\"># 第<span class=\"number\">3</span>个</span><br><span class=\"line\">redis-sentinel s3/sentinel.conf</span><br><span class=\"line\">./redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src/redis-sentinel ./s3/sentinel.conf</span><br></pre></td></tr></table></figure>\n\n<p>启动后：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-39-20.jpg\"></p>\n<h3 id=\"2-3、测试\"><a href=\"#2-3、测试\" class=\"headerlink\" title=\"2.3、测试\"></a>2.3、测试</h3><p>尝试让master节点7001宕机，查看sentinel日志：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-42-35.jpg\"></p>\n<p>查看7003的日志：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-20.jpg\"></p>\n<p>查看7002的日志：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-43-38.jpg\"></p>\n<h2 id=\"3、搭建分片集群\"><a href=\"#3、搭建分片集群\" class=\"headerlink\" title=\"3、搭建分片集群\"></a>3、搭建分片集群</h2><h3 id=\"3-1、集群结构\"><a href=\"#3-1、集群结构\" class=\"headerlink\" title=\"3.1、集群结构\"></a>3.1、<strong>集群结构</strong></h3><p>分片集群需要的节点数量较多，这里我们搭建一个最小的分片集群，包含3个master节点，每个master包含一个slave节点，结构如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-45-49.jpg\"></p>\n<p>这里我们会在同一台虚拟机中开启6个redis实例，模拟分片集群，信息如下：</p>\n<table>\n<thead>\n<tr>\n<th>IP</th>\n<th>PORT</th>\n<th>角色</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>192.168.150.101</td>\n<td>7001</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7002</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>7003</td>\n<td>master</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>8001</td>\n<td>slave</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>8002</td>\n<td>slave</td>\n</tr>\n<tr>\n<td>192.168.150.101</td>\n<td>8003</td>\n<td>slave</td>\n</tr>\n</tbody></table>\n<h3 id=\"3-2、准备实例和配置\"><a href=\"#3-2、准备实例和配置\" class=\"headerlink\" title=\"3.2、准备实例和配置\"></a>3.2、<strong>准备实例和配置</strong></h3><p>删除之前的7001、7002、7003这几个目录，重新创建出7001、7002、7003、8001、8002、8003目录：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 删除旧的，避免配置干扰</span><br><span class=\"line\">rm -rf <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span></span><br><span class=\"line\"># 创建目录</span><br><span class=\"line\">mkdir <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span></span><br></pre></td></tr></table></figure>\n\n<p>在&#x2F;tmp下准备一个新的redis.conf文件，内容如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">port <span class=\"number\">6379</span></span><br><span class=\"line\"># 开启集群功能</span><br><span class=\"line\">cluster-enabled yes</span><br><span class=\"line\"># 集群的配置文件名称，不需要我们创建，由redis自己维护</span><br><span class=\"line\">cluster-config-file /tmp/<span class=\"number\">6379</span>/nodes.conf</span><br><span class=\"line\"># 节点心跳失败的超时时间</span><br><span class=\"line\">cluster-node-timeout <span class=\"number\">5000</span></span><br><span class=\"line\"># 持久化文件存放目录</span><br><span class=\"line\">dir /tmp/<span class=\"number\">6379</span></span><br><span class=\"line\"># 绑定地址</span><br><span class=\"line\">bind <span class=\"number\">0.0</span><span class=\"number\">.0</span><span class=\"number\">.0</span></span><br><span class=\"line\"># 让redis后台运行,守护进程</span><br><span class=\"line\">daemonize yes</span><br><span class=\"line\"># 注册的实例ip</span><br><span class=\"line\">replica-announce-ip <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span></span><br><span class=\"line\"># 保护模式</span><br><span class=\"line\"><span class=\"keyword\">protected</span>-mode no</span><br><span class=\"line\"># 数据库数量</span><br><span class=\"line\">databases <span class=\"number\">1</span></span><br><span class=\"line\"># 日志</span><br><span class=\"line\">logfile /tmp/<span class=\"number\">6379</span>/run.log</span><br></pre></td></tr></table></figure>\n\n<p>将这个文件拷贝到每个目录下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 执行拷贝</span><br><span class=\"line\">echo <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -t -n <span class=\"number\">1</span> cp redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改每个目录下的redis.conf，将其中的6379修改为与所在目录一致：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 修改配置文件</span><br><span class=\"line\">printf <span class=\"string\">&#x27;%s\\n&#x27;</span> <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -I&#123;&#125; -t sed -i <span class=\"string\">&#x27;s/6379/&#123;&#125;/g&#x27;</span> &#123;&#125;/redis.conf</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-3、启动\"><a href=\"#3-3、启动\" class=\"headerlink\" title=\"3.3、启动\"></a>3.3、<strong>启动</strong></h3><p>因为已经配置了后台启动模式，所以可以直接启动服务：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入/tmp目录</span><br><span class=\"line\">cd /tmp</span><br><span class=\"line\"># 一键启动所有服务</span><br><span class=\"line\">printf <span class=\"string\">&#x27;%s\\n&#x27;</span> <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -I&#123;&#125; -t redis-server &#123;&#125;/redis.conf</span><br></pre></td></tr></table></figure>\n\n<p>通过ps查看状态：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep redis</span><br></pre></td></tr></table></figure>\n\n<p>发现服务都已经正常启动：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-48-58.jpg\"></p>\n<p>如果要关闭所有进程，可以执行命令：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep redis | awk <span class=\"string\">&#x27;&#123;print $2&#125;&#x27;</span> | xargs kill</span><br></pre></td></tr></table></figure>\n\n<p>或者（推荐这种方式）：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">printf <span class=\"string\">&#x27;%s\\n&#x27;</span> <span class=\"number\">7001</span> <span class=\"number\">7002</span> <span class=\"number\">7003</span> <span class=\"number\">8001</span> <span class=\"number\">8002</span> <span class=\"number\">8003</span> | xargs -I&#123;&#125; -t redis-cli -p &#123;&#125; shutdown</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-4、创建集群\"><a href=\"#3-4、创建集群\" class=\"headerlink\" title=\"3.4、创建集群\"></a>3.4、<strong>创建集群</strong></h3><p>虽然服务启动了，但是目前每个服务之间都是独立的，没有任何关联。</p>\n<p>我们需要执行命令来创建集群，在Redis5.0之前创建集群比较麻烦，5.0之后集群管理命令都集成到了redis-cli中。</p>\n<p>1）Redis5.0之前</p>\n<p>Redis5.0之前集群命令都是用redis安装包下的src&#x2F;redis-trib.rb来实现的。因为redis-trib.rb是有ruby语言编写的所以需要安装ruby环境。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 安装依赖</span><br><span class=\"line\">yum -y install zlib ruby rubygems</span><br><span class=\"line\">gem install redis</span><br></pre></td></tr></table></figure>\n\n<p>然后通过命令来管理集群：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入redis的src目录</span><br><span class=\"line\">cd /tmp/redis-<span class=\"number\">6.2</span><span class=\"number\">.4</span>/src</span><br><span class=\"line\"># 创建集群</span><br><span class=\"line\">./redis-trib.rb create --replicas <span class=\"number\">1</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7003</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8003</span></span><br></pre></td></tr></table></figure>\n\n<p>2）Redis5.0以后</p>\n<p>我们使用的是Redis6.2.4版本，集群管理以及集成到了redis-cli中，格式如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli --cluster create --cluster-replicas <span class=\"number\">1</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">7003</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8001</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8002</span> <span class=\"number\">192.168</span><span class=\"number\">.150</span><span class=\"number\">.101</span>:<span class=\"number\">8003</span></span><br></pre></td></tr></table></figure>\n\n<p>命令说明：</p>\n<ul>\n<li>redis-cli –cluster</li>\n</ul>\n<p>或者</p>\n<p>.&#x2F;redis-trib.rb：代表集群操作命令</p>\n<ul>\n<li>create</li>\n</ul>\n<p>：代表是创建集群</p>\n<ul>\n<li>–replicas 1</li>\n</ul>\n<p>或者</p>\n<p>–cluster-replicas 1 ：指定集群中每个master的副本个数为1，此时</p>\n<p>节点总数 ÷ (replicas + 1) 得到的就是master的数量。因此节点列表中的前n个就是master，其它节点都是slave节点，随机分配到不同master</p>\n<p>运行后的样子：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-42.jpg\"></p>\n<p>这里输入yes，则集群开始创建：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-51-53.jpg\"></p>\n<p>通过命令可以查看集群状态：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli -p <span class=\"number\">7001</span> cluster nodes</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-52-08.jpg\"></p>\n<h3 id=\"3-5、测试\"><a href=\"#3-5、测试\" class=\"headerlink\" title=\"3.5、测试\"></a>3.5、测试</h3><p>尝试连接7001节点，存储一个数据：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 连接</span><br><span class=\"line\">redis-cli -p <span class=\"number\">7001</span></span><br><span class=\"line\"># 存储数据</span><br><span class=\"line\">set num <span class=\"number\">123</span></span><br><span class=\"line\"># 读取数据</span><br><span class=\"line\">get num</span><br><span class=\"line\"># 再次存储</span><br><span class=\"line\">set a <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n<p>结果悲剧了：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-06.jpg\"></p>\n<p>集群操作时，需要给redis-cli加上-c参数才可以：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-cli -c -p <span class=\"number\">7001</span></span><br></pre></td></tr></table></figure>\n\n<p>这次可以了：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_19-56-23.jpg\"></p>\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_14-40-01.jpg","popularPost_tmp_gaData":{"updated":"Thu Mar 20 2025 19:59:22 GMT+0800 (中国标准时间)","title":"Redis集群搭建","path":"2025/03/20/Redis集群搭建/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-20_14-40-01.jpg","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2025-03-20T06:36:00.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2025-03-20T06:36:00.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"Linux","tags":["redis"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"Hello World","date":"2023-10-24T10:48:45.000Z","_content":"# Hello World: 第一步，从这里开始\n\n​\t大家好，我是ZC，一名热衷于探索技术世界的程序员。今天，我怀着激动的心情写下我的第一篇博客。为什么选择“Hello World”作为开篇呢？这不仅仅是因为它几乎是每个程序员学习编程语言时的第一个程序，更因为它象征着我们与计算机世界的初次对话——简单、纯粹且充满无限可能。\n\n## 编程之路的起点\n\n​\t回想起自己第一次在屏幕上敲出“Hello World”的那一刻，那种成就感至今仍然记忆犹新。那时的我对编程充满了好奇与敬畏，不知道接下来的学习之旅将会遇到什么样的挑战。随着时间的推移，我逐渐意识到，每一次代码的编写都是一次创造的过程，而每一个BUG的解决则像是一次小小的胜利。在这个过程中，我学会了如何用逻辑思考问题，如何将复杂的任务分解成可管理的部分，更重要的是，我学会了坚持不懈。\n\n## 技术分享的意义\n\n​\t创建这个博客的目的，不仅仅是记录下我个人的技术成长历程，更是希望能够成为一个交流的平台。在这里，无论是初学者还是经验丰富的开发者，都可以找到有价值的信息，相互启发，共同进步。我相信，通过分享我们的知识、经验和见解，可以激发更多人的创造力，推动整个社区向前发展。\n\n## 未来的展望\n\n​\t展望未来，我希望能够在这个博客上分享更多关于编程技巧、项目开发经验以及对最新技术趋势的思考。同时，我也期待着能够听到读者们的声音，无论是建议、批评还是鼓励，都是我不断前进的动力。让我们一起在这个数字世界中探索未知，创造价值。\n\n​\t最后，再次感谢您花时间阅读我的第一篇博客。如果您对编程有任何疑问或兴趣，欢迎随时留言交流。希望我们都能在技术的道路上越走越远，直到有一天，我们可以自豪地说：“Look what we've built!”","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2023-10-24 18:48:45\ntags:\n- Hello World\ncategories:\n- Hello World\n---\n# Hello World: 第一步，从这里开始\n\n​\t大家好，我是ZC，一名热衷于探索技术世界的程序员。今天，我怀着激动的心情写下我的第一篇博客。为什么选择“Hello World”作为开篇呢？这不仅仅是因为它几乎是每个程序员学习编程语言时的第一个程序，更因为它象征着我们与计算机世界的初次对话——简单、纯粹且充满无限可能。\n\n## 编程之路的起点\n\n​\t回想起自己第一次在屏幕上敲出“Hello World”的那一刻，那种成就感至今仍然记忆犹新。那时的我对编程充满了好奇与敬畏，不知道接下来的学习之旅将会遇到什么样的挑战。随着时间的推移，我逐渐意识到，每一次代码的编写都是一次创造的过程，而每一个BUG的解决则像是一次小小的胜利。在这个过程中，我学会了如何用逻辑思考问题，如何将复杂的任务分解成可管理的部分，更重要的是，我学会了坚持不懈。\n\n## 技术分享的意义\n\n​\t创建这个博客的目的，不仅仅是记录下我个人的技术成长历程，更是希望能够成为一个交流的平台。在这里，无论是初学者还是经验丰富的开发者，都可以找到有价值的信息，相互启发，共同进步。我相信，通过分享我们的知识、经验和见解，可以激发更多人的创造力，推动整个社区向前发展。\n\n## 未来的展望\n\n​\t展望未来，我希望能够在这个博客上分享更多关于编程技巧、项目开发经验以及对最新技术趋势的思考。同时，我也期待着能够听到读者们的声音，无论是建议、批评还是鼓励，都是我不断前进的动力。让我们一起在这个数字世界中探索未知，创造价值。\n\n​\t最后，再次感谢您花时间阅读我的第一篇博客。如果您对编程有任何疑问或兴趣，欢迎随时留言交流。希望我们都能在技术的道路上越走越远，直到有一天，我们可以自豪地说：“Look what we've built!”","slug":"hello-world","published":1,"updated":"2025-03-20T07:14:37.563Z","comments":1,"layout":"post","photos":[],"_id":"cmck4zyrg0009t0am58zccmnq","content":"<h1 id=\"Hello-World-第一步，从这里开始\"><a href=\"#Hello-World-第一步，从这里开始\" class=\"headerlink\" title=\"Hello World: 第一步，从这里开始\"></a>Hello World: 第一步，从这里开始</h1><p>​\t大家好，我是ZC，一名热衷于探索技术世界的程序员。今天，我怀着激动的心情写下我的第一篇博客。为什么选择“Hello World”作为开篇呢？这不仅仅是因为它几乎是每个程序员学习编程语言时的第一个程序，更因为它象征着我们与计算机世界的初次对话——简单、纯粹且充满无限可能。</p>\n<h2 id=\"编程之路的起点\"><a href=\"#编程之路的起点\" class=\"headerlink\" title=\"编程之路的起点\"></a>编程之路的起点</h2><p>​\t回想起自己第一次在屏幕上敲出“Hello World”的那一刻，那种成就感至今仍然记忆犹新。那时的我对编程充满了好奇与敬畏，不知道接下来的学习之旅将会遇到什么样的挑战。随着时间的推移，我逐渐意识到，每一次代码的编写都是一次创造的过程，而每一个BUG的解决则像是一次小小的胜利。在这个过程中，我学会了如何用逻辑思考问题，如何将复杂的任务分解成可管理的部分，更重要的是，我学会了坚持不懈。</p>\n<h2 id=\"技术分享的意义\"><a href=\"#技术分享的意义\" class=\"headerlink\" title=\"技术分享的意义\"></a>技术分享的意义</h2><p>​\t创建这个博客的目的，不仅仅是记录下我个人的技术成长历程，更是希望能够成为一个交流的平台。在这里，无论是初学者还是经验丰富的开发者，都可以找到有价值的信息，相互启发，共同进步。我相信，通过分享我们的知识、经验和见解，可以激发更多人的创造力，推动整个社区向前发展。</p>\n<h2 id=\"未来的展望\"><a href=\"#未来的展望\" class=\"headerlink\" title=\"未来的展望\"></a>未来的展望</h2><p>​\t展望未来，我希望能够在这个博客上分享更多关于编程技巧、项目开发经验以及对最新技术趋势的思考。同时，我也期待着能够听到读者们的声音，无论是建议、批评还是鼓励，都是我不断前进的动力。让我们一起在这个数字世界中探索未知，创造价值。</p>\n<p>​\t最后，再次感谢您花时间阅读我的第一篇博客。如果您对编程有任何疑问或兴趣，欢迎随时留言交流。希望我们都能在技术的道路上越走越远，直到有一天，我们可以自豪地说：“Look what we’ve built!”</p>\n","excerpt":"","more":"<h1 id=\"Hello-World-第一步，从这里开始\"><a href=\"#Hello-World-第一步，从这里开始\" class=\"headerlink\" title=\"Hello World: 第一步，从这里开始\"></a>Hello World: 第一步，从这里开始</h1><p>​\t大家好，我是ZC，一名热衷于探索技术世界的程序员。今天，我怀着激动的心情写下我的第一篇博客。为什么选择“Hello World”作为开篇呢？这不仅仅是因为它几乎是每个程序员学习编程语言时的第一个程序，更因为它象征着我们与计算机世界的初次对话——简单、纯粹且充满无限可能。</p>\n<h2 id=\"编程之路的起点\"><a href=\"#编程之路的起点\" class=\"headerlink\" title=\"编程之路的起点\"></a>编程之路的起点</h2><p>​\t回想起自己第一次在屏幕上敲出“Hello World”的那一刻，那种成就感至今仍然记忆犹新。那时的我对编程充满了好奇与敬畏，不知道接下来的学习之旅将会遇到什么样的挑战。随着时间的推移，我逐渐意识到，每一次代码的编写都是一次创造的过程，而每一个BUG的解决则像是一次小小的胜利。在这个过程中，我学会了如何用逻辑思考问题，如何将复杂的任务分解成可管理的部分，更重要的是，我学会了坚持不懈。</p>\n<h2 id=\"技术分享的意义\"><a href=\"#技术分享的意义\" class=\"headerlink\" title=\"技术分享的意义\"></a>技术分享的意义</h2><p>​\t创建这个博客的目的，不仅仅是记录下我个人的技术成长历程，更是希望能够成为一个交流的平台。在这里，无论是初学者还是经验丰富的开发者，都可以找到有价值的信息，相互启发，共同进步。我相信，通过分享我们的知识、经验和见解，可以激发更多人的创造力，推动整个社区向前发展。</p>\n<h2 id=\"未来的展望\"><a href=\"#未来的展望\" class=\"headerlink\" title=\"未来的展望\"></a>未来的展望</h2><p>​\t展望未来，我希望能够在这个博客上分享更多关于编程技巧、项目开发经验以及对最新技术趋势的思考。同时，我也期待着能够听到读者们的声音，无论是建议、批评还是鼓励，都是我不断前进的动力。让我们一起在这个数字世界中探索未知，创造价值。</p>\n<p>​\t最后，再次感谢您花时间阅读我的第一篇博客。如果您对编程有任何疑问或兴趣，欢迎随时留言交流。希望我们都能在技术的道路上越走越远，直到有一天，我们可以自豪地说：“Look what we’ve built!”</p>\n","popularPost_tmp_postPath":true,"eyeCatchImage":null,"popularPost_tmp_gaData":{"updated":"Thu Mar 20 2025 15:14:37 GMT+0800 (中国标准时间)","title":"Hello World","path":"2023/10/24/hello-world/","eyeCatchImage":null,"excerpt":null,"date":{"_isAMomentObject":true,"_i":"2023-10-24T10:48:45.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2023-10-24T10:48:45.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"Hello World","tags":["Hello World"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"使用yum安装wget报错","date":"2024-01-13T08:42:09.000Z","_content":"\n# 使用yum安装wget报错\n\n使用yum安装报错：Could not retrieve mirrorlist http://mirrorlist.centos.org/?release=7&arch=x86_64&repo=os&\n\n安装wget命令\n\n```\nyum -y install wget\n```\n\n报错，无法找到镜像\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-58-42.jpg)\n\n测试是否是网络问题\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-59-35.jpg)\n\n抓包正常，网络没有问题；尝试更新[yum](https://so.csdn.net/so/search?q=yum&spm=1001.2101.3001.7020)\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-00-21.jpg)\n\n又开始报错\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-01-19.jpg)\n\n尝试分析问题原因\n出现这个错误是因为使用的 CentOS 7 仓库已经被归档，当前的镜像地址无法找到所需的文件。CentOS 7 的官方支持已经结束，部分仓库已被移至归档库。这导致了你的 yum 命令无法找到所需的元数据文件。CentOS 7 的官方仓库在 2024 年 6 月 30 日之后已经停止维护。因此，使用最新的 CentOS 7 官方仓库可能会遇到问题。\n\n\n**尝试解决：**\n\n进入/etc/yum.repos.d目录下找到 CentOS-Base.rep\n\n执行下面操作\n\n```\ncp  CentOS-Base.repo   CentOS-Base.repo.backup\n```\n\n然后修改 CentOS-Base.repo 为\n\n    # CentOS-Base.repo\n        #\n        # The mirror system uses the connecting IP address of the client and the\n        # update status of each mirror to pick mirrors that are updated to and\n        # geographically close to the client.  You should use this for CentOS updates\n        # unless you are manually picking other mirrors.\n        #\n        # If the mirrorlist= does not work for you, as a fall back you can try the \n        # remarked out baseurl= line instead.\n        #\n        #\n         \n        [base]\n        name=CentOS-$releasever - Base\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra\n        #baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/os/$basearch/\n        gpgcheck=1\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n         \n        #released updates \n        [updates]\n        name=CentOS-$releasever - Updates\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates&infra=$infra\n        #baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/updates/$basearch/\n        gpgcheck=1\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n         \n        #additional packages that may be useful\n        [extras]\n        name=CentOS-$releasever - Extras\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras&infra=$infra\n        #$baseurl=http://mirror.centos.org/centos/$releasever/extras/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/extras/$basearch/\n        gpgcheck=1\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n         \n        #additional packages that extend functionality of existing packages\n        [centosplus]\n        name=CentOS-$releasever - Plus\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus&infra=$infra\n        #baseurl=http://mirror.centos.org/centos/$releasever/centosplus/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/centosplus/$basearch/\n        gpgcheck=1\n        enabled=0\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\nwq保存，再执行\n\n```\nsudo yum clean all\nsudo yum makecache\n```\n\n等待加载成功，然后继续执行\n\n```\ncurl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-28-41.jpg)\n\n然后执行\n\n```\ncat CentOS-Base.repo\n```\n\n发现镜像已改为了阿里云的\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-10.jpg)\n\n再此尝试导入wget命令 好的成功了\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-36.jpg)","source":"_posts/使用yum安装wget报错.md","raw":"---\ntitle: 使用yum安装wget报错\ndate: 2024-01-13 16:42:09\ntags:\n- yum\ncategories:\n- Linux\n---\n\n# 使用yum安装wget报错\n\n使用yum安装报错：Could not retrieve mirrorlist http://mirrorlist.centos.org/?release=7&arch=x86_64&repo=os&\n\n安装wget命令\n\n```\nyum -y install wget\n```\n\n报错，无法找到镜像\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-58-42.jpg)\n\n测试是否是网络问题\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-59-35.jpg)\n\n抓包正常，网络没有问题；尝试更新[yum](https://so.csdn.net/so/search?q=yum&spm=1001.2101.3001.7020)\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-00-21.jpg)\n\n又开始报错\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-01-19.jpg)\n\n尝试分析问题原因\n出现这个错误是因为使用的 CentOS 7 仓库已经被归档，当前的镜像地址无法找到所需的文件。CentOS 7 的官方支持已经结束，部分仓库已被移至归档库。这导致了你的 yum 命令无法找到所需的元数据文件。CentOS 7 的官方仓库在 2024 年 6 月 30 日之后已经停止维护。因此，使用最新的 CentOS 7 官方仓库可能会遇到问题。\n\n\n**尝试解决：**\n\n进入/etc/yum.repos.d目录下找到 CentOS-Base.rep\n\n执行下面操作\n\n```\ncp  CentOS-Base.repo   CentOS-Base.repo.backup\n```\n\n然后修改 CentOS-Base.repo 为\n\n    # CentOS-Base.repo\n        #\n        # The mirror system uses the connecting IP address of the client and the\n        # update status of each mirror to pick mirrors that are updated to and\n        # geographically close to the client.  You should use this for CentOS updates\n        # unless you are manually picking other mirrors.\n        #\n        # If the mirrorlist= does not work for you, as a fall back you can try the \n        # remarked out baseurl= line instead.\n        #\n        #\n         \n        [base]\n        name=CentOS-$releasever - Base\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra\n        #baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/os/$basearch/\n        gpgcheck=1\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n         \n        #released updates \n        [updates]\n        name=CentOS-$releasever - Updates\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates&infra=$infra\n        #baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/updates/$basearch/\n        gpgcheck=1\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n         \n        #additional packages that may be useful\n        [extras]\n        name=CentOS-$releasever - Extras\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras&infra=$infra\n        #$baseurl=http://mirror.centos.org/centos/$releasever/extras/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/extras/$basearch/\n        gpgcheck=1\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n         \n        #additional packages that extend functionality of existing packages\n        [centosplus]\n        name=CentOS-$releasever - Plus\n        #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus&infra=$infra\n        #baseurl=http://mirror.centos.org/centos/$releasever/centosplus/$basearch/\n        #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n        baseurl=http://vault.centos.org/7.9.2009/centosplus/$basearch/\n        gpgcheck=1\n        enabled=0\n        gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\nwq保存，再执行\n\n```\nsudo yum clean all\nsudo yum makecache\n```\n\n等待加载成功，然后继续执行\n\n```\ncurl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-28-41.jpg)\n\n然后执行\n\n```\ncat CentOS-Base.repo\n```\n\n发现镜像已改为了阿里云的\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-10.jpg)\n\n再此尝试导入wget命令 好的成功了\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-36.jpg)","slug":"使用yum安装wget报错","published":1,"updated":"2025-03-20T07:15:24.315Z","comments":1,"layout":"post","photos":[],"_id":"cmck4zyrg000at0am2uh4esnk","content":"<h1 id=\"使用yum安装wget报错\"><a href=\"#使用yum安装wget报错\" class=\"headerlink\" title=\"使用yum安装wget报错\"></a>使用yum安装wget报错</h1><p>使用yum安装报错：Could not retrieve mirrorlist <a href=\"http://mirrorlist.centos.org/?release=7&arch=x86_64&repo=os&\">http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=os&amp;</a></p>\n<p>安装wget命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install wget</span><br></pre></td></tr></table></figure>\n\n<p>报错，无法找到镜像</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-58-42.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-58-42.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>测试是否是网络问题</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-59-35.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-59-35.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>抓包正常，网络没有问题；尝试更新<a href=\"https://so.csdn.net/so/search?q=yum&spm=1001.2101.3001.7020\">yum</a></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-00-21.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-00-21.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>又开始报错</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-01-19.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-01-19.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>尝试分析问题原因<br>出现这个错误是因为使用的 CentOS 7 仓库已经被归档，当前的镜像地址无法找到所需的文件。CentOS 7 的官方支持已经结束，部分仓库已被移至归档库。这导致了你的 yum 命令无法找到所需的元数据文件。CentOS 7 的官方仓库在 2024 年 6 月 30 日之后已经停止维护。因此，使用最新的 CentOS 7 官方仓库可能会遇到问题。</p>\n<p><strong>尝试解决：</strong></p>\n<p>进入&#x2F;etc&#x2F;yum.repos.d目录下找到 CentOS-Base.rep</p>\n<p>执行下面操作</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp  CentOS-Base.repo   CentOS-Base.repo.backup</span><br></pre></td></tr></table></figure>\n\n<p>然后修改 CentOS-Base.repo 为</p>\n<pre><code># CentOS-Base.repo\n    #\n    # The mirror system uses the connecting IP address of the client and the\n    # update status of each mirror to pick mirrors that are updated to and\n    # geographically close to the client.  You should use this for CentOS updates\n    # unless you are manually picking other mirrors.\n    #\n    # If the mirrorlist= does not work for you, as a fall back you can try the \n    # remarked out baseurl= line instead.\n    #\n    #\n     \n    [base]\n    name=CentOS-$releasever - Base\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os&amp;infra=$infra\n    #baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/os/$basearch/\n    gpgcheck=1\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n     \n    #released updates \n    [updates]\n    name=CentOS-$releasever - Updates\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates&amp;infra=$infra\n    #baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/updates/$basearch/\n    gpgcheck=1\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n     \n    #additional packages that may be useful\n    [extras]\n    name=CentOS-$releasever - Extras\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras&amp;infra=$infra\n    #$baseurl=http://mirror.centos.org/centos/$releasever/extras/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/extras/$basearch/\n    gpgcheck=1\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n     \n    #additional packages that extend functionality of existing packages\n    [centosplus]\n    name=CentOS-$releasever - Plus\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus&amp;infra=$infra\n    #baseurl=http://mirror.centos.org/centos/$releasever/centosplus/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/centosplus/$basearch/\n    gpgcheck=1\n    enabled=0\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n</code></pre>\n<p>wq保存，再执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum clean all</span><br><span class=\"line\">sudo yum makecache</span><br></pre></td></tr></table></figure>\n\n<p>等待加载成功，然后继续执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-28-41.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-28-41.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>然后执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat CentOS-Base.repo</span><br></pre></td></tr></table></figure>\n\n<p>发现镜像已改为了阿里云的</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-10.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-10.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>再此尝试导入wget命令 好的成功了</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-36.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-36.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n","excerpt":"","more":"<h1 id=\"使用yum安装wget报错\"><a href=\"#使用yum安装wget报错\" class=\"headerlink\" title=\"使用yum安装wget报错\"></a>使用yum安装wget报错</h1><p>使用yum安装报错：Could not retrieve mirrorlist <a href=\"http://mirrorlist.centos.org/?release=7&arch=x86_64&repo=os&\">http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=os&amp;</a></p>\n<p>安装wget命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install wget</span><br></pre></td></tr></table></figure>\n\n<p>报错，无法找到镜像</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-58-42.jpg\"></p>\n<p>测试是否是网络问题</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-59-35.jpg\"></p>\n<p>抓包正常，网络没有问题；尝试更新<a href=\"https://so.csdn.net/so/search?q=yum&spm=1001.2101.3001.7020\">yum</a></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-00-21.jpg\"></p>\n<p>又开始报错</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-01-19.jpg\"></p>\n<p>尝试分析问题原因<br>出现这个错误是因为使用的 CentOS 7 仓库已经被归档，当前的镜像地址无法找到所需的文件。CentOS 7 的官方支持已经结束，部分仓库已被移至归档库。这导致了你的 yum 命令无法找到所需的元数据文件。CentOS 7 的官方仓库在 2024 年 6 月 30 日之后已经停止维护。因此，使用最新的 CentOS 7 官方仓库可能会遇到问题。</p>\n<p><strong>尝试解决：</strong></p>\n<p>进入&#x2F;etc&#x2F;yum.repos.d目录下找到 CentOS-Base.rep</p>\n<p>执行下面操作</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp  CentOS-Base.repo   CentOS-Base.repo.backup</span><br></pre></td></tr></table></figure>\n\n<p>然后修改 CentOS-Base.repo 为</p>\n<pre><code># CentOS-Base.repo\n    #\n    # The mirror system uses the connecting IP address of the client and the\n    # update status of each mirror to pick mirrors that are updated to and\n    # geographically close to the client.  You should use this for CentOS updates\n    # unless you are manually picking other mirrors.\n    #\n    # If the mirrorlist= does not work for you, as a fall back you can try the \n    # remarked out baseurl= line instead.\n    #\n    #\n     \n    [base]\n    name=CentOS-$releasever - Base\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os&amp;infra=$infra\n    #baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/os/$basearch/\n    gpgcheck=1\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n     \n    #released updates \n    [updates]\n    name=CentOS-$releasever - Updates\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates&amp;infra=$infra\n    #baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/updates/$basearch/\n    gpgcheck=1\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n     \n    #additional packages that may be useful\n    [extras]\n    name=CentOS-$releasever - Extras\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras&amp;infra=$infra\n    #$baseurl=http://mirror.centos.org/centos/$releasever/extras/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/extras/$basearch/\n    gpgcheck=1\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n     \n    #additional packages that extend functionality of existing packages\n    [centosplus]\n    name=CentOS-$releasever - Plus\n    #mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus&amp;infra=$infra\n    #baseurl=http://mirror.centos.org/centos/$releasever/centosplus/$basearch/\n    #baseurl=http://vault.centos.org/7.9.2009/x86_64/os/\n    baseurl=http://vault.centos.org/7.9.2009/centosplus/$basearch/\n    gpgcheck=1\n    enabled=0\n    gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7\n</code></pre>\n<p>wq保存，再执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum clean all</span><br><span class=\"line\">sudo yum makecache</span><br></pre></td></tr></table></figure>\n\n<p>等待加载成功，然后继续执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-28-41.jpg\"></p>\n<p>然后执行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat CentOS-Base.repo</span><br></pre></td></tr></table></figure>\n\n<p>发现镜像已改为了阿里云的</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-10.jpg\"></p>\n<p>再此尝试导入wget命令 好的成功了</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_18-29-36.jpg\"></p>\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-58-42.jpg","popularPost_tmp_gaData":{"updated":"Thu Mar 20 2025 15:15:24 GMT+0800 (中国标准时间)","title":"使用yum安装wget报错","path":"2024/01/13/使用yum安装wget报错/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-03-18_17-58-42.jpg","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2024-01-13T08:42:09.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2024-01-13T08:42:09.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"Linux","tags":["yum"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"yuque-dl","date":"2024-05-21T06:59:27.000Z","_content":"\n# **语雀文档下载到本地**\n\n1.下载nodejs 点此直接下载Node.js v22.13.1 去官网查看：\n\n```\nhttps://nodejs.org/zh-cn \n```\n\n2.win+r打开运行，输入cmd打开命令提示符 \n\n3.更换镜像源 \n\n```\nnpm config get registry   \nnpm config set registry https://registry.npmmirror.com\n```\n\n4.安装插件 \n\n```\nnpm i -g yuque-dl \n```\n\n 5.查看是否下载完成 \n\n```\nyuque-dl --help  \n```\n\n6.下载文档 yuque-dl  示例： \n\n```\nyuque-dl \"https://www.yuque.com/yuque/thyzgp\" \n```\n\n================================= 修改默认路径 在cmd里输入以下命令 mklink/J \"C:\\Users\\你的用户名\\download\" \"目标位置\"  例如：\n\n```\nmklink/J \"C:\\Users\\hp\\download\" \"D:\\download\" \n```\n\n当显示：为xxx<<===>>xxx创建的连接即可 然后正常下载\n\n7、出现下面图片中报错的情况的，按下面的方法解决\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-49-33.jpg)\n\n### 私有知识库\n\n通过别人私有知识库 分享的链接，需使用`-t`添加token才能下载\n\n```\nyuque-dl \"https://www.yuque.com/yuque/thyzgp\" -t \"abcd...\"\n```\n\n### 公开密码访问的知识库\n\n⚠️ 公开密码访问的知识库两种情况:\n\n- 已经登录语雀，访问需要密码的知识库 输入密码后使用`_yuque_session`这个cookie\n\n  ```\n  yuque-dl \"url\" -t \"_yuque_session的值\"\n  ```\n\n- 未登录语雀，访问需要密码的知识库 输入密码后需要使用`verified_books`/`verified_docs`这个cookie\n\n  ```\n  yuque-dl \"url\" -k \"verified_books\" -t \"verified_books的值\"\n  ```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-54-24.jpg)\n\n## 内置启动web服务可快速预览\n\n使用[`vitepress`](https://gitee.com/link?target=https%3A%2F%2Fvitepress.dev%2F)快速启动一个web服务提供可预览下载的内容\t\n\n```\nyuque-dl server ./download/知识库/\n\n➜  Local:   http://localhost:5173/\n➜  Network: use --host to expose\n```\n\n","source":"_posts/yuque-dl.md","raw":"---\ntitle: yuque-dl\ndate: 2024-05-21 14:59:27\ntags:\n- 语雀\ncategories:\n- cmd\n---\n\n# **语雀文档下载到本地**\n\n1.下载nodejs 点此直接下载Node.js v22.13.1 去官网查看：\n\n```\nhttps://nodejs.org/zh-cn \n```\n\n2.win+r打开运行，输入cmd打开命令提示符 \n\n3.更换镜像源 \n\n```\nnpm config get registry   \nnpm config set registry https://registry.npmmirror.com\n```\n\n4.安装插件 \n\n```\nnpm i -g yuque-dl \n```\n\n 5.查看是否下载完成 \n\n```\nyuque-dl --help  \n```\n\n6.下载文档 yuque-dl  示例： \n\n```\nyuque-dl \"https://www.yuque.com/yuque/thyzgp\" \n```\n\n================================= 修改默认路径 在cmd里输入以下命令 mklink/J \"C:\\Users\\你的用户名\\download\" \"目标位置\"  例如：\n\n```\nmklink/J \"C:\\Users\\hp\\download\" \"D:\\download\" \n```\n\n当显示：为xxx<<===>>xxx创建的连接即可 然后正常下载\n\n7、出现下面图片中报错的情况的，按下面的方法解决\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-49-33.jpg)\n\n### 私有知识库\n\n通过别人私有知识库 分享的链接，需使用`-t`添加token才能下载\n\n```\nyuque-dl \"https://www.yuque.com/yuque/thyzgp\" -t \"abcd...\"\n```\n\n### 公开密码访问的知识库\n\n⚠️ 公开密码访问的知识库两种情况:\n\n- 已经登录语雀，访问需要密码的知识库 输入密码后使用`_yuque_session`这个cookie\n\n  ```\n  yuque-dl \"url\" -t \"_yuque_session的值\"\n  ```\n\n- 未登录语雀，访问需要密码的知识库 输入密码后需要使用`verified_books`/`verified_docs`这个cookie\n\n  ```\n  yuque-dl \"url\" -k \"verified_books\" -t \"verified_books的值\"\n  ```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-54-24.jpg)\n\n## 内置启动web服务可快速预览\n\n使用[`vitepress`](https://gitee.com/link?target=https%3A%2F%2Fvitepress.dev%2F)快速启动一个web服务提供可预览下载的内容\t\n\n```\nyuque-dl server ./download/知识库/\n\n➜  Local:   http://localhost:5173/\n➜  Network: use --host to expose\n```\n\n","slug":"yuque-dl","published":1,"updated":"2025-11-05T02:14:42.006Z","_id":"cmck4zyrh000et0amfm3jdcuv","comments":1,"layout":"post","photos":[],"content":"<h1 id=\"语雀文档下载到本地\"><a href=\"#语雀文档下载到本地\" class=\"headerlink\" title=\"语雀文档下载到本地\"></a><strong>语雀文档下载到本地</strong></h1><p>1.下载nodejs 点此直接下载Node.js v22.13.1 去官网查看：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://nodejs.org/zh-cn </span><br></pre></td></tr></table></figure>\n\n<p>2.win+r打开运行，输入cmd打开命令提示符 </p>\n<p>3.更换镜像源 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config get registry   </span><br><span class=\"line\">npm config set registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure>\n\n<p>4.安装插件 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -g yuque-dl </span><br></pre></td></tr></table></figure>\n\n<p> 5.查看是否下载完成 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl --help  </span><br></pre></td></tr></table></figure>\n\n<p>6.下载文档 yuque-dl  示例： </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;https://www.yuque.com/yuque/thyzgp&quot; </span><br></pre></td></tr></table></figure>\n\n<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 修改默认路径 在cmd里输入以下命令 mklink&#x2F;J “C:\\Users\\你的用户名\\download” “目标位置”  例如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mklink/J &quot;C:\\Users\\hp\\download&quot; &quot;D:\\download&quot; </span><br></pre></td></tr></table></figure>\n\n<p>当显示：为xxx&lt;&lt;&#x3D;&#x3D;&#x3D;&gt;&gt;xxx创建的连接即可 然后正常下载</p>\n<p>7、出现下面图片中报错的情况的，按下面的方法解决<br><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-49-33.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-49-33.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h3 id=\"私有知识库\"><a href=\"#私有知识库\" class=\"headerlink\" title=\"私有知识库\"></a>私有知识库</h3><p>通过别人私有知识库 分享的链接，需使用<code>-t</code>添加token才能下载</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;https://www.yuque.com/yuque/thyzgp&quot; -t &quot;abcd...&quot;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"公开密码访问的知识库\"><a href=\"#公开密码访问的知识库\" class=\"headerlink\" title=\"公开密码访问的知识库\"></a>公开密码访问的知识库</h3><p>⚠️ 公开密码访问的知识库两种情况:</p>\n<ul>\n<li><p>已经登录语雀，访问需要密码的知识库 输入密码后使用<code>_yuque_session</code>这个cookie</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;url&quot; -t &quot;_yuque_session的值&quot;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>未登录语雀，访问需要密码的知识库 输入密码后需要使用<code>verified_books</code>&#x2F;<code>verified_docs</code>这个cookie</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;url&quot; -k &quot;verified_books&quot; -t &quot;verified_books的值&quot;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-54-24.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-54-24.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h2 id=\"内置启动web服务可快速预览\"><a href=\"#内置启动web服务可快速预览\" class=\"headerlink\" title=\"内置启动web服务可快速预览\"></a>内置启动web服务可快速预览</h2><p>使用<a href=\"https://gitee.com/link?target=https://vitepress.dev/\"><code>vitepress</code></a>快速启动一个web服务提供可预览下载的内容\t</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl server ./download/知识库/</span><br><span class=\"line\"></span><br><span class=\"line\">➜  Local:   http://localhost:5173/</span><br><span class=\"line\">➜  Network: use --host to expose</span><br></pre></td></tr></table></figure>\n\n","excerpt":"","more":"<h1 id=\"语雀文档下载到本地\"><a href=\"#语雀文档下载到本地\" class=\"headerlink\" title=\"语雀文档下载到本地\"></a><strong>语雀文档下载到本地</strong></h1><p>1.下载nodejs 点此直接下载Node.js v22.13.1 去官网查看：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://nodejs.org/zh-cn </span><br></pre></td></tr></table></figure>\n\n<p>2.win+r打开运行，输入cmd打开命令提示符 </p>\n<p>3.更换镜像源 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config get registry   </span><br><span class=\"line\">npm config set registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure>\n\n<p>4.安装插件 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i -g yuque-dl </span><br></pre></td></tr></table></figure>\n\n<p> 5.查看是否下载完成 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl --help  </span><br></pre></td></tr></table></figure>\n\n<p>6.下载文档 yuque-dl  示例： </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;https://www.yuque.com/yuque/thyzgp&quot; </span><br></pre></td></tr></table></figure>\n\n<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 修改默认路径 在cmd里输入以下命令 mklink&#x2F;J “C:\\Users\\你的用户名\\download” “目标位置”  例如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mklink/J &quot;C:\\Users\\hp\\download&quot; &quot;D:\\download&quot; </span><br></pre></td></tr></table></figure>\n\n<p>当显示：为xxx&lt;&lt;&#x3D;&#x3D;&#x3D;&gt;&gt;xxx创建的连接即可 然后正常下载</p>\n<p>7、出现下面图片中报错的情况的，按下面的方法解决<br><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-49-33.jpg\"></p>\n<h3 id=\"私有知识库\"><a href=\"#私有知识库\" class=\"headerlink\" title=\"私有知识库\"></a>私有知识库</h3><p>通过别人私有知识库 分享的链接，需使用<code>-t</code>添加token才能下载</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;https://www.yuque.com/yuque/thyzgp&quot; -t &quot;abcd...&quot;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"公开密码访问的知识库\"><a href=\"#公开密码访问的知识库\" class=\"headerlink\" title=\"公开密码访问的知识库\"></a>公开密码访问的知识库</h3><p>⚠️ 公开密码访问的知识库两种情况:</p>\n<ul>\n<li><p>已经登录语雀，访问需要密码的知识库 输入密码后使用<code>_yuque_session</code>这个cookie</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;url&quot; -t &quot;_yuque_session的值&quot;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>未登录语雀，访问需要密码的知识库 输入密码后需要使用<code>verified_books</code>&#x2F;<code>verified_docs</code>这个cookie</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl &quot;url&quot; -k &quot;verified_books&quot; -t &quot;verified_books的值&quot;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-54-24.jpg\"></p>\n<h2 id=\"内置启动web服务可快速预览\"><a href=\"#内置启动web服务可快速预览\" class=\"headerlink\" title=\"内置启动web服务可快速预览\"></a>内置启动web服务可快速预览</h2><p>使用<a href=\"https://gitee.com/link?target=https://vitepress.dev/\"><code>vitepress</code></a>快速启动一个web服务提供可预览下载的内容\t</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yuque-dl server ./download/知识库/</span><br><span class=\"line\"></span><br><span class=\"line\">➜  Local:   http://localhost:5173/</span><br><span class=\"line\">➜  Network: use --host to expose</span><br></pre></td></tr></table></figure>\n\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-49-33.jpg","popularPost_tmp_gaData":{"updated":"Wed Nov 05 2025 10:14:42 GMT+0800 (中国标准时间)","title":"yuque-dl","path":"2024/05/21/yuque-dl/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-05-21_14-49-33.jpg","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2024-05-21T06:59:27.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2024-05-21T06:59:27.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"cmd","tags":["语雀"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"hexo搭建博客","date":"2023-11-25T10:48:45.000Z","_content":"\n# **hexo搭建博客**\n\n## **第一部分**\n\n### **Hexo简介**\n\nHexo是一款基于Node.js的静态博客框架，依赖少易于安装使用，可以方便的生成静态网页托管在GitHub和Coding上，是搭建博客的首选框架。\n\n### **Hexo搭建步骤**\n\n1. 安装Git\n2. 安装Node.js\n3. 安装Hexo\n4. GitHub创建个人仓库\n5. 生成SSH添加到GitHub\n6. 将hexo部署到GitHub\n7. 设置个人域名\n8. 发布文章\n\n\n#### **1. 安装Git**\n\nGit是目前世界上最先进的分布式版本控制系统，可以有效、高速的处理从很小到非常大的项目版本管理。也就是用来管理你的hexo博客文章，上传到GitHub的工具。Git非常强大，我觉得建议每个人都去了解一下。\n\n`Windows`：到git官网上下载,[Download git](https://gitforwindows.org/),下载后会有一个Git Bash的命令行工具，以后就用这个工具来使用git。\n\n`Linux`：对linux来说实在是太简单了，因为最早的git就是在linux上编写的，只需要一行代码\n\n```\nsudo apt-get install git\n```\n\n安装好后，用`git --version` 来查看一下版本\n\n#### **2. 安装nodejs**\n\nHexo是基于nodeJS编写的，所以需要安装一下nodeJs和里面的npm工具。\n\nwindows：[nodejs](https://nodejs.org/en/download/)选择LTS版本就行了。\n\nlinux：\n\n```\nsudo apt-get install nodejs\nsudo apt-get install npm\n```\n\n安装完后，打开命令行\n\n```\nnode -v\nnpm -v\n```\n\n检查一下有没有安装成功\n\n顺便说一下，windows在git安装完后，就可以直接使用git bash来敲命令行了，不用自带的cmd，cmd有点难用。\n\n#### **3. 安装hexo**\n\n****前面git和nodejs安装好后，就可以安装hexo了，你可以先创建一个文件夹blog，然后`cd`到这个文件夹下（或者在这个文件夹下直接右键git bash打开）。\n\n输入命令\n\n```\nnpm install -g hexo-cli\n```\n\n依旧用`hexo -v`查看一下版本\n\n至此就全部安装完了。\n\n接下来初始化一下hexo\n\n```\nhexo init myblog\n```\n\n这个myblog可以自己取什么名字都行，然后\n\n```\ncd myblog //进入这个myblog文件夹\nnpm install\n```\n\n新建完成后，指定文件夹目录下有：\n\n- node_modules: 依赖包\n- public：存放生成的页面\n- scaffolds：生成文章的一些模板\n- source：用来存放你的文章\n- themes：主题\n- ** _config.yml: 博客的配置文件**\n\n```\nhexo g\nhexo server\n```\n\n打开hexo的服务，在浏览器输入localhost:4000就可以看到你生成的博客了。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-1.jpg)\n\n使用ctrl+c可以把服务关掉。\n\n#### **4. GitHub创建个人仓库**\n\n首先，你先要有一个GitHub账户，去注册一个吧。\n\n注册完登录后，在GitHub.com中看到一个New repository，新建仓库\n\n创建一个和你用户名相同的仓库，后面加.github.io，只有这样，将来要部署到GitHub page的时候，才会被识别，也就是xxxx.github.io，其中xxx就是你注册GitHub的用户名。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-22.jpg)\n\n点击create repository。\n\n#### **5. 生成SSH添加到GitHub**\n\n回到你的git bash中，\n\n```\ngit config --global user.name \"yourname\"\ngit config --global user.email \"youremail\"\n```\n\n这里的yourname输入你的GitHub用户名，youremail输入你GitHub的邮箱。这样GitHub才能知道你是不是对应它的账户。\n\n```\ngit config user.name\ngit config user.email\n```\n\n然后创建SSH,一路回车\n\n```\nssh-keygen -t rsa -C \"youremail\"\n```\n\n这个时候它会告诉你已经生成了.ssh的文件夹。在你的电脑中找到这个文件夹。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-3.jpg)\n\nssh，简单来讲，就是一个秘钥，其中，`id_rsa`是你这台电脑的私人秘钥，不能给别人看的，`id_rsa.pub`是公共秘钥，可以随便给别人看。把这个公钥放在GitHub上，这样当你链接GitHub自己的账户时，它就会根据公钥匹配你的私钥，当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上\n\n而后在GitHub的setting中，找到SSH keys的设置选项，点击`New SSH key`\n把你的`id_rsa.pub`里面的信息复制进去。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-4jpg.jpg)\n\n在gitbash中，查看是否成功\n\n```\nssh -T git@github.com\n```\n\n#### **6. 将hexo部署到GitHub**\n\n这一步，我们就可以将hexo和GitHub关联起来，也就是将hexo生成的文章部署到GitHub上，打开站点配置文件 `_config.yml`，翻到最后，修改为\nYourgithubName就是你的GitHub账户\n\n```\ndeploy:\n  type: git\n  repo: https://github.com/YourgithubName/YourgithubName.github.io.git\n  branch: master\n```\n\n这个时候需要先安装deploy-git ，也就是部署的命令,这样你才能用命令部署到GitHub。\n\n```\nnpm install hexo-deployer-git --save\n```\n\n然后\n\n```\nhexo clean\nhexo generate\nhexo deploy\n```\n\n其中 `hexo clean`清除了你之前生成的东西，也可以不加。\n`hexo generate` 顾名思义，生成静态文章，可以用 `hexo g`缩写\n`hexo deploy` 部署文章，可以用`hexo d`缩写\n\n注意deploy时可能要你输入username和password。\n\n得到下图就说明部署成功了，过一会儿就可以在http://yourname.github.io 这个网站看到你的博客了！！\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-5.jpg)\n\n接下来你就可以正式开始写文章了。\n\n```\nhexo new newpapername\n```\n\n然后在source/_post中打开markdown文件，就可以开始编辑了。当你写完的时候，再\n\n```\nhexo clean\nhexo g\nhexo d\n```\n\n就可以看到更新了。\n\n\n\n## **第二部分**\n\nhexo的基本配置，更换主题，实现多终端工作，以及在coding page部署实现国内外分流。\n\n#### **1. hexo基本配置**\n\n在文件根目录下的`_config.yml`，就是整个hexo框架的配置文件了。可以在里面修改大部分的配置。详细可参考[官方的配置](https://hexo.io/zh-cn/docs/configuration)描述。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-11.jpg)\n其中，description主要用于SEO，告诉搜索引擎一个关于您站点的简单描述，通常建议在其中包含您网站的关键词。author参数用于主题显示文章的作者。\n**网址**\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-12.jpg)\n\n在这里，你需要把url改成你的网站域名。\n\npermalink，也就是你生成某个文章时的那个链接格式。\n\n比如我新建一个文章叫temp.md，那么这个时候他自动生成的地址就是http://yoursite.com/2018/09/05/temp。\n\n以下是官方给出的示例，关于链接的变量还有很多，需要的可以去官网上查找 [永久链接](https://hexo.io/zh-cn/docs/permalinks) 。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-13.jpg)\n\n再往下翻，中间这些都默认就好了。\n\n```\ntheme: landscape\n\n# Deployment\n## Docs: https://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo: <repository url>\n  branch: [branch]\n```\n\n`theme`就是选择什么主题，也就是在`theme`这个文件夹下，在官网上有很多个主题，默认给你安装的是`lanscape`这个主题。当你需要更换主题时，在官网上下载，把主题的文件放在`theme`文件夹下，再修改这个参数就可以了。\n\n接下来这个`deploy`就是网站的部署的，`repo`就是仓库(Repository)的简写。branch选择仓库的哪个分支。这个在之前进行github page部署的时候已经修改过了，不再赘述。而这个在后面进行双平台部署的时候会再次用到。\n\n#### **Front-matter**\n\nFront-matter 是文件最上方以 `---` 分隔的区域，用于指定个别文件的变量，举例来说：\n\n```\ntitle: Hello World\ndate: 2013/7/13 20:46:25\n---\n```\n\n下是预先定义的参数，您可在模板中使用这些参数值并加以利用。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-14.jpg)\n\n其中，分类和标签需要区别一下，分类具有顺序性和层次性，也就是说 `Foo, Bar` 不等于 `Bar, Foo`；而标签没有顺序和层次。\n\n```\ncategories:\n- Diary\ntags:\n- PS3\n- Games\n```\n\n#### **layout（布局）**\n\n当你每一次使用代码\n\n```\nhexo new paper\n```\n\n它其实默认使用的是`post`这个布局，也就是在`source`文件夹下的`_post`里面。\n\nHexo 有三种默认布局：`post`、`page` 和 `draft`，它们分别对应不同的路径，而您自定义的其他布局和 `post` 相同，都将储存到 `source/_posts` 文件夹。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-15.jpg)\n\n而new这个命令其实是：\n\n```\nhexo new [layout] <title>\n```\n\n只不过这个layout默认是post罢了。\n\n##### page\n\n如果你想另起一页，那么可以使用\n\n```\nhexo new page board\n```\n\n系统会自动给你在source文件夹下创建一个board文件夹，以及board文件夹中的index.md，这样你访问的board对应的链接就是`http://xxx.xxx/board`\n\n##### draft\n\ndraft是草稿的意思，也就是你如果想写文章，又不希望被看到，那么可以\n\n```\nhexo new draft newpage\n```\n\n这样会在source/_draft中新建一个newpage.md文件，如果你的草稿文件写的过程中，想要预览一下，那么可以使用\n\n```\nhexo server --draft\n```\n\n在本地端口中开启服务预览。\n\n如果你的草稿文件写完了，想要发表到post中，\n\n```\nhexo publish draft newpage\n```\n\n就会自动把newpage.md发送到post中。\n\n#### **2. 更换主题**\n\n到这一步，如果你觉得默认的`landscape`主题不好看，那么可以在官网的主题中，选择你喜欢的一个主题进行修改就可以啦。[点这里](https://hexo.io/themes/)\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-16.jpg)\n\n直接在`github`链接上下载下来，然后放到`theme`文件夹下就行了，然后再在刚才说的配置文件中把`theme`换成那个主题文件夹的名字，它就会自动在theme文件夹中搜索你配置的主题。\n\n而后进入`hueman`这个文件夹，可以看到里面也有一个配置文件`_config.xml`，貌似它默认是`_config.xml.example`，把它复制一份，重命名为`_config.xml`就可以了。这个配置文件是修改你整个主题的配置文件。\n\n#### **3. git分支进行多终端工作**\n\n问题来了，如果你现在在自己的笔记本上写的博客，部署在了网站上，那么你在家里用台式机，或者实验室的台式机，发现你电脑里面没有博客的文件，或者要换电脑了，最后不知道怎么移动文件，怎么办？\n\n在这里我们就可以利用git的分支系统进行多终端工作了，这样每次打开不一样的电脑，只需要进行简单的配置和在github上把文件同步下来，就可以无缝操作了。\n\n#### 机制\n\n机制是这样的，由于`hexo d`上传部署到github的其实是hexo编译后的文件，是用来生成网页的，不包含源文件。\n\n也就是上传的是在本地目录里自动生成的`.deploy_git`里面。\n\n其他文件 ，包括我们写在source 里面的，和配置文件，主题文件，都没有上传到github\n\n所以可以利用git的分支管理，将源文件上传到github的另一个分支即可。\n\n#### 上传分支\n\n首先，先在github上新建一个hexo分支，如图：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-17.jpg)\n\n然后在这个仓库的settings中，选择默认分支为hexo分支（这样每次同步的时候就不用指定分支，比较方便）。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-18.jpg)\n\n然后在本地的任意目录下，打开git bash，\n\n```\ngit clone git@github.com:xxxxx-hub/xxxxxx.github.io.git\n```\n\n将其克隆到本地，因为默认分支已经设成了hexo，所以clone时只clone了hexo。\n\n接下来在克隆到本地的`ZJUFangzh.github.io`中，把除了.git 文件夹外的所有文件都删掉\n\n把之前我们写的博客源文件全部复制过来，除了`.deploy_git`。这里应该说一句，复制过来的源文件应该有一个`.gitignore`，用来忽略一些不需要的文件，如果没有的话，自己新建一个，在里面写上如下，表示这些类型文件不需要git：\n\n```\n.DS_Store\nThumbs.db\ndb.json\n*.log\nnode_modules/\npublic/\n.deploy*/\n```\n\n注意，如果你之前克隆过theme中的主题文件，那么应该把主题文件中的`.git`文件夹删掉，因为git不能嵌套上传，最好是显示隐藏文件，检查一下有没有，否则上传的时候会出错，导致你的主题文件无法上传，这样你的配置在别的电脑上就用不了了。\n\n而后\n\n```\ngit add .\ngit commit –m \"add branch\"\ngit push \n```\n\n这样就上传完了，可以去你的github上看一看hexo分支有没有上传上去，其中`node_modules`、`public`、`db.json`已经被忽略掉了，没有关系，不需要上传的，因为在别的电脑上需要重新输入命令安装 。\n\n这样就上传完了。\n\n#### 更换电脑操作\n\n一样的，跟之前的环境搭建一样，\n\n- 安装git\n\n```\nsudo apt-get install git\n```\n\n- 设置git全局邮箱和用户名\n\n```\ngit config --global user.name \"yourgithubname\"\ngit config --global user.email \"yourgithubemail\"\n```\n\n- 设置ssh key\n\n```\nssh-keygen -t rsa -C \"youremail\"\n#生成后填到github和coding上（有coding平台的话）\n#验证是否成功\nssh -T git@github.com\nssh -T git@git.coding.net #(有coding平台的话)\n```\n\n- 安装nodejs\n\n```\nsudo apt-get install nodejs\nsudo apt-get install npm\n```\n\n- 安装hexo\n\n```\nsudo npm install hexo-cli -g\n```\n\n但是已经不需要初始化了，\n\n直接在任意文件夹下，\n\n```\ngit clone git@………………\n```\n\n然后进入克隆到的文件夹：\n\n```\ncd xxx.github.io\nnpm install\nnpm install hexo-deployer-git --save\n```\n\n生成，部署：\n\n```\nhexo g\nhexo d\n```\n\n然后就可以开始写你的新博客了\n\n```\nhexo new newpage\n```\n\n**Tips:**\n\n1. 不要忘了，每次写完最好都把源文件上传一下\n\n```\ngit add .\ngit commit –m \"xxxx\"\ngit push \n```\n\n2. 如果是在已经编辑过的电脑上，已经有clone文件夹了，那么，每次只要和远端同步一下就行了\n\n```\ngit pull\n```\n\n","source":"_posts/博客制作.md","raw":"---\ntitle: hexo搭建博客\ndate: 2023-11-25 18:48:45\ntags:\n- 博客\ncategories:\n- hexo\n---\n\n# **hexo搭建博客**\n\n## **第一部分**\n\n### **Hexo简介**\n\nHexo是一款基于Node.js的静态博客框架，依赖少易于安装使用，可以方便的生成静态网页托管在GitHub和Coding上，是搭建博客的首选框架。\n\n### **Hexo搭建步骤**\n\n1. 安装Git\n2. 安装Node.js\n3. 安装Hexo\n4. GitHub创建个人仓库\n5. 生成SSH添加到GitHub\n6. 将hexo部署到GitHub\n7. 设置个人域名\n8. 发布文章\n\n\n#### **1. 安装Git**\n\nGit是目前世界上最先进的分布式版本控制系统，可以有效、高速的处理从很小到非常大的项目版本管理。也就是用来管理你的hexo博客文章，上传到GitHub的工具。Git非常强大，我觉得建议每个人都去了解一下。\n\n`Windows`：到git官网上下载,[Download git](https://gitforwindows.org/),下载后会有一个Git Bash的命令行工具，以后就用这个工具来使用git。\n\n`Linux`：对linux来说实在是太简单了，因为最早的git就是在linux上编写的，只需要一行代码\n\n```\nsudo apt-get install git\n```\n\n安装好后，用`git --version` 来查看一下版本\n\n#### **2. 安装nodejs**\n\nHexo是基于nodeJS编写的，所以需要安装一下nodeJs和里面的npm工具。\n\nwindows：[nodejs](https://nodejs.org/en/download/)选择LTS版本就行了。\n\nlinux：\n\n```\nsudo apt-get install nodejs\nsudo apt-get install npm\n```\n\n安装完后，打开命令行\n\n```\nnode -v\nnpm -v\n```\n\n检查一下有没有安装成功\n\n顺便说一下，windows在git安装完后，就可以直接使用git bash来敲命令行了，不用自带的cmd，cmd有点难用。\n\n#### **3. 安装hexo**\n\n****前面git和nodejs安装好后，就可以安装hexo了，你可以先创建一个文件夹blog，然后`cd`到这个文件夹下（或者在这个文件夹下直接右键git bash打开）。\n\n输入命令\n\n```\nnpm install -g hexo-cli\n```\n\n依旧用`hexo -v`查看一下版本\n\n至此就全部安装完了。\n\n接下来初始化一下hexo\n\n```\nhexo init myblog\n```\n\n这个myblog可以自己取什么名字都行，然后\n\n```\ncd myblog //进入这个myblog文件夹\nnpm install\n```\n\n新建完成后，指定文件夹目录下有：\n\n- node_modules: 依赖包\n- public：存放生成的页面\n- scaffolds：生成文章的一些模板\n- source：用来存放你的文章\n- themes：主题\n- ** _config.yml: 博客的配置文件**\n\n```\nhexo g\nhexo server\n```\n\n打开hexo的服务，在浏览器输入localhost:4000就可以看到你生成的博客了。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-1.jpg)\n\n使用ctrl+c可以把服务关掉。\n\n#### **4. GitHub创建个人仓库**\n\n首先，你先要有一个GitHub账户，去注册一个吧。\n\n注册完登录后，在GitHub.com中看到一个New repository，新建仓库\n\n创建一个和你用户名相同的仓库，后面加.github.io，只有这样，将来要部署到GitHub page的时候，才会被识别，也就是xxxx.github.io，其中xxx就是你注册GitHub的用户名。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-22.jpg)\n\n点击create repository。\n\n#### **5. 生成SSH添加到GitHub**\n\n回到你的git bash中，\n\n```\ngit config --global user.name \"yourname\"\ngit config --global user.email \"youremail\"\n```\n\n这里的yourname输入你的GitHub用户名，youremail输入你GitHub的邮箱。这样GitHub才能知道你是不是对应它的账户。\n\n```\ngit config user.name\ngit config user.email\n```\n\n然后创建SSH,一路回车\n\n```\nssh-keygen -t rsa -C \"youremail\"\n```\n\n这个时候它会告诉你已经生成了.ssh的文件夹。在你的电脑中找到这个文件夹。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-3.jpg)\n\nssh，简单来讲，就是一个秘钥，其中，`id_rsa`是你这台电脑的私人秘钥，不能给别人看的，`id_rsa.pub`是公共秘钥，可以随便给别人看。把这个公钥放在GitHub上，这样当你链接GitHub自己的账户时，它就会根据公钥匹配你的私钥，当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上\n\n而后在GitHub的setting中，找到SSH keys的设置选项，点击`New SSH key`\n把你的`id_rsa.pub`里面的信息复制进去。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-4jpg.jpg)\n\n在gitbash中，查看是否成功\n\n```\nssh -T git@github.com\n```\n\n#### **6. 将hexo部署到GitHub**\n\n这一步，我们就可以将hexo和GitHub关联起来，也就是将hexo生成的文章部署到GitHub上，打开站点配置文件 `_config.yml`，翻到最后，修改为\nYourgithubName就是你的GitHub账户\n\n```\ndeploy:\n  type: git\n  repo: https://github.com/YourgithubName/YourgithubName.github.io.git\n  branch: master\n```\n\n这个时候需要先安装deploy-git ，也就是部署的命令,这样你才能用命令部署到GitHub。\n\n```\nnpm install hexo-deployer-git --save\n```\n\n然后\n\n```\nhexo clean\nhexo generate\nhexo deploy\n```\n\n其中 `hexo clean`清除了你之前生成的东西，也可以不加。\n`hexo generate` 顾名思义，生成静态文章，可以用 `hexo g`缩写\n`hexo deploy` 部署文章，可以用`hexo d`缩写\n\n注意deploy时可能要你输入username和password。\n\n得到下图就说明部署成功了，过一会儿就可以在http://yourname.github.io 这个网站看到你的博客了！！\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-5.jpg)\n\n接下来你就可以正式开始写文章了。\n\n```\nhexo new newpapername\n```\n\n然后在source/_post中打开markdown文件，就可以开始编辑了。当你写完的时候，再\n\n```\nhexo clean\nhexo g\nhexo d\n```\n\n就可以看到更新了。\n\n\n\n## **第二部分**\n\nhexo的基本配置，更换主题，实现多终端工作，以及在coding page部署实现国内外分流。\n\n#### **1. hexo基本配置**\n\n在文件根目录下的`_config.yml`，就是整个hexo框架的配置文件了。可以在里面修改大部分的配置。详细可参考[官方的配置](https://hexo.io/zh-cn/docs/configuration)描述。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-11.jpg)\n其中，description主要用于SEO，告诉搜索引擎一个关于您站点的简单描述，通常建议在其中包含您网站的关键词。author参数用于主题显示文章的作者。\n**网址**\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-12.jpg)\n\n在这里，你需要把url改成你的网站域名。\n\npermalink，也就是你生成某个文章时的那个链接格式。\n\n比如我新建一个文章叫temp.md，那么这个时候他自动生成的地址就是http://yoursite.com/2018/09/05/temp。\n\n以下是官方给出的示例，关于链接的变量还有很多，需要的可以去官网上查找 [永久链接](https://hexo.io/zh-cn/docs/permalinks) 。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-13.jpg)\n\n再往下翻，中间这些都默认就好了。\n\n```\ntheme: landscape\n\n# Deployment\n## Docs: https://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo: <repository url>\n  branch: [branch]\n```\n\n`theme`就是选择什么主题，也就是在`theme`这个文件夹下，在官网上有很多个主题，默认给你安装的是`lanscape`这个主题。当你需要更换主题时，在官网上下载，把主题的文件放在`theme`文件夹下，再修改这个参数就可以了。\n\n接下来这个`deploy`就是网站的部署的，`repo`就是仓库(Repository)的简写。branch选择仓库的哪个分支。这个在之前进行github page部署的时候已经修改过了，不再赘述。而这个在后面进行双平台部署的时候会再次用到。\n\n#### **Front-matter**\n\nFront-matter 是文件最上方以 `---` 分隔的区域，用于指定个别文件的变量，举例来说：\n\n```\ntitle: Hello World\ndate: 2013/7/13 20:46:25\n---\n```\n\n下是预先定义的参数，您可在模板中使用这些参数值并加以利用。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-14.jpg)\n\n其中，分类和标签需要区别一下，分类具有顺序性和层次性，也就是说 `Foo, Bar` 不等于 `Bar, Foo`；而标签没有顺序和层次。\n\n```\ncategories:\n- Diary\ntags:\n- PS3\n- Games\n```\n\n#### **layout（布局）**\n\n当你每一次使用代码\n\n```\nhexo new paper\n```\n\n它其实默认使用的是`post`这个布局，也就是在`source`文件夹下的`_post`里面。\n\nHexo 有三种默认布局：`post`、`page` 和 `draft`，它们分别对应不同的路径，而您自定义的其他布局和 `post` 相同，都将储存到 `source/_posts` 文件夹。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-15.jpg)\n\n而new这个命令其实是：\n\n```\nhexo new [layout] <title>\n```\n\n只不过这个layout默认是post罢了。\n\n##### page\n\n如果你想另起一页，那么可以使用\n\n```\nhexo new page board\n```\n\n系统会自动给你在source文件夹下创建一个board文件夹，以及board文件夹中的index.md，这样你访问的board对应的链接就是`http://xxx.xxx/board`\n\n##### draft\n\ndraft是草稿的意思，也就是你如果想写文章，又不希望被看到，那么可以\n\n```\nhexo new draft newpage\n```\n\n这样会在source/_draft中新建一个newpage.md文件，如果你的草稿文件写的过程中，想要预览一下，那么可以使用\n\n```\nhexo server --draft\n```\n\n在本地端口中开启服务预览。\n\n如果你的草稿文件写完了，想要发表到post中，\n\n```\nhexo publish draft newpage\n```\n\n就会自动把newpage.md发送到post中。\n\n#### **2. 更换主题**\n\n到这一步，如果你觉得默认的`landscape`主题不好看，那么可以在官网的主题中，选择你喜欢的一个主题进行修改就可以啦。[点这里](https://hexo.io/themes/)\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-16.jpg)\n\n直接在`github`链接上下载下来，然后放到`theme`文件夹下就行了，然后再在刚才说的配置文件中把`theme`换成那个主题文件夹的名字，它就会自动在theme文件夹中搜索你配置的主题。\n\n而后进入`hueman`这个文件夹，可以看到里面也有一个配置文件`_config.xml`，貌似它默认是`_config.xml.example`，把它复制一份，重命名为`_config.xml`就可以了。这个配置文件是修改你整个主题的配置文件。\n\n#### **3. git分支进行多终端工作**\n\n问题来了，如果你现在在自己的笔记本上写的博客，部署在了网站上，那么你在家里用台式机，或者实验室的台式机，发现你电脑里面没有博客的文件，或者要换电脑了，最后不知道怎么移动文件，怎么办？\n\n在这里我们就可以利用git的分支系统进行多终端工作了，这样每次打开不一样的电脑，只需要进行简单的配置和在github上把文件同步下来，就可以无缝操作了。\n\n#### 机制\n\n机制是这样的，由于`hexo d`上传部署到github的其实是hexo编译后的文件，是用来生成网页的，不包含源文件。\n\n也就是上传的是在本地目录里自动生成的`.deploy_git`里面。\n\n其他文件 ，包括我们写在source 里面的，和配置文件，主题文件，都没有上传到github\n\n所以可以利用git的分支管理，将源文件上传到github的另一个分支即可。\n\n#### 上传分支\n\n首先，先在github上新建一个hexo分支，如图：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-17.jpg)\n\n然后在这个仓库的settings中，选择默认分支为hexo分支（这样每次同步的时候就不用指定分支，比较方便）。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-18.jpg)\n\n然后在本地的任意目录下，打开git bash，\n\n```\ngit clone git@github.com:xxxxx-hub/xxxxxx.github.io.git\n```\n\n将其克隆到本地，因为默认分支已经设成了hexo，所以clone时只clone了hexo。\n\n接下来在克隆到本地的`ZJUFangzh.github.io`中，把除了.git 文件夹外的所有文件都删掉\n\n把之前我们写的博客源文件全部复制过来，除了`.deploy_git`。这里应该说一句，复制过来的源文件应该有一个`.gitignore`，用来忽略一些不需要的文件，如果没有的话，自己新建一个，在里面写上如下，表示这些类型文件不需要git：\n\n```\n.DS_Store\nThumbs.db\ndb.json\n*.log\nnode_modules/\npublic/\n.deploy*/\n```\n\n注意，如果你之前克隆过theme中的主题文件，那么应该把主题文件中的`.git`文件夹删掉，因为git不能嵌套上传，最好是显示隐藏文件，检查一下有没有，否则上传的时候会出错，导致你的主题文件无法上传，这样你的配置在别的电脑上就用不了了。\n\n而后\n\n```\ngit add .\ngit commit –m \"add branch\"\ngit push \n```\n\n这样就上传完了，可以去你的github上看一看hexo分支有没有上传上去，其中`node_modules`、`public`、`db.json`已经被忽略掉了，没有关系，不需要上传的，因为在别的电脑上需要重新输入命令安装 。\n\n这样就上传完了。\n\n#### 更换电脑操作\n\n一样的，跟之前的环境搭建一样，\n\n- 安装git\n\n```\nsudo apt-get install git\n```\n\n- 设置git全局邮箱和用户名\n\n```\ngit config --global user.name \"yourgithubname\"\ngit config --global user.email \"yourgithubemail\"\n```\n\n- 设置ssh key\n\n```\nssh-keygen -t rsa -C \"youremail\"\n#生成后填到github和coding上（有coding平台的话）\n#验证是否成功\nssh -T git@github.com\nssh -T git@git.coding.net #(有coding平台的话)\n```\n\n- 安装nodejs\n\n```\nsudo apt-get install nodejs\nsudo apt-get install npm\n```\n\n- 安装hexo\n\n```\nsudo npm install hexo-cli -g\n```\n\n但是已经不需要初始化了，\n\n直接在任意文件夹下，\n\n```\ngit clone git@………………\n```\n\n然后进入克隆到的文件夹：\n\n```\ncd xxx.github.io\nnpm install\nnpm install hexo-deployer-git --save\n```\n\n生成，部署：\n\n```\nhexo g\nhexo d\n```\n\n然后就可以开始写你的新博客了\n\n```\nhexo new newpage\n```\n\n**Tips:**\n\n1. 不要忘了，每次写完最好都把源文件上传一下\n\n```\ngit add .\ngit commit –m \"xxxx\"\ngit push \n```\n\n2. 如果是在已经编辑过的电脑上，已经有clone文件夹了，那么，每次只要和远端同步一下就行了\n\n```\ngit pull\n```\n\n","slug":"博客制作","published":1,"updated":"2025-03-20T11:59:32.122Z","comments":1,"layout":"post","photos":[],"_id":"cmck4zyri000ft0am1z624h36","content":"<h1 id=\"hexo搭建博客\"><a href=\"#hexo搭建博客\" class=\"headerlink\" title=\"hexo搭建博客\"></a><strong>hexo搭建博客</strong></h1><h2 id=\"第一部分\"><a href=\"#第一部分\" class=\"headerlink\" title=\"第一部分\"></a><strong>第一部分</strong></h2><h3 id=\"Hexo简介\"><a href=\"#Hexo简介\" class=\"headerlink\" title=\"Hexo简介\"></a><strong>Hexo简介</strong></h3><p>Hexo是一款基于Node.js的静态博客框架，依赖少易于安装使用，可以方便的生成静态网页托管在GitHub和Coding上，是搭建博客的首选框架。</p>\n<h3 id=\"Hexo搭建步骤\"><a href=\"#Hexo搭建步骤\" class=\"headerlink\" title=\"Hexo搭建步骤\"></a><strong>Hexo搭建步骤</strong></h3><ol>\n<li>安装Git</li>\n<li>安装Node.js</li>\n<li>安装Hexo</li>\n<li>GitHub创建个人仓库</li>\n<li>生成SSH添加到GitHub</li>\n<li>将hexo部署到GitHub</li>\n<li>设置个人域名</li>\n<li>发布文章</li>\n</ol>\n<h4 id=\"1-安装Git\"><a href=\"#1-安装Git\" class=\"headerlink\" title=\"1. 安装Git\"></a><strong>1. 安装Git</strong></h4><p>Git是目前世界上最先进的分布式版本控制系统，可以有效、高速的处理从很小到非常大的项目版本管理。也就是用来管理你的hexo博客文章，上传到GitHub的工具。Git非常强大，我觉得建议每个人都去了解一下。</p>\n<p><code>Windows</code>：到git官网上下载,<a href=\"https://gitforwindows.org/\">Download git</a>,下载后会有一个Git Bash的命令行工具，以后就用这个工具来使用git。</p>\n<p><code>Linux</code>：对linux来说实在是太简单了，因为最早的git就是在linux上编写的，只需要一行代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install git</span><br></pre></td></tr></table></figure>\n\n<p>安装好后，用<code>git --version</code> 来查看一下版本</p>\n<h4 id=\"2-安装nodejs\"><a href=\"#2-安装nodejs\" class=\"headerlink\" title=\"2. 安装nodejs\"></a><strong>2. 安装nodejs</strong></h4><p>Hexo是基于nodeJS编写的，所以需要安装一下nodeJs和里面的npm工具。</p>\n<p>windows：<a href=\"https://nodejs.org/en/download/\">nodejs</a>选择LTS版本就行了。</p>\n<p>linux：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install nodejs</span><br><span class=\"line\">sudo apt-get install npm</span><br></pre></td></tr></table></figure>\n\n<p>安装完后，打开命令行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br><span class=\"line\">npm -v</span><br></pre></td></tr></table></figure>\n\n<p>检查一下有没有安装成功</p>\n<p>顺便说一下，windows在git安装完后，就可以直接使用git bash来敲命令行了，不用自带的cmd，cmd有点难用。</p>\n<h4 id=\"3-安装hexo\"><a href=\"#3-安装hexo\" class=\"headerlink\" title=\"3. 安装hexo\"></a><strong>3. 安装hexo</strong></h4><p>****前面git和nodejs安装好后，就可以安装hexo了，你可以先创建一个文件夹blog，然后<code>cd</code>到这个文件夹下（或者在这个文件夹下直接右键git bash打开）。</p>\n<p>输入命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>\n\n<p>依旧用<code>hexo -v</code>查看一下版本</p>\n<p>至此就全部安装完了。</p>\n<p>接下来初始化一下hexo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init myblog</span><br></pre></td></tr></table></figure>\n\n<p>这个myblog可以自己取什么名字都行，然后</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd myblog //进入这个myblog文件夹</span><br><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n\n<p>新建完成后，指定文件夹目录下有：</p>\n<ul>\n<li>node_modules: 依赖包</li>\n<li>public：存放生成的页面</li>\n<li>scaffolds：生成文章的一些模板</li>\n<li>source：用来存放你的文章</li>\n<li>themes：主题</li>\n<li>** _config.yml: 博客的配置文件**</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo g</span><br><span class=\"line\">hexo server</span><br></pre></td></tr></table></figure>\n\n<p>打开hexo的服务，在浏览器输入localhost:4000就可以看到你生成的博客了。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-1.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-1.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>使用ctrl+c可以把服务关掉。</p>\n<h4 id=\"4-GitHub创建个人仓库\"><a href=\"#4-GitHub创建个人仓库\" class=\"headerlink\" title=\"4. GitHub创建个人仓库\"></a><strong>4. GitHub创建个人仓库</strong></h4><p>首先，你先要有一个GitHub账户，去注册一个吧。</p>\n<p>注册完登录后，在GitHub.com中看到一个New repository，新建仓库</p>\n<p>创建一个和你用户名相同的仓库，后面加.github.io，只有这样，将来要部署到GitHub page的时候，才会被识别，也就是xxxx.github.io，其中xxx就是你注册GitHub的用户名。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-22.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-22.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>点击create repository。</p>\n<h4 id=\"5-生成SSH添加到GitHub\"><a href=\"#5-生成SSH添加到GitHub\" class=\"headerlink\" title=\"5. 生成SSH添加到GitHub\"></a><strong>5. 生成SSH添加到GitHub</strong></h4><p>回到你的git bash中，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name &quot;yourname&quot;</span><br><span class=\"line\">git config --global user.email &quot;youremail&quot;</span><br></pre></td></tr></table></figure>\n\n<p>这里的yourname输入你的GitHub用户名，youremail输入你GitHub的邮箱。这样GitHub才能知道你是不是对应它的账户。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config user.name</span><br><span class=\"line\">git config user.email</span><br></pre></td></tr></table></figure>\n\n<p>然后创建SSH,一路回车</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;youremail&quot;</span><br></pre></td></tr></table></figure>\n\n<p>这个时候它会告诉你已经生成了.ssh的文件夹。在你的电脑中找到这个文件夹。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-3.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-3.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>ssh，简单来讲，就是一个秘钥，其中，<code>id_rsa</code>是你这台电脑的私人秘钥，不能给别人看的，<code>id_rsa.pub</code>是公共秘钥，可以随便给别人看。把这个公钥放在GitHub上，这样当你链接GitHub自己的账户时，它就会根据公钥匹配你的私钥，当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上</p>\n<p>而后在GitHub的setting中，找到SSH keys的设置选项，点击<code>New SSH key</code><br>把你的<code>id_rsa.pub</code>里面的信息复制进去。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-4jpg.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-4jpg.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>在gitbash中，查看是否成功</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -T git@github.com</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"6-将hexo部署到GitHub\"><a href=\"#6-将hexo部署到GitHub\" class=\"headerlink\" title=\"6. 将hexo部署到GitHub\"></a><strong>6. 将hexo部署到GitHub</strong></h4><p>这一步，我们就可以将hexo和GitHub关联起来，也就是将hexo生成的文章部署到GitHub上，打开站点配置文件 <code>_config.yml</code>，翻到最后，修改为<br>YourgithubName就是你的GitHub账户</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo: https://github.com/YourgithubName/YourgithubName.github.io.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n\n<p>这个时候需要先安装deploy-git ，也就是部署的命令,这样你才能用命令部署到GitHub。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n\n<p>然后</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo generate</span><br><span class=\"line\">hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>其中 <code>hexo clean</code>清除了你之前生成的东西，也可以不加。<br><code>hexo generate</code> 顾名思义，生成静态文章，可以用 <code>hexo g</code>缩写<br><code>hexo deploy</code> 部署文章，可以用<code>hexo d</code>缩写</p>\n<p>注意deploy时可能要你输入username和password。</p>\n<p>得到下图就说明部署成功了，过一会儿就可以在<a href=\"http://yourname.github.io/\">http://yourname.github.io</a> 这个网站看到你的博客了！！</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-5.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-5.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>接下来你就可以正式开始写文章了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new newpapername</span><br></pre></td></tr></table></figure>\n\n<p>然后在source&#x2F;_post中打开markdown文件，就可以开始编辑了。当你写完的时候，再</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">hexo d</span><br></pre></td></tr></table></figure>\n\n<p>就可以看到更新了。</p>\n<h2 id=\"第二部分\"><a href=\"#第二部分\" class=\"headerlink\" title=\"第二部分\"></a><strong>第二部分</strong></h2><p>hexo的基本配置，更换主题，实现多终端工作，以及在coding page部署实现国内外分流。</p>\n<h4 id=\"1-hexo基本配置\"><a href=\"#1-hexo基本配置\" class=\"headerlink\" title=\"1. hexo基本配置\"></a><strong>1. hexo基本配置</strong></h4><p>在文件根目录下的<code>_config.yml</code>，就是整个hexo框架的配置文件了。可以在里面修改大部分的配置。详细可参考<a href=\"https://hexo.io/zh-cn/docs/configuration\">官方的配置</a>描述。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-11.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-11.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"><br>其中，description主要用于SEO，告诉搜索引擎一个关于您站点的简单描述，通常建议在其中包含您网站的关键词。author参数用于主题显示文章的作者。<br><strong>网址</strong></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-12.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-12.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>在这里，你需要把url改成你的网站域名。</p>\n<p>permalink，也就是你生成某个文章时的那个链接格式。</p>\n<p>比如我新建一个文章叫temp.md，那么这个时候他自动生成的地址就是<a href=\"http://yoursite.com/2018/09/05/temp%E3%80%82\">http://yoursite.com/2018/09/05/temp。</a></p>\n<p>以下是官方给出的示例，关于链接的变量还有很多，需要的可以去官网上查找 <a href=\"https://hexo.io/zh-cn/docs/permalinks\">永久链接</a> 。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-13.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-13.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>再往下翻，中间这些都默认就好了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">theme: landscape</span><br><span class=\"line\"></span><br><span class=\"line\"># Deployment</span><br><span class=\"line\">## Docs: https://hexo.io/docs/deployment.html</span><br><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo: &lt;repository url&gt;</span><br><span class=\"line\">  branch: [branch]</span><br></pre></td></tr></table></figure>\n\n<p><code>theme</code>就是选择什么主题，也就是在<code>theme</code>这个文件夹下，在官网上有很多个主题，默认给你安装的是<code>lanscape</code>这个主题。当你需要更换主题时，在官网上下载，把主题的文件放在<code>theme</code>文件夹下，再修改这个参数就可以了。</p>\n<p>接下来这个<code>deploy</code>就是网站的部署的，<code>repo</code>就是仓库(Repository)的简写。branch选择仓库的哪个分支。这个在之前进行github page部署的时候已经修改过了，不再赘述。而这个在后面进行双平台部署的时候会再次用到。</p>\n<h4 id=\"Front-matter\"><a href=\"#Front-matter\" class=\"headerlink\" title=\"Front-matter\"></a><strong>Front-matter</strong></h4><p>Front-matter 是文件最上方以 <code>---</code> 分隔的区域，用于指定个别文件的变量，举例来说：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: Hello World</span><br><span class=\"line\">date: 2013/7/13 20:46:25</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p>下是预先定义的参数，您可在模板中使用这些参数值并加以利用。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-14.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-14.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>其中，分类和标签需要区别一下，分类具有顺序性和层次性，也就是说 <code>Foo, Bar</code> 不等于 <code>Bar, Foo</code>；而标签没有顺序和层次。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">categories:</span><br><span class=\"line\">- Diary</span><br><span class=\"line\">tags:</span><br><span class=\"line\">- PS3</span><br><span class=\"line\">- Games</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"layout（布局）\"><a href=\"#layout（布局）\" class=\"headerlink\" title=\"layout（布局）\"></a><strong>layout（布局）</strong></h4><p>当你每一次使用代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new paper</span><br></pre></td></tr></table></figure>\n\n<p>它其实默认使用的是<code>post</code>这个布局，也就是在<code>source</code>文件夹下的<code>_post</code>里面。</p>\n<p>Hexo 有三种默认布局：<code>post</code>、<code>page</code> 和 <code>draft</code>，它们分别对应不同的路径，而您自定义的其他布局和 <code>post</code> 相同，都将储存到 <code>source/_posts</code> 文件夹。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-15.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-15.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>而new这个命令其实是：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure>\n\n<p>只不过这个layout默认是post罢了。</p>\n<h5 id=\"page\"><a href=\"#page\" class=\"headerlink\" title=\"page\"></a>page</h5><p>如果你想另起一页，那么可以使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new page board</span><br></pre></td></tr></table></figure>\n\n<p>系统会自动给你在source文件夹下创建一个board文件夹，以及board文件夹中的index.md，这样你访问的board对应的链接就是<code>http://xxx.xxx/board</code></p>\n<h5 id=\"draft\"><a href=\"#draft\" class=\"headerlink\" title=\"draft\"></a>draft</h5><p>draft是草稿的意思，也就是你如果想写文章，又不希望被看到，那么可以</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new draft newpage</span><br></pre></td></tr></table></figure>\n\n<p>这样会在source&#x2F;_draft中新建一个newpage.md文件，如果你的草稿文件写的过程中，想要预览一下，那么可以使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo server --draft</span><br></pre></td></tr></table></figure>\n\n<p>在本地端口中开启服务预览。</p>\n<p>如果你的草稿文件写完了，想要发表到post中，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo publish draft newpage</span><br></pre></td></tr></table></figure>\n\n<p>就会自动把newpage.md发送到post中。</p>\n<h4 id=\"2-更换主题\"><a href=\"#2-更换主题\" class=\"headerlink\" title=\"2. 更换主题\"></a><strong>2. 更换主题</strong></h4><p>到这一步，如果你觉得默认的<code>landscape</code>主题不好看，那么可以在官网的主题中，选择你喜欢的一个主题进行修改就可以啦。<a href=\"https://hexo.io/themes/\">点这里</a></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-16.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-16.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>直接在<code>github</code>链接上下载下来，然后放到<code>theme</code>文件夹下就行了，然后再在刚才说的配置文件中把<code>theme</code>换成那个主题文件夹的名字，它就会自动在theme文件夹中搜索你配置的主题。</p>\n<p>而后进入<code>hueman</code>这个文件夹，可以看到里面也有一个配置文件<code>_config.xml</code>，貌似它默认是<code>_config.xml.example</code>，把它复制一份，重命名为<code>_config.xml</code>就可以了。这个配置文件是修改你整个主题的配置文件。</p>\n<h4 id=\"3-git分支进行多终端工作\"><a href=\"#3-git分支进行多终端工作\" class=\"headerlink\" title=\"3. git分支进行多终端工作\"></a><strong>3. git分支进行多终端工作</strong></h4><p>问题来了，如果你现在在自己的笔记本上写的博客，部署在了网站上，那么你在家里用台式机，或者实验室的台式机，发现你电脑里面没有博客的文件，或者要换电脑了，最后不知道怎么移动文件，怎么办？</p>\n<p>在这里我们就可以利用git的分支系统进行多终端工作了，这样每次打开不一样的电脑，只需要进行简单的配置和在github上把文件同步下来，就可以无缝操作了。</p>\n<h4 id=\"机制\"><a href=\"#机制\" class=\"headerlink\" title=\"机制\"></a>机制</h4><p>机制是这样的，由于<code>hexo d</code>上传部署到github的其实是hexo编译后的文件，是用来生成网页的，不包含源文件。</p>\n<p>也就是上传的是在本地目录里自动生成的<code>.deploy_git</code>里面。</p>\n<p>其他文件 ，包括我们写在source 里面的，和配置文件，主题文件，都没有上传到github</p>\n<p>所以可以利用git的分支管理，将源文件上传到github的另一个分支即可。</p>\n<h4 id=\"上传分支\"><a href=\"#上传分支\" class=\"headerlink\" title=\"上传分支\"></a>上传分支</h4><p>首先，先在github上新建一个hexo分支，如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-17.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-17.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>然后在这个仓库的settings中，选择默认分支为hexo分支（这样每次同步的时候就不用指定分支，比较方便）。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-18.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-18.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>然后在本地的任意目录下，打开git bash，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@github.com:xxxxx-hub/xxxxxx.github.io.git</span><br></pre></td></tr></table></figure>\n\n<p>将其克隆到本地，因为默认分支已经设成了hexo，所以clone时只clone了hexo。</p>\n<p>接下来在克隆到本地的<code>ZJUFangzh.github.io</code>中，把除了.git 文件夹外的所有文件都删掉</p>\n<p>把之前我们写的博客源文件全部复制过来，除了<code>.deploy_git</code>。这里应该说一句，复制过来的源文件应该有一个<code>.gitignore</code>，用来忽略一些不需要的文件，如果没有的话，自己新建一个，在里面写上如下，表示这些类型文件不需要git：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<p>注意，如果你之前克隆过theme中的主题文件，那么应该把主题文件中的<code>.git</code>文件夹删掉，因为git不能嵌套上传，最好是显示隐藏文件，检查一下有没有，否则上传的时候会出错，导致你的主题文件无法上传，这样你的配置在别的电脑上就用不了了。</p>\n<p>而后</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit –m &quot;add branch&quot;</span><br><span class=\"line\">git push </span><br></pre></td></tr></table></figure>\n\n<p>这样就上传完了，可以去你的github上看一看hexo分支有没有上传上去，其中<code>node_modules</code>、<code>public</code>、<code>db.json</code>已经被忽略掉了，没有关系，不需要上传的，因为在别的电脑上需要重新输入命令安装 。</p>\n<p>这样就上传完了。</p>\n<h4 id=\"更换电脑操作\"><a href=\"#更换电脑操作\" class=\"headerlink\" title=\"更换电脑操作\"></a>更换电脑操作</h4><p>一样的，跟之前的环境搭建一样，</p>\n<ul>\n<li>安装git</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install git</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>设置git全局邮箱和用户名</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name &quot;yourgithubname&quot;</span><br><span class=\"line\">git config --global user.email &quot;yourgithubemail&quot;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>设置ssh key</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;youremail&quot;</span><br><span class=\"line\">#生成后填到github和coding上（有coding平台的话）</span><br><span class=\"line\">#验证是否成功</span><br><span class=\"line\">ssh -T git@github.com</span><br><span class=\"line\">ssh -T git@git.coding.net #(有coding平台的话)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装nodejs</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install nodejs</span><br><span class=\"line\">sudo apt-get install npm</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装hexo</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm install hexo-cli -g</span><br></pre></td></tr></table></figure>\n\n<p>但是已经不需要初始化了，</p>\n<p>直接在任意文件夹下，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@………………</span><br></pre></td></tr></table></figure>\n\n<p>然后进入克隆到的文件夹：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd xxx.github.io</span><br><span class=\"line\">npm install</span><br><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n\n<p>生成，部署：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo g</span><br><span class=\"line\">hexo d</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以开始写你的新博客了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new newpage</span><br></pre></td></tr></table></figure>\n\n<p><strong>Tips:</strong></p>\n<ol>\n<li>不要忘了，每次写完最好都把源文件上传一下</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit –m &quot;xxxx&quot;</span><br><span class=\"line\">git push </span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>如果是在已经编辑过的电脑上，已经有clone文件夹了，那么，每次只要和远端同步一下就行了</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git pull</span><br></pre></td></tr></table></figure>\n\n","excerpt":"","more":"<h1 id=\"hexo搭建博客\"><a href=\"#hexo搭建博客\" class=\"headerlink\" title=\"hexo搭建博客\"></a><strong>hexo搭建博客</strong></h1><h2 id=\"第一部分\"><a href=\"#第一部分\" class=\"headerlink\" title=\"第一部分\"></a><strong>第一部分</strong></h2><h3 id=\"Hexo简介\"><a href=\"#Hexo简介\" class=\"headerlink\" title=\"Hexo简介\"></a><strong>Hexo简介</strong></h3><p>Hexo是一款基于Node.js的静态博客框架，依赖少易于安装使用，可以方便的生成静态网页托管在GitHub和Coding上，是搭建博客的首选框架。</p>\n<h3 id=\"Hexo搭建步骤\"><a href=\"#Hexo搭建步骤\" class=\"headerlink\" title=\"Hexo搭建步骤\"></a><strong>Hexo搭建步骤</strong></h3><ol>\n<li>安装Git</li>\n<li>安装Node.js</li>\n<li>安装Hexo</li>\n<li>GitHub创建个人仓库</li>\n<li>生成SSH添加到GitHub</li>\n<li>将hexo部署到GitHub</li>\n<li>设置个人域名</li>\n<li>发布文章</li>\n</ol>\n<h4 id=\"1-安装Git\"><a href=\"#1-安装Git\" class=\"headerlink\" title=\"1. 安装Git\"></a><strong>1. 安装Git</strong></h4><p>Git是目前世界上最先进的分布式版本控制系统，可以有效、高速的处理从很小到非常大的项目版本管理。也就是用来管理你的hexo博客文章，上传到GitHub的工具。Git非常强大，我觉得建议每个人都去了解一下。</p>\n<p><code>Windows</code>：到git官网上下载,<a href=\"https://gitforwindows.org/\">Download git</a>,下载后会有一个Git Bash的命令行工具，以后就用这个工具来使用git。</p>\n<p><code>Linux</code>：对linux来说实在是太简单了，因为最早的git就是在linux上编写的，只需要一行代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install git</span><br></pre></td></tr></table></figure>\n\n<p>安装好后，用<code>git --version</code> 来查看一下版本</p>\n<h4 id=\"2-安装nodejs\"><a href=\"#2-安装nodejs\" class=\"headerlink\" title=\"2. 安装nodejs\"></a><strong>2. 安装nodejs</strong></h4><p>Hexo是基于nodeJS编写的，所以需要安装一下nodeJs和里面的npm工具。</p>\n<p>windows：<a href=\"https://nodejs.org/en/download/\">nodejs</a>选择LTS版本就行了。</p>\n<p>linux：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install nodejs</span><br><span class=\"line\">sudo apt-get install npm</span><br></pre></td></tr></table></figure>\n\n<p>安装完后，打开命令行</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br><span class=\"line\">npm -v</span><br></pre></td></tr></table></figure>\n\n<p>检查一下有没有安装成功</p>\n<p>顺便说一下，windows在git安装完后，就可以直接使用git bash来敲命令行了，不用自带的cmd，cmd有点难用。</p>\n<h4 id=\"3-安装hexo\"><a href=\"#3-安装hexo\" class=\"headerlink\" title=\"3. 安装hexo\"></a><strong>3. 安装hexo</strong></h4><p>****前面git和nodejs安装好后，就可以安装hexo了，你可以先创建一个文件夹blog，然后<code>cd</code>到这个文件夹下（或者在这个文件夹下直接右键git bash打开）。</p>\n<p>输入命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>\n\n<p>依旧用<code>hexo -v</code>查看一下版本</p>\n<p>至此就全部安装完了。</p>\n<p>接下来初始化一下hexo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init myblog</span><br></pre></td></tr></table></figure>\n\n<p>这个myblog可以自己取什么名字都行，然后</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd myblog //进入这个myblog文件夹</span><br><span class=\"line\">npm install</span><br></pre></td></tr></table></figure>\n\n<p>新建完成后，指定文件夹目录下有：</p>\n<ul>\n<li>node_modules: 依赖包</li>\n<li>public：存放生成的页面</li>\n<li>scaffolds：生成文章的一些模板</li>\n<li>source：用来存放你的文章</li>\n<li>themes：主题</li>\n<li>** _config.yml: 博客的配置文件**</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo g</span><br><span class=\"line\">hexo server</span><br></pre></td></tr></table></figure>\n\n<p>打开hexo的服务，在浏览器输入localhost:4000就可以看到你生成的博客了。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-1.jpg\"></p>\n<p>使用ctrl+c可以把服务关掉。</p>\n<h4 id=\"4-GitHub创建个人仓库\"><a href=\"#4-GitHub创建个人仓库\" class=\"headerlink\" title=\"4. GitHub创建个人仓库\"></a><strong>4. GitHub创建个人仓库</strong></h4><p>首先，你先要有一个GitHub账户，去注册一个吧。</p>\n<p>注册完登录后，在GitHub.com中看到一个New repository，新建仓库</p>\n<p>创建一个和你用户名相同的仓库，后面加.github.io，只有这样，将来要部署到GitHub page的时候，才会被识别，也就是xxxx.github.io，其中xxx就是你注册GitHub的用户名。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-22.jpg\"></p>\n<p>点击create repository。</p>\n<h4 id=\"5-生成SSH添加到GitHub\"><a href=\"#5-生成SSH添加到GitHub\" class=\"headerlink\" title=\"5. 生成SSH添加到GitHub\"></a><strong>5. 生成SSH添加到GitHub</strong></h4><p>回到你的git bash中，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name &quot;yourname&quot;</span><br><span class=\"line\">git config --global user.email &quot;youremail&quot;</span><br></pre></td></tr></table></figure>\n\n<p>这里的yourname输入你的GitHub用户名，youremail输入你GitHub的邮箱。这样GitHub才能知道你是不是对应它的账户。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config user.name</span><br><span class=\"line\">git config user.email</span><br></pre></td></tr></table></figure>\n\n<p>然后创建SSH,一路回车</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;youremail&quot;</span><br></pre></td></tr></table></figure>\n\n<p>这个时候它会告诉你已经生成了.ssh的文件夹。在你的电脑中找到这个文件夹。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-3.jpg\"></p>\n<p>ssh，简单来讲，就是一个秘钥，其中，<code>id_rsa</code>是你这台电脑的私人秘钥，不能给别人看的，<code>id_rsa.pub</code>是公共秘钥，可以随便给别人看。把这个公钥放在GitHub上，这样当你链接GitHub自己的账户时，它就会根据公钥匹配你的私钥，当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上</p>\n<p>而后在GitHub的setting中，找到SSH keys的设置选项，点击<code>New SSH key</code><br>把你的<code>id_rsa.pub</code>里面的信息复制进去。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-4jpg.jpg\"></p>\n<p>在gitbash中，查看是否成功</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -T git@github.com</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"6-将hexo部署到GitHub\"><a href=\"#6-将hexo部署到GitHub\" class=\"headerlink\" title=\"6. 将hexo部署到GitHub\"></a><strong>6. 将hexo部署到GitHub</strong></h4><p>这一步，我们就可以将hexo和GitHub关联起来，也就是将hexo生成的文章部署到GitHub上，打开站点配置文件 <code>_config.yml</code>，翻到最后，修改为<br>YourgithubName就是你的GitHub账户</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo: https://github.com/YourgithubName/YourgithubName.github.io.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n\n<p>这个时候需要先安装deploy-git ，也就是部署的命令,这样你才能用命令部署到GitHub。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n\n<p>然后</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo generate</span><br><span class=\"line\">hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>其中 <code>hexo clean</code>清除了你之前生成的东西，也可以不加。<br><code>hexo generate</code> 顾名思义，生成静态文章，可以用 <code>hexo g</code>缩写<br><code>hexo deploy</code> 部署文章，可以用<code>hexo d</code>缩写</p>\n<p>注意deploy时可能要你输入username和password。</p>\n<p>得到下图就说明部署成功了，过一会儿就可以在<a href=\"http://yourname.github.io/\">http://yourname.github.io</a> 这个网站看到你的博客了！！</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-5.jpg\"></p>\n<p>接下来你就可以正式开始写文章了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new newpapername</span><br></pre></td></tr></table></figure>\n\n<p>然后在source&#x2F;_post中打开markdown文件，就可以开始编辑了。当你写完的时候，再</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">hexo d</span><br></pre></td></tr></table></figure>\n\n<p>就可以看到更新了。</p>\n<h2 id=\"第二部分\"><a href=\"#第二部分\" class=\"headerlink\" title=\"第二部分\"></a><strong>第二部分</strong></h2><p>hexo的基本配置，更换主题，实现多终端工作，以及在coding page部署实现国内外分流。</p>\n<h4 id=\"1-hexo基本配置\"><a href=\"#1-hexo基本配置\" class=\"headerlink\" title=\"1. hexo基本配置\"></a><strong>1. hexo基本配置</strong></h4><p>在文件根目录下的<code>_config.yml</code>，就是整个hexo框架的配置文件了。可以在里面修改大部分的配置。详细可参考<a href=\"https://hexo.io/zh-cn/docs/configuration\">官方的配置</a>描述。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-11.jpg\"><br>其中，description主要用于SEO，告诉搜索引擎一个关于您站点的简单描述，通常建议在其中包含您网站的关键词。author参数用于主题显示文章的作者。<br><strong>网址</strong></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-12.jpg\"></p>\n<p>在这里，你需要把url改成你的网站域名。</p>\n<p>permalink，也就是你生成某个文章时的那个链接格式。</p>\n<p>比如我新建一个文章叫temp.md，那么这个时候他自动生成的地址就是<a href=\"http://yoursite.com/2018/09/05/temp%E3%80%82\">http://yoursite.com/2018/09/05/temp。</a></p>\n<p>以下是官方给出的示例，关于链接的变量还有很多，需要的可以去官网上查找 <a href=\"https://hexo.io/zh-cn/docs/permalinks\">永久链接</a> 。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-13.jpg\"></p>\n<p>再往下翻，中间这些都默认就好了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">theme: landscape</span><br><span class=\"line\"></span><br><span class=\"line\"># Deployment</span><br><span class=\"line\">## Docs: https://hexo.io/docs/deployment.html</span><br><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo: &lt;repository url&gt;</span><br><span class=\"line\">  branch: [branch]</span><br></pre></td></tr></table></figure>\n\n<p><code>theme</code>就是选择什么主题，也就是在<code>theme</code>这个文件夹下，在官网上有很多个主题，默认给你安装的是<code>lanscape</code>这个主题。当你需要更换主题时，在官网上下载，把主题的文件放在<code>theme</code>文件夹下，再修改这个参数就可以了。</p>\n<p>接下来这个<code>deploy</code>就是网站的部署的，<code>repo</code>就是仓库(Repository)的简写。branch选择仓库的哪个分支。这个在之前进行github page部署的时候已经修改过了，不再赘述。而这个在后面进行双平台部署的时候会再次用到。</p>\n<h4 id=\"Front-matter\"><a href=\"#Front-matter\" class=\"headerlink\" title=\"Front-matter\"></a><strong>Front-matter</strong></h4><p>Front-matter 是文件最上方以 <code>---</code> 分隔的区域，用于指定个别文件的变量，举例来说：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: Hello World</span><br><span class=\"line\">date: 2013/7/13 20:46:25</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p>下是预先定义的参数，您可在模板中使用这些参数值并加以利用。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-14.jpg\"></p>\n<p>其中，分类和标签需要区别一下，分类具有顺序性和层次性，也就是说 <code>Foo, Bar</code> 不等于 <code>Bar, Foo</code>；而标签没有顺序和层次。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">categories:</span><br><span class=\"line\">- Diary</span><br><span class=\"line\">tags:</span><br><span class=\"line\">- PS3</span><br><span class=\"line\">- Games</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"layout（布局）\"><a href=\"#layout（布局）\" class=\"headerlink\" title=\"layout（布局）\"></a><strong>layout（布局）</strong></h4><p>当你每一次使用代码</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new paper</span><br></pre></td></tr></table></figure>\n\n<p>它其实默认使用的是<code>post</code>这个布局，也就是在<code>source</code>文件夹下的<code>_post</code>里面。</p>\n<p>Hexo 有三种默认布局：<code>post</code>、<code>page</code> 和 <code>draft</code>，它们分别对应不同的路径，而您自定义的其他布局和 <code>post</code> 相同，都将储存到 <code>source/_posts</code> 文件夹。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-15.jpg\"></p>\n<p>而new这个命令其实是：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure>\n\n<p>只不过这个layout默认是post罢了。</p>\n<h5 id=\"page\"><a href=\"#page\" class=\"headerlink\" title=\"page\"></a>page</h5><p>如果你想另起一页，那么可以使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new page board</span><br></pre></td></tr></table></figure>\n\n<p>系统会自动给你在source文件夹下创建一个board文件夹，以及board文件夹中的index.md，这样你访问的board对应的链接就是<code>http://xxx.xxx/board</code></p>\n<h5 id=\"draft\"><a href=\"#draft\" class=\"headerlink\" title=\"draft\"></a>draft</h5><p>draft是草稿的意思，也就是你如果想写文章，又不希望被看到，那么可以</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new draft newpage</span><br></pre></td></tr></table></figure>\n\n<p>这样会在source&#x2F;_draft中新建一个newpage.md文件，如果你的草稿文件写的过程中，想要预览一下，那么可以使用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo server --draft</span><br></pre></td></tr></table></figure>\n\n<p>在本地端口中开启服务预览。</p>\n<p>如果你的草稿文件写完了，想要发表到post中，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo publish draft newpage</span><br></pre></td></tr></table></figure>\n\n<p>就会自动把newpage.md发送到post中。</p>\n<h4 id=\"2-更换主题\"><a href=\"#2-更换主题\" class=\"headerlink\" title=\"2. 更换主题\"></a><strong>2. 更换主题</strong></h4><p>到这一步，如果你觉得默认的<code>landscape</code>主题不好看，那么可以在官网的主题中，选择你喜欢的一个主题进行修改就可以啦。<a href=\"https://hexo.io/themes/\">点这里</a></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-16.jpg\"></p>\n<p>直接在<code>github</code>链接上下载下来，然后放到<code>theme</code>文件夹下就行了，然后再在刚才说的配置文件中把<code>theme</code>换成那个主题文件夹的名字，它就会自动在theme文件夹中搜索你配置的主题。</p>\n<p>而后进入<code>hueman</code>这个文件夹，可以看到里面也有一个配置文件<code>_config.xml</code>，貌似它默认是<code>_config.xml.example</code>，把它复制一份，重命名为<code>_config.xml</code>就可以了。这个配置文件是修改你整个主题的配置文件。</p>\n<h4 id=\"3-git分支进行多终端工作\"><a href=\"#3-git分支进行多终端工作\" class=\"headerlink\" title=\"3. git分支进行多终端工作\"></a><strong>3. git分支进行多终端工作</strong></h4><p>问题来了，如果你现在在自己的笔记本上写的博客，部署在了网站上，那么你在家里用台式机，或者实验室的台式机，发现你电脑里面没有博客的文件，或者要换电脑了，最后不知道怎么移动文件，怎么办？</p>\n<p>在这里我们就可以利用git的分支系统进行多终端工作了，这样每次打开不一样的电脑，只需要进行简单的配置和在github上把文件同步下来，就可以无缝操作了。</p>\n<h4 id=\"机制\"><a href=\"#机制\" class=\"headerlink\" title=\"机制\"></a>机制</h4><p>机制是这样的，由于<code>hexo d</code>上传部署到github的其实是hexo编译后的文件，是用来生成网页的，不包含源文件。</p>\n<p>也就是上传的是在本地目录里自动生成的<code>.deploy_git</code>里面。</p>\n<p>其他文件 ，包括我们写在source 里面的，和配置文件，主题文件，都没有上传到github</p>\n<p>所以可以利用git的分支管理，将源文件上传到github的另一个分支即可。</p>\n<h4 id=\"上传分支\"><a href=\"#上传分支\" class=\"headerlink\" title=\"上传分支\"></a>上传分支</h4><p>首先，先在github上新建一个hexo分支，如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-17.jpg\"></p>\n<p>然后在这个仓库的settings中，选择默认分支为hexo分支（这样每次同步的时候就不用指定分支，比较方便）。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-18.jpg\"></p>\n<p>然后在本地的任意目录下，打开git bash，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@github.com:xxxxx-hub/xxxxxx.github.io.git</span><br></pre></td></tr></table></figure>\n\n<p>将其克隆到本地，因为默认分支已经设成了hexo，所以clone时只clone了hexo。</p>\n<p>接下来在克隆到本地的<code>ZJUFangzh.github.io</code>中，把除了.git 文件夹外的所有文件都删掉</p>\n<p>把之前我们写的博客源文件全部复制过来，除了<code>.deploy_git</code>。这里应该说一句，复制过来的源文件应该有一个<code>.gitignore</code>，用来忽略一些不需要的文件，如果没有的话，自己新建一个，在里面写上如下，表示这些类型文件不需要git：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.DS_Store</span><br><span class=\"line\">Thumbs.db</span><br><span class=\"line\">db.json</span><br><span class=\"line\">*.log</span><br><span class=\"line\">node_modules/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br></pre></td></tr></table></figure>\n\n<p>注意，如果你之前克隆过theme中的主题文件，那么应该把主题文件中的<code>.git</code>文件夹删掉，因为git不能嵌套上传，最好是显示隐藏文件，检查一下有没有，否则上传的时候会出错，导致你的主题文件无法上传，这样你的配置在别的电脑上就用不了了。</p>\n<p>而后</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit –m &quot;add branch&quot;</span><br><span class=\"line\">git push </span><br></pre></td></tr></table></figure>\n\n<p>这样就上传完了，可以去你的github上看一看hexo分支有没有上传上去，其中<code>node_modules</code>、<code>public</code>、<code>db.json</code>已经被忽略掉了，没有关系，不需要上传的，因为在别的电脑上需要重新输入命令安装 。</p>\n<p>这样就上传完了。</p>\n<h4 id=\"更换电脑操作\"><a href=\"#更换电脑操作\" class=\"headerlink\" title=\"更换电脑操作\"></a>更换电脑操作</h4><p>一样的，跟之前的环境搭建一样，</p>\n<ul>\n<li>安装git</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install git</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>设置git全局邮箱和用户名</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name &quot;yourgithubname&quot;</span><br><span class=\"line\">git config --global user.email &quot;yourgithubemail&quot;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>设置ssh key</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;youremail&quot;</span><br><span class=\"line\">#生成后填到github和coding上（有coding平台的话）</span><br><span class=\"line\">#验证是否成功</span><br><span class=\"line\">ssh -T git@github.com</span><br><span class=\"line\">ssh -T git@git.coding.net #(有coding平台的话)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装nodejs</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install nodejs</span><br><span class=\"line\">sudo apt-get install npm</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装hexo</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm install hexo-cli -g</span><br></pre></td></tr></table></figure>\n\n<p>但是已经不需要初始化了，</p>\n<p>直接在任意文件夹下，</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone git@………………</span><br></pre></td></tr></table></figure>\n\n<p>然后进入克隆到的文件夹：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd xxx.github.io</span><br><span class=\"line\">npm install</span><br><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n\n<p>生成，部署：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo g</span><br><span class=\"line\">hexo d</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以开始写你的新博客了</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new newpage</span><br></pre></td></tr></table></figure>\n\n<p><strong>Tips:</strong></p>\n<ol>\n<li>不要忘了，每次写完最好都把源文件上传一下</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\">git commit –m &quot;xxxx&quot;</span><br><span class=\"line\">git push </span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>如果是在已经编辑过的电脑上，已经有clone文件夹了，那么，每次只要和远端同步一下就行了</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git pull</span><br></pre></td></tr></table></figure>\n\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-1.jpg","popularPost_tmp_gaData":{"updated":"Thu Mar 20 2025 19:59:32 GMT+0800 (中国标准时间)","title":"hexo搭建博客","path":"2023/11/25/博客制作/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/hexo-1.jpg","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2023-11-25T10:48:45.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2023-11-25T10:48:45.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"hexo","tags":["博客"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"SpringCache框架的使用","date":"2024-08-08T02:27:30.000Z","_content":"\n# SpringCache框架的使用\n\n## 1、注解\n\n| **注解**            | **说明**                                                     |\n| ------------------- | ------------------------------------------------------------ |\n| [@EnableCaching ]() | 开启缓存注解功能                                             |\n| [@Cacheable ]()     | 在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中 |\n| [@CachePut ]()      | 将方法的返回值放到缓存中                                     |\n| [@CacheEvict ]()    | 将一条或多条数据从缓存中删除                                 |\n\n## 2、导入坐标\n\n使用Redis作为缓存技术，只需要导入Spring data Redis的maven坐标即可\n\n```Java\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-cache</artifactId>\n</dependency>\n\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n```\n\napplication.yml\n\n```Java\nspring:\n  redis:\n    host: 192.168.200.200\n    port: 6379\n    password: root@123456\n    database: 0\n  cache:\n    redis:\n      time-to-live: 1800000   #设置缓存过期时间，可选\n```\n\n## 3、注解应用\n\n#### **@CachePut注解**\n\n[@CachePut ]() 说明： \n\n​\t作用: 将方法返回值，放入缓存\n\n​\tvalue: 缓存的名称, 每个缓存名称下面可以有很多key\n\n​\tkey: 缓存的key  ----------> 支持Spring的表达式语言SPEL语法\n\n```Java\n/**\n* CachePut：将方法返回值放入缓存\n* value：缓存的名称，每个缓存名称下面可以有多个key\n* key：缓存的key\n*/\n@CachePut(value = \"userCache\", key = \"#user.id\")\n@PostMapping\npublic User save(User user){\n    userService.save(user);\n    return user;\n}\n```\n\nkey的写法如下：\n\n​\t#user.id : #user指的是方法形参的名称, id指的是user的id属性 , 也就是使用user的id属性作为key ;\n\n​\t#user.name: #user指的是方法形参的名称, name指的是user的name属性 ,也就是使用user的name属性作为key ;\n\n​\t#result.id : #result代表方法返回值，该表达式 代表以返回对象的id属性作为key ；\n\n​\t#result.name : #result代表方法返回值，该表达式 代表以返回对象的name属性作为key ；\n\n\n\n#### **@CacheEvict注解**\n\n[@CacheEvict ]() 说明： \n\n​\t作用: 清理指定缓存\n\n​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key\n\n​\tkey: 缓存的key  ----------> 支持Spring的表达式语言SPEL语法\n\n```java\n/**\n* CacheEvict：清理指定缓存\n* value：缓存的名称，每个缓存名称下面可以有多个key\n* key：缓存的key\n*/\n@CacheEvict(value = \"userCache\",key = \"#p0\")  //#p0 代表第一个参数\n//@CacheEvict(value = \"userCache\",key = \"#root.args[0]\") //#root.args[0] 代表第一个参数\n//@CacheEvict(value = \"userCache\",key = \"#id\") //#id 代表变量名为id的参数\n@DeleteMapping(\"/{id}\")\npublic void delete(@PathVariable Long id){\n    userService.removeById(id);\n}\n\n\n\n//@CacheEvict(value = \"userCache\",key = \"#p0.id\")   //第一个参数的id属性\n//@CacheEvict(value = \"userCache\",key = \"#user.id\") //参数名为user参数的id属性\n//@CacheEvict(value = \"userCache\",key = \"#root.args[0].id\") //第一个参数的id属性\n@CacheEvict(value = \"userCache\",key = \"#result.id\")         //返回值的id属性\n@PutMapping\npublic User update(User user){\n    userService.updateById(user);\n    return user;\n}\n```\n\n####  **@Cacheable注解**\n\n[@Cacheable ]() 说明: \n\n​\t作用: 在方法执行前，spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中\n\n​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key\n\n​\tkey: 缓存的key  ----------> 支持Spring的表达式语言SPEL语法\n\n```Java\n/**\n* Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中\n* value：缓存的名称，每个缓存名称下面可以有多个key\n* key：缓存的key\n*/\n@Cacheable(value = \"userCache\",key = \"#id\")\n@GetMapping(\"/{id}\")\npublic User getById(@PathVariable Long id){\n    User user = userService.getById(id);\n    return user;\n}\n```\n\n在@Cacheable注解中，提供了两个属性分别为： condition， unless 。\n\ncondition : 表示满足什么条件, 再进行缓存 ;\n\nunless : 表示满足条件则不缓存 ; 与上述的condition是反向的 ;\n\n```Java\n/**\n * Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中\n * value：缓存的名称，每个缓存名称下面可以有多个key\n * key：缓存的key\n * condition：条件，满足条件时才缓存数据\n * unless：满足条件则不缓存\n */\n@Cacheable(value = \"userCache\",key = \"#id\", unless = \"#result == null\")\n@GetMapping(\"/{id}\")\npublic User getById(@PathVariable Long id){\n    User user = userService.getById(id);\n    return user;\n}\n```\n\n**在list方法上加注解**[**@Cacheable** ]() \n\n在list方法中进行查询时，有两个查询条件，如果传递了id，根据id查询； 如果传递了name， 根据name查询，那么我们缓存的key在设计的时候，就需要既包含id，又包含name。 具体的代码实现如下：\n\n```Java\n@Cacheable(value = \"userCache\",key = \"#user.id + '_' + #user.name\")\n@GetMapping(\"/list\")\npublic List<User> list(User user){\n    LambdaQueryWrapper<User> queryWrapper = new LambdaQueryWrapper<>();\n    queryWrapper.eq(user.getId() != null,User::getId,user.getId());\n    queryWrapper.eq(user.getName() != null,User::getName,user.getName());\n    List<User> list = userService.list(queryWrapper);\n    return list;\n}\n```\n\n","source":"_posts/SpringCache框架的使用.md","raw":"---\ntitle: SpringCache框架的使用\ndate: 2024-08-08 10:27:30\ntags:\n- redis\ncategories:\n- Java\n---\n\n# SpringCache框架的使用\n\n## 1、注解\n\n| **注解**            | **说明**                                                     |\n| ------------------- | ------------------------------------------------------------ |\n| [@EnableCaching ]() | 开启缓存注解功能                                             |\n| [@Cacheable ]()     | 在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中 |\n| [@CachePut ]()      | 将方法的返回值放到缓存中                                     |\n| [@CacheEvict ]()    | 将一条或多条数据从缓存中删除                                 |\n\n## 2、导入坐标\n\n使用Redis作为缓存技术，只需要导入Spring data Redis的maven坐标即可\n\n```Java\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-cache</artifactId>\n</dependency>\n\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n```\n\napplication.yml\n\n```Java\nspring:\n  redis:\n    host: 192.168.200.200\n    port: 6379\n    password: root@123456\n    database: 0\n  cache:\n    redis:\n      time-to-live: 1800000   #设置缓存过期时间，可选\n```\n\n## 3、注解应用\n\n#### **@CachePut注解**\n\n[@CachePut ]() 说明： \n\n​\t作用: 将方法返回值，放入缓存\n\n​\tvalue: 缓存的名称, 每个缓存名称下面可以有很多key\n\n​\tkey: 缓存的key  ----------> 支持Spring的表达式语言SPEL语法\n\n```Java\n/**\n* CachePut：将方法返回值放入缓存\n* value：缓存的名称，每个缓存名称下面可以有多个key\n* key：缓存的key\n*/\n@CachePut(value = \"userCache\", key = \"#user.id\")\n@PostMapping\npublic User save(User user){\n    userService.save(user);\n    return user;\n}\n```\n\nkey的写法如下：\n\n​\t#user.id : #user指的是方法形参的名称, id指的是user的id属性 , 也就是使用user的id属性作为key ;\n\n​\t#user.name: #user指的是方法形参的名称, name指的是user的name属性 ,也就是使用user的name属性作为key ;\n\n​\t#result.id : #result代表方法返回值，该表达式 代表以返回对象的id属性作为key ；\n\n​\t#result.name : #result代表方法返回值，该表达式 代表以返回对象的name属性作为key ；\n\n\n\n#### **@CacheEvict注解**\n\n[@CacheEvict ]() 说明： \n\n​\t作用: 清理指定缓存\n\n​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key\n\n​\tkey: 缓存的key  ----------> 支持Spring的表达式语言SPEL语法\n\n```java\n/**\n* CacheEvict：清理指定缓存\n* value：缓存的名称，每个缓存名称下面可以有多个key\n* key：缓存的key\n*/\n@CacheEvict(value = \"userCache\",key = \"#p0\")  //#p0 代表第一个参数\n//@CacheEvict(value = \"userCache\",key = \"#root.args[0]\") //#root.args[0] 代表第一个参数\n//@CacheEvict(value = \"userCache\",key = \"#id\") //#id 代表变量名为id的参数\n@DeleteMapping(\"/{id}\")\npublic void delete(@PathVariable Long id){\n    userService.removeById(id);\n}\n\n\n\n//@CacheEvict(value = \"userCache\",key = \"#p0.id\")   //第一个参数的id属性\n//@CacheEvict(value = \"userCache\",key = \"#user.id\") //参数名为user参数的id属性\n//@CacheEvict(value = \"userCache\",key = \"#root.args[0].id\") //第一个参数的id属性\n@CacheEvict(value = \"userCache\",key = \"#result.id\")         //返回值的id属性\n@PutMapping\npublic User update(User user){\n    userService.updateById(user);\n    return user;\n}\n```\n\n####  **@Cacheable注解**\n\n[@Cacheable ]() 说明: \n\n​\t作用: 在方法执行前，spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中\n\n​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key\n\n​\tkey: 缓存的key  ----------> 支持Spring的表达式语言SPEL语法\n\n```Java\n/**\n* Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中\n* value：缓存的名称，每个缓存名称下面可以有多个key\n* key：缓存的key\n*/\n@Cacheable(value = \"userCache\",key = \"#id\")\n@GetMapping(\"/{id}\")\npublic User getById(@PathVariable Long id){\n    User user = userService.getById(id);\n    return user;\n}\n```\n\n在@Cacheable注解中，提供了两个属性分别为： condition， unless 。\n\ncondition : 表示满足什么条件, 再进行缓存 ;\n\nunless : 表示满足条件则不缓存 ; 与上述的condition是反向的 ;\n\n```Java\n/**\n * Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中\n * value：缓存的名称，每个缓存名称下面可以有多个key\n * key：缓存的key\n * condition：条件，满足条件时才缓存数据\n * unless：满足条件则不缓存\n */\n@Cacheable(value = \"userCache\",key = \"#id\", unless = \"#result == null\")\n@GetMapping(\"/{id}\")\npublic User getById(@PathVariable Long id){\n    User user = userService.getById(id);\n    return user;\n}\n```\n\n**在list方法上加注解**[**@Cacheable** ]() \n\n在list方法中进行查询时，有两个查询条件，如果传递了id，根据id查询； 如果传递了name， 根据name查询，那么我们缓存的key在设计的时候，就需要既包含id，又包含name。 具体的代码实现如下：\n\n```Java\n@Cacheable(value = \"userCache\",key = \"#user.id + '_' + #user.name\")\n@GetMapping(\"/list\")\npublic List<User> list(User user){\n    LambdaQueryWrapper<User> queryWrapper = new LambdaQueryWrapper<>();\n    queryWrapper.eq(user.getId() != null,User::getId,user.getId());\n    queryWrapper.eq(user.getName() != null,User::getName,user.getName());\n    List<User> list = userService.list(queryWrapper);\n    return list;\n}\n```\n\n","slug":"SpringCache框架的使用","published":1,"updated":"2025-11-04T03:35:32.336Z","_id":"cme2819ck00009wam7kw0hmou","comments":1,"layout":"post","photos":[],"content":"<h1 id=\"SpringCache框架的使用\"><a href=\"#SpringCache框架的使用\" class=\"headerlink\" title=\"SpringCache框架的使用\"></a>SpringCache框架的使用</h1><h2 id=\"1、注解\"><a href=\"#1、注解\" class=\"headerlink\" title=\"1、注解\"></a>1、注解</h2><table>\n<thead>\n<tr>\n<th><strong>注解</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"\">@EnableCaching </a></td>\n<td>开启缓存注解功能</td>\n</tr>\n<tr>\n<td><a href=\"\">@Cacheable </a></td>\n<td>在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</td>\n</tr>\n<tr>\n<td><a href=\"\">@CachePut </a></td>\n<td>将方法的返回值放到缓存中</td>\n</tr>\n<tr>\n<td><a href=\"\">@CacheEvict </a></td>\n<td>将一条或多条数据从缓存中删除</td>\n</tr>\n</tbody></table>\n<h2 id=\"2、导入坐标\"><a href=\"#2、导入坐标\" class=\"headerlink\" title=\"2、导入坐标\"></a>2、导入坐标</h2><p>使用Redis作为缓存技术，只需要导入Spring data Redis的maven坐标即可</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<p>application.yml</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    host: <span class=\"number\">192.168</span><span class=\"number\">.200</span><span class=\"number\">.200</span></span><br><span class=\"line\">    port: <span class=\"number\">6379</span></span><br><span class=\"line\">    password: root@<span class=\"number\">123456</span></span><br><span class=\"line\">    database: <span class=\"number\">0</span></span><br><span class=\"line\">  cache:</span><br><span class=\"line\">    redis:</span><br><span class=\"line\">      time-to-live: <span class=\"number\">1800000</span>   #设置缓存过期时间，可选</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、注解应用\"><a href=\"#3、注解应用\" class=\"headerlink\" title=\"3、注解应用\"></a>3、注解应用</h2><h4 id=\"CachePut注解\"><a href=\"#CachePut注解\" class=\"headerlink\" title=\"@CachePut注解\"></a><strong>@CachePut注解</strong></h4><p><a href=\"\">@CachePut </a> 说明： </p>\n<p>​\t作用: 将方法返回值，放入缓存</p>\n<p>​\tvalue: 缓存的名称, 每个缓存名称下面可以有很多key</p>\n<p>​\tkey: 缓存的key  ———-&gt; 支持Spring的表达式语言SPEL语法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* CachePut：将方法返回值放入缓存</span></span><br><span class=\"line\"><span class=\"comment\">* value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\">* key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@CachePut(value = &quot;userCache&quot;, key = &quot;#user.id&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@PostMapping</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">save</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">    userService.save(user);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>key的写法如下：</p>\n<p>​\t#user.id : #user指的是方法形参的名称, id指的是user的id属性 , 也就是使用user的id属性作为key ;</p>\n<p>​\t#user.name: #user指的是方法形参的名称, name指的是user的name属性 ,也就是使用user的name属性作为key ;</p>\n<p>​\t#result.id : #result代表方法返回值，该表达式 代表以返回对象的id属性作为key ；</p>\n<p>​\t#result.name : #result代表方法返回值，该表达式 代表以返回对象的name属性作为key ；</p>\n<h4 id=\"CacheEvict注解\"><a href=\"#CacheEvict注解\" class=\"headerlink\" title=\"@CacheEvict注解\"></a><strong>@CacheEvict注解</strong></h4><p><a href=\"\">@CacheEvict </a> 说明： </p>\n<p>​\t作用: 清理指定缓存</p>\n<p>​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key</p>\n<p>​\tkey: 缓存的key  ———-&gt; 支持Spring的表达式语言SPEL语法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* CacheEvict：清理指定缓存</span></span><br><span class=\"line\"><span class=\"comment\">* value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\">* key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@CacheEvict(value = &quot;userCache&quot;,key = &quot;#p0&quot;)</span>  <span class=\"comment\">//#p0 代表第一个参数</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#root.args[0]&quot;) //#root.args[0] 代表第一个参数</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#id&quot;) //#id 代表变量名为id的参数</span></span><br><span class=\"line\"><span class=\"meta\">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">delete</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Long id)</span>&#123;</span><br><span class=\"line\">    userService.removeById(id);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#p0.id&quot;)   //第一个参数的id属性</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#user.id&quot;) //参数名为user参数的id属性</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#root.args[0].id&quot;) //第一个参数的id属性</span></span><br><span class=\"line\"><span class=\"meta\">@CacheEvict(value = &quot;userCache&quot;,key = &quot;#result.id&quot;)</span>         <span class=\"comment\">//返回值的id属性</span></span><br><span class=\"line\"><span class=\"meta\">@PutMapping</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">update</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">    userService.updateById(user);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Cacheable注解\"><a href=\"#Cacheable注解\" class=\"headerlink\" title=\"@Cacheable注解\"></a><strong>@Cacheable注解</strong></h4><p><a href=\"\">@Cacheable </a> 说明: </p>\n<p>​\t作用: 在方法执行前，spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</p>\n<p>​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key</p>\n<p>​\tkey: 缓存的key  ———-&gt; 支持Spring的表达式语言SPEL语法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</span></span><br><span class=\"line\"><span class=\"comment\">* value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\">* key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@Cacheable(value = &quot;userCache&quot;,key = &quot;#id&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">getById</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Long id)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> userService.getById(id);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>在@Cacheable注解中，提供了两个属性分别为： condition， unless 。</p>\n<p>condition : 表示满足什么条件, 再进行缓存 ;</p>\n<p>unless : 表示满足条件则不缓存 ; 与上述的condition是反向的 ;</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</span></span><br><span class=\"line\"><span class=\"comment\"> * value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\"> * key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\"> * condition：条件，满足条件时才缓存数据</span></span><br><span class=\"line\"><span class=\"comment\"> * unless：满足条件则不缓存</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Cacheable(value = &quot;userCache&quot;,key = &quot;#id&quot;, unless = &quot;#result == null&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">getById</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Long id)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> userService.getById(id);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>在list方法上加注解</strong><a href=\"\"><strong>@Cacheable</strong> </a> </p>\n<p>在list方法中进行查询时，有两个查询条件，如果传递了id，根据id查询； 如果传递了name， 根据name查询，那么我们缓存的key在设计的时候，就需要既包含id，又包含name。 具体的代码实现如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable(value = &quot;userCache&quot;,key = &quot;#user.id + &#x27;_&#x27; + #user.name&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;/list&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">list</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">    LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class=\"keyword\">new</span> <span class=\"title class_\">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class=\"line\">    queryWrapper.eq(user.getId() != <span class=\"literal\">null</span>,User::getId,user.getId());</span><br><span class=\"line\">    queryWrapper.eq(user.getName() != <span class=\"literal\">null</span>,User::getName,user.getName());</span><br><span class=\"line\">    List&lt;User&gt; list = userService.list(queryWrapper);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","excerpt":"","more":"<h1 id=\"SpringCache框架的使用\"><a href=\"#SpringCache框架的使用\" class=\"headerlink\" title=\"SpringCache框架的使用\"></a>SpringCache框架的使用</h1><h2 id=\"1、注解\"><a href=\"#1、注解\" class=\"headerlink\" title=\"1、注解\"></a>1、注解</h2><table>\n<thead>\n<tr>\n<th><strong>注解</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td><a href=\"\">@EnableCaching </a></td>\n<td>开启缓存注解功能</td>\n</tr>\n<tr>\n<td><a href=\"\">@Cacheable </a></td>\n<td>在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</td>\n</tr>\n<tr>\n<td><a href=\"\">@CachePut </a></td>\n<td>将方法的返回值放到缓存中</td>\n</tr>\n<tr>\n<td><a href=\"\">@CacheEvict </a></td>\n<td>将一条或多条数据从缓存中删除</td>\n</tr>\n</tbody></table>\n<h2 id=\"2、导入坐标\"><a href=\"#2、导入坐标\" class=\"headerlink\" title=\"2、导入坐标\"></a>2、导入坐标</h2><p>使用Redis作为缓存技术，只需要导入Spring data Redis的maven坐标即可</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<p>application.yml</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    host: <span class=\"number\">192.168</span><span class=\"number\">.200</span><span class=\"number\">.200</span></span><br><span class=\"line\">    port: <span class=\"number\">6379</span></span><br><span class=\"line\">    password: root@<span class=\"number\">123456</span></span><br><span class=\"line\">    database: <span class=\"number\">0</span></span><br><span class=\"line\">  cache:</span><br><span class=\"line\">    redis:</span><br><span class=\"line\">      time-to-live: <span class=\"number\">1800000</span>   #设置缓存过期时间，可选</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、注解应用\"><a href=\"#3、注解应用\" class=\"headerlink\" title=\"3、注解应用\"></a>3、注解应用</h2><h4 id=\"CachePut注解\"><a href=\"#CachePut注解\" class=\"headerlink\" title=\"@CachePut注解\"></a><strong>@CachePut注解</strong></h4><p><a href=\"\">@CachePut </a> 说明： </p>\n<p>​\t作用: 将方法返回值，放入缓存</p>\n<p>​\tvalue: 缓存的名称, 每个缓存名称下面可以有很多key</p>\n<p>​\tkey: 缓存的key  ———-&gt; 支持Spring的表达式语言SPEL语法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* CachePut：将方法返回值放入缓存</span></span><br><span class=\"line\"><span class=\"comment\">* value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\">* key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@CachePut(value = &quot;userCache&quot;, key = &quot;#user.id&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@PostMapping</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">save</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">    userService.save(user);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>key的写法如下：</p>\n<p>​\t#user.id : #user指的是方法形参的名称, id指的是user的id属性 , 也就是使用user的id属性作为key ;</p>\n<p>​\t#user.name: #user指的是方法形参的名称, name指的是user的name属性 ,也就是使用user的name属性作为key ;</p>\n<p>​\t#result.id : #result代表方法返回值，该表达式 代表以返回对象的id属性作为key ；</p>\n<p>​\t#result.name : #result代表方法返回值，该表达式 代表以返回对象的name属性作为key ；</p>\n<h4 id=\"CacheEvict注解\"><a href=\"#CacheEvict注解\" class=\"headerlink\" title=\"@CacheEvict注解\"></a><strong>@CacheEvict注解</strong></h4><p><a href=\"\">@CacheEvict </a> 说明： </p>\n<p>​\t作用: 清理指定缓存</p>\n<p>​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key</p>\n<p>​\tkey: 缓存的key  ———-&gt; 支持Spring的表达式语言SPEL语法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* CacheEvict：清理指定缓存</span></span><br><span class=\"line\"><span class=\"comment\">* value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\">* key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@CacheEvict(value = &quot;userCache&quot;,key = &quot;#p0&quot;)</span>  <span class=\"comment\">//#p0 代表第一个参数</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#root.args[0]&quot;) //#root.args[0] 代表第一个参数</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#id&quot;) //#id 代表变量名为id的参数</span></span><br><span class=\"line\"><span class=\"meta\">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">delete</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Long id)</span>&#123;</span><br><span class=\"line\">    userService.removeById(id);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#p0.id&quot;)   //第一个参数的id属性</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#user.id&quot;) //参数名为user参数的id属性</span></span><br><span class=\"line\"><span class=\"comment\">//@CacheEvict(value = &quot;userCache&quot;,key = &quot;#root.args[0].id&quot;) //第一个参数的id属性</span></span><br><span class=\"line\"><span class=\"meta\">@CacheEvict(value = &quot;userCache&quot;,key = &quot;#result.id&quot;)</span>         <span class=\"comment\">//返回值的id属性</span></span><br><span class=\"line\"><span class=\"meta\">@PutMapping</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">update</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">    userService.updateById(user);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Cacheable注解\"><a href=\"#Cacheable注解\" class=\"headerlink\" title=\"@Cacheable注解\"></a><strong>@Cacheable注解</strong></h4><p><a href=\"\">@Cacheable </a> 说明: </p>\n<p>​\t作用: 在方法执行前，spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</p>\n<p>​\tvalue: 缓存的名称，每个缓存名称下面可以有多个key</p>\n<p>​\tkey: 缓存的key  ———-&gt; 支持Spring的表达式语言SPEL语法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</span></span><br><span class=\"line\"><span class=\"comment\">* value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\">* key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@Cacheable(value = &quot;userCache&quot;,key = &quot;#id&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">getById</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Long id)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> userService.getById(id);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>在@Cacheable注解中，提供了两个属性分别为： condition， unless 。</p>\n<p>condition : 表示满足什么条件, 再进行缓存 ;</p>\n<p>unless : 表示满足条件则不缓存 ; 与上述的condition是反向的 ;</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Cacheable：在方法执行前spring先查看缓存中是否有数据，如果有数据，则直接返回缓存数据；若没有数据，调用方法并将方法返回值放到缓存中</span></span><br><span class=\"line\"><span class=\"comment\"> * value：缓存的名称，每个缓存名称下面可以有多个key</span></span><br><span class=\"line\"><span class=\"comment\"> * key：缓存的key</span></span><br><span class=\"line\"><span class=\"comment\"> * condition：条件，满足条件时才缓存数据</span></span><br><span class=\"line\"><span class=\"comment\"> * unless：满足条件则不缓存</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Cacheable(value = &quot;userCache&quot;,key = &quot;#id&quot;, unless = &quot;#result == null&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">getById</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Long id)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> userService.getById(id);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>在list方法上加注解</strong><a href=\"\"><strong>@Cacheable</strong> </a> </p>\n<p>在list方法中进行查询时，有两个查询条件，如果传递了id，根据id查询； 如果传递了name， 根据name查询，那么我们缓存的key在设计的时候，就需要既包含id，又包含name。 具体的代码实现如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable(value = &quot;userCache&quot;,key = &quot;#user.id + &#x27;_&#x27; + #user.name&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;/list&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">list</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">    LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class=\"keyword\">new</span> <span class=\"title class_\">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class=\"line\">    queryWrapper.eq(user.getId() != <span class=\"literal\">null</span>,User::getId,user.getId());</span><br><span class=\"line\">    queryWrapper.eq(user.getName() != <span class=\"literal\">null</span>,User::getName,user.getName());</span><br><span class=\"line\">    List&lt;User&gt; list = userService.list(queryWrapper);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","popularPost_tmp_postPath":true,"eyeCatchImage":null,"popularPost_tmp_gaData":{"updated":"Tue Nov 04 2025 11:35:32 GMT+0800 (中国标准时间)","title":"SpringCache框架的使用","path":"2024/08/08/SpringCache框架的使用/","eyeCatchImage":null,"excerpt":null,"date":{"_isAMomentObject":true,"_i":"2024-08-08T02:27:30.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2024-08-08T02:27:30.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"Java","tags":["redis"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"MySQL主从复制+读写分离","date":"2024-08-13T02:34:26.000Z","_content":"\n# 1、**MySQL主从复制**\n\nMySQL主从复制是一个异步的复制过程，底层是基于Mysql数据库自带的 **二进制日志** 功能。就是一台或多台MySQL数据库（slave，即**从库**）从另一台MySQL数据库（master，即**主库**）进行日志的复制，然后再解析日志并应用到自身，最终实现 **从库** 的数据和 **主库** 的数据保持一致。MySQL主从复制是MySQL数据库自带功能，无需借助第三方工具。\n\n二进制日志（BINLOG）记录了所有的 DDL（数据定义语言）语句和 DML（数据操纵语言）语句，但是不包括数据查询语句。此日志对于灾难时的数据恢复起着极其重要的作用，MySQL的主从复制， 就是通过该binlog实现的。默认MySQL是未开启该日志的。\n\n**MySQL的主从复制原理如下：**\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_14-44-15.jpg)\n\n**MySQL复制过程分成三步：**\n\n1). MySQL master 将数据变更写入二进制日志( binary log)\n\n2). slave将master的binary log拷贝到它的中继日志（relay log）\n\n3). slave重做中继日志中的事件，将数据变更反映它自己的数据\n\n\n\n## 1、**主库配置**\n\n**1、MySQL 默认加载 my.cnf**\n\n```\n[mysqld]\nlog-bin=mysql-bin   #[必须]启用二进制日志\nserver-id=128      #[必须]服务器唯一ID(唯一即可)\nexpire_logs_days=7\nmax_binlog_size=100M\n...\n```\n\n```java\ndocker run --privileged -d -p 3306:3306 \\\n  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\\n  -v /data/dockerData/mysql/logs:/logs \\\n  -v /data/dockerData/mysql/data:/var/lib/mysql \\\n  -e MYSQL_ROOT_PASSWORD=1234 \\\n  --name mysql5.7 \\\n  mysql:5.7 \\\n  --log-bin=/var/lib/mysql/mysql-bin  # 强制启用binlog（确保生效）\n```\n\n2、**验证**\n\n```\n# 进入容器\ndocker exec -it mysql5.7 mysql -uroot -p1234\n# 查看binlog是否启用\nshow variables like 'log_bin';\n# 查看主库状态\nshow master status;\n```\n\n**3、创建数据同步的用户并授权**\n\n```\nGRANT REPLICATION SLAVE ON *.* to 'xiaoming'@'%' identified by 'Root@251314';\n```\n\n注：上面SQL的作用是创建一个用户 xiaoming ，密码为 Root@123456  ，并且给xiaoming用户授予REPLICATION SLAVE权限。常用于建立复制时所需要用到的用户权限，也就是slave必须被master授权具有该权限的用户，才能通过该用户复制。 \n\n**4、登录Mysql数据库，查看master同步状态**\n\n执行下面SQL，记录下结果中**File**和**Position**的值\n\n```\nshow master status;\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072416433.jpg)\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072451506.jpg)\n\n注：上面SQL的作用是查看Master的状态，执行完此SQL后不要再执行任何操作\n\n## 2、**从库配置**\n\n**修改Mysql数据库的配置文件/etc/my.cnf**\n\n```\nserver-id=201 \t#[必须]服务器唯一ID\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072533392.jpg)\n\n```\ndocker run --privileged -d -p 3306:3306 \\\n  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\\n  -v /data/dockerData/mysql/logs:/logs \\\n  -v /data/dockerData/mysql/data:/var/lib/mysql \\\n  -e MYSQL_ROOT_PASSWORD=1234 \\\n  --name mysql5.7 \\\n  mysql:5.7\n```\n\n**登录Mysql数据库，设置主库地址及同步位置**\n\n```\n# 进入容器\ndocker exec -it mysql5.7 mysql -uroot -p1234\n\nstop slave;\n\nchange master to master_host='192.168.60.128',master_user='xiaoming',master_password='Root@251314',master_log_file='mysql-bin.000002',master_log_pos=154;\n\nstart slave;\n```\n\n参数说明：\n\n​\tA. master_host : 主库的IP地址\n\n​\tB. master_user : 访问主库进行主从复制的用户名(上面在主库创建的)\n\n​\tC. master_password : 访问主库进行主从复制的用户名对应的密码\n\n​\tD. master_log_file : 从哪个日志文件开始同步(上述查询master状态中展示的有)\n\n​\tE. master_log_pos : 从指定日志文件的哪个位置开始同步(上述查询master状态中展示的有)\n\n**查看从数据库的状态**\n\n```\nshow slave status\\G\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_16-12-02.jpg)\n\nMySQL命令行技巧：\n\n​\t\\G : 在MySQL的sql语句后加上\\G，表示将查询结果进行按列打印，可以使每个字段打印到单独的行。即将查到的结构旋转90度变成纵向；\n\n# 2、**读写分离案例**\n\n对日益增加的系统访问量，数据库的吞吐量面临着巨大瓶颈。 对于同一时刻有大量并发读操作和较少写操作类型的应用系统来说，将数据库拆分为**主库**和**从库**，主库负责处理事务性的增删改操作，从库负责处理查询操作，能够有效的避免由数据更新导致的行锁，使得整个系统的查询性能得到极大的改善。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072836452.jpg)\n\nSharding-JDBC定位为轻量级Java框架，在Java的JDBC层提供的额外服务。 它使用客户端直连数据库，以jar包形式提供服务，无需额外部署和依赖，可理解为增强版的JDBC驱动，完全兼容JDBC和各种ORM框架。\n\n使用Sharding-JDBC可以在程序中轻松的实现数据库读写分离。\n\n用法：\n\n1、在pom.xml中增加shardingJdbc的maven坐标\n\n```\n<dependency>\n    <groupId>org.apache.shardingsphere</groupId>\n    <artifactId>sharding-jdbc-spring-boot-starter</artifactId>\n    <version>4.0.0-RC1</version>\n</dependency>\n```\n\n2、在application.yml中增加数据源的配置\n\n```\nspring:\n  shardingsphere:\n    datasource:\n      names:\n        master,slave\n      # 主数据源\n      master:\n        type: com.alibaba.druid.pool.DruidDataSource\n        driver-class-name: com.mysql.cj.jdbc.Driver\n        url: jdbc:mysql://192.168.138.100:3306/rw?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowPublicKeyRetrieval=true\n        username: root\n        password: root\n      # 从数据源\n      slave:\n        type: com.alibaba.druid.pool.DruidDataSource\n        driver-class-name: com.mysql.cj.jdbc.Driver\n        url: jdbc:mysql://192.168.138.101:3306/rw?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowPublicKeyRetrieval=true\n        username: root\n        password: root\n    masterslave:\n      # 读写分离配置\n      load-balance-algorithm-type: round_robin #轮询\n      # 最终的数据源名称\n      name: dataSource\n      # 主库数据源名称\n      master-data-source-name: master\n      # 从库数据源名称列表，多个逗号分隔\n      slave-data-source-names: slave\n    props:\n      sql:\n        show: true #开启SQL显示，默认false\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072960206.jpg)\n","source":"_posts/MySQL主从复制+读写分离.md","raw":"---\ntitle: MySQL主从复制+读写分离\ndate: 2024-08-13 10:34:26\ntags:\n- MySQL\ncategories:\n- MySQL\n---\n\n# 1、**MySQL主从复制**\n\nMySQL主从复制是一个异步的复制过程，底层是基于Mysql数据库自带的 **二进制日志** 功能。就是一台或多台MySQL数据库（slave，即**从库**）从另一台MySQL数据库（master，即**主库**）进行日志的复制，然后再解析日志并应用到自身，最终实现 **从库** 的数据和 **主库** 的数据保持一致。MySQL主从复制是MySQL数据库自带功能，无需借助第三方工具。\n\n二进制日志（BINLOG）记录了所有的 DDL（数据定义语言）语句和 DML（数据操纵语言）语句，但是不包括数据查询语句。此日志对于灾难时的数据恢复起着极其重要的作用，MySQL的主从复制， 就是通过该binlog实现的。默认MySQL是未开启该日志的。\n\n**MySQL的主从复制原理如下：**\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_14-44-15.jpg)\n\n**MySQL复制过程分成三步：**\n\n1). MySQL master 将数据变更写入二进制日志( binary log)\n\n2). slave将master的binary log拷贝到它的中继日志（relay log）\n\n3). slave重做中继日志中的事件，将数据变更反映它自己的数据\n\n\n\n## 1、**主库配置**\n\n**1、MySQL 默认加载 my.cnf**\n\n```\n[mysqld]\nlog-bin=mysql-bin   #[必须]启用二进制日志\nserver-id=128      #[必须]服务器唯一ID(唯一即可)\nexpire_logs_days=7\nmax_binlog_size=100M\n...\n```\n\n```java\ndocker run --privileged -d -p 3306:3306 \\\n  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\\n  -v /data/dockerData/mysql/logs:/logs \\\n  -v /data/dockerData/mysql/data:/var/lib/mysql \\\n  -e MYSQL_ROOT_PASSWORD=1234 \\\n  --name mysql5.7 \\\n  mysql:5.7 \\\n  --log-bin=/var/lib/mysql/mysql-bin  # 强制启用binlog（确保生效）\n```\n\n2、**验证**\n\n```\n# 进入容器\ndocker exec -it mysql5.7 mysql -uroot -p1234\n# 查看binlog是否启用\nshow variables like 'log_bin';\n# 查看主库状态\nshow master status;\n```\n\n**3、创建数据同步的用户并授权**\n\n```\nGRANT REPLICATION SLAVE ON *.* to 'xiaoming'@'%' identified by 'Root@251314';\n```\n\n注：上面SQL的作用是创建一个用户 xiaoming ，密码为 Root@123456  ，并且给xiaoming用户授予REPLICATION SLAVE权限。常用于建立复制时所需要用到的用户权限，也就是slave必须被master授权具有该权限的用户，才能通过该用户复制。 \n\n**4、登录Mysql数据库，查看master同步状态**\n\n执行下面SQL，记录下结果中**File**和**Position**的值\n\n```\nshow master status;\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072416433.jpg)\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072451506.jpg)\n\n注：上面SQL的作用是查看Master的状态，执行完此SQL后不要再执行任何操作\n\n## 2、**从库配置**\n\n**修改Mysql数据库的配置文件/etc/my.cnf**\n\n```\nserver-id=201 \t#[必须]服务器唯一ID\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072533392.jpg)\n\n```\ndocker run --privileged -d -p 3306:3306 \\\n  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\\n  -v /data/dockerData/mysql/logs:/logs \\\n  -v /data/dockerData/mysql/data:/var/lib/mysql \\\n  -e MYSQL_ROOT_PASSWORD=1234 \\\n  --name mysql5.7 \\\n  mysql:5.7\n```\n\n**登录Mysql数据库，设置主库地址及同步位置**\n\n```\n# 进入容器\ndocker exec -it mysql5.7 mysql -uroot -p1234\n\nstop slave;\n\nchange master to master_host='192.168.60.128',master_user='xiaoming',master_password='Root@251314',master_log_file='mysql-bin.000002',master_log_pos=154;\n\nstart slave;\n```\n\n参数说明：\n\n​\tA. master_host : 主库的IP地址\n\n​\tB. master_user : 访问主库进行主从复制的用户名(上面在主库创建的)\n\n​\tC. master_password : 访问主库进行主从复制的用户名对应的密码\n\n​\tD. master_log_file : 从哪个日志文件开始同步(上述查询master状态中展示的有)\n\n​\tE. master_log_pos : 从指定日志文件的哪个位置开始同步(上述查询master状态中展示的有)\n\n**查看从数据库的状态**\n\n```\nshow slave status\\G\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_16-12-02.jpg)\n\nMySQL命令行技巧：\n\n​\t\\G : 在MySQL的sql语句后加上\\G，表示将查询结果进行按列打印，可以使每个字段打印到单独的行。即将查到的结构旋转90度变成纵向；\n\n# 2、**读写分离案例**\n\n对日益增加的系统访问量，数据库的吞吐量面临着巨大瓶颈。 对于同一时刻有大量并发读操作和较少写操作类型的应用系统来说，将数据库拆分为**主库**和**从库**，主库负责处理事务性的增删改操作，从库负责处理查询操作，能够有效的避免由数据更新导致的行锁，使得整个系统的查询性能得到极大的改善。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072836452.jpg)\n\nSharding-JDBC定位为轻量级Java框架，在Java的JDBC层提供的额外服务。 它使用客户端直连数据库，以jar包形式提供服务，无需额外部署和依赖，可理解为增强版的JDBC驱动，完全兼容JDBC和各种ORM框架。\n\n使用Sharding-JDBC可以在程序中轻松的实现数据库读写分离。\n\n用法：\n\n1、在pom.xml中增加shardingJdbc的maven坐标\n\n```\n<dependency>\n    <groupId>org.apache.shardingsphere</groupId>\n    <artifactId>sharding-jdbc-spring-boot-starter</artifactId>\n    <version>4.0.0-RC1</version>\n</dependency>\n```\n\n2、在application.yml中增加数据源的配置\n\n```\nspring:\n  shardingsphere:\n    datasource:\n      names:\n        master,slave\n      # 主数据源\n      master:\n        type: com.alibaba.druid.pool.DruidDataSource\n        driver-class-name: com.mysql.cj.jdbc.Driver\n        url: jdbc:mysql://192.168.138.100:3306/rw?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowPublicKeyRetrieval=true\n        username: root\n        password: root\n      # 从数据源\n      slave:\n        type: com.alibaba.druid.pool.DruidDataSource\n        driver-class-name: com.mysql.cj.jdbc.Driver\n        url: jdbc:mysql://192.168.138.101:3306/rw?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowPublicKeyRetrieval=true\n        username: root\n        password: root\n    masterslave:\n      # 读写分离配置\n      load-balance-algorithm-type: round_robin #轮询\n      # 最终的数据源名称\n      name: dataSource\n      # 主库数据源名称\n      master-data-source-name: master\n      # 从库数据源名称列表，多个逗号分隔\n      slave-data-source-names: slave\n    props:\n      sql:\n        show: true #开启SQL显示，默认false\n```\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072960206.jpg)\n","slug":"MySQL主从复制+读写分离","published":1,"updated":"2025-11-05T02:13:30.696Z","_id":"cme9p6cfc0000xoamd92a6st8","comments":1,"layout":"post","photos":[],"content":"<h1 id=\"1、MySQL主从复制\"><a href=\"#1、MySQL主从复制\" class=\"headerlink\" title=\"1、MySQL主从复制\"></a>1、<strong>MySQL主从复制</strong></h1><p>MySQL主从复制是一个异步的复制过程，底层是基于Mysql数据库自带的 <strong>二进制日志</strong> 功能。就是一台或多台MySQL数据库（slave，即<strong>从库</strong>）从另一台MySQL数据库（master，即<strong>主库</strong>）进行日志的复制，然后再解析日志并应用到自身，最终实现 <strong>从库</strong> 的数据和 <strong>主库</strong> 的数据保持一致。MySQL主从复制是MySQL数据库自带功能，无需借助第三方工具。</p>\n<p>二进制日志（BINLOG）记录了所有的 DDL（数据定义语言）语句和 DML（数据操纵语言）语句，但是不包括数据查询语句。此日志对于灾难时的数据恢复起着极其重要的作用，MySQL的主从复制， 就是通过该binlog实现的。默认MySQL是未开启该日志的。</p>\n<p><strong>MySQL的主从复制原理如下：</strong></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_14-44-15.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_14-44-15.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p><strong>MySQL复制过程分成三步：</strong></p>\n<p>1). MySQL master 将数据变更写入二进制日志( binary log)</p>\n<p>2). slave将master的binary log拷贝到它的中继日志（relay log）</p>\n<p>3). slave重做中继日志中的事件，将数据变更反映它自己的数据</p>\n<h2 id=\"1、主库配置\"><a href=\"#1、主库配置\" class=\"headerlink\" title=\"1、主库配置\"></a>1、<strong>主库配置</strong></h2><p><strong>1、MySQL 默认加载 my.cnf</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mysqld]</span><br><span class=\"line\">log-bin=mysql-bin   #[必须]启用二进制日志</span><br><span class=\"line\">server-id=128      #[必须]服务器唯一ID(唯一即可)</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">max_binlog_size=100M</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --privileged -d -p <span class=\"number\">3306</span>:<span class=\"number\">3306</span> \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/logs:/logs \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/data:/<span class=\"keyword\">var</span>/lib/mysql \\</span><br><span class=\"line\">  -e MYSQL_ROOT_PASSWORD=<span class=\"number\">1234</span> \\</span><br><span class=\"line\">  --name mysql5<span class=\"number\">.7</span> \\</span><br><span class=\"line\">  mysql:<span class=\"number\">5.7</span> \\</span><br><span class=\"line\">  --log-bin=/<span class=\"keyword\">var</span>/lib/mysql/mysql-bin  # 强制启用binlog（确保生效）</span><br></pre></td></tr></table></figure>\n\n<p>2、<strong>验证</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入容器</span><br><span class=\"line\">docker exec -it mysql5.7 mysql -uroot -p1234</span><br><span class=\"line\"># 查看binlog是否启用</span><br><span class=\"line\">show variables like &#x27;log_bin&#x27;;</span><br><span class=\"line\"># 查看主库状态</span><br><span class=\"line\">show master status;</span><br></pre></td></tr></table></figure>\n\n<p><strong>3、创建数据同步的用户并授权</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT REPLICATION SLAVE ON *.* to &#x27;xiaoming&#x27;@&#x27;%&#x27; identified by &#x27;Root@251314&#x27;;</span><br></pre></td></tr></table></figure>\n\n<p>注：上面SQL的作用是创建一个用户 xiaoming ，密码为 Root@123456  ，并且给xiaoming用户授予REPLICATION SLAVE权限。常用于建立复制时所需要用到的用户权限，也就是slave必须被master授权具有该权限的用户，才能通过该用户复制。 </p>\n<p><strong>4、登录Mysql数据库，查看master同步状态</strong></p>\n<p>执行下面SQL，记录下结果中<strong>File</strong>和<strong>Position</strong>的值</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show master status;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072416433.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072416433.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072451506.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072451506.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>注：上面SQL的作用是查看Master的状态，执行完此SQL后不要再执行任何操作</p>\n<h2 id=\"2、从库配置\"><a href=\"#2、从库配置\" class=\"headerlink\" title=\"2、从库配置\"></a>2、<strong>从库配置</strong></h2><p><strong>修改Mysql数据库的配置文件&#x2F;etc&#x2F;my.cnf</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=201 \t#[必须]服务器唯一ID</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072533392.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072533392.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --privileged -d -p 3306:3306 \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/logs:/logs \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/data:/var/lib/mysql \\</span><br><span class=\"line\">  -e MYSQL_ROOT_PASSWORD=1234 \\</span><br><span class=\"line\">  --name mysql5.7 \\</span><br><span class=\"line\">  mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<p><strong>登录Mysql数据库，设置主库地址及同步位置</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入容器</span><br><span class=\"line\">docker exec -it mysql5.7 mysql -uroot -p1234</span><br><span class=\"line\"></span><br><span class=\"line\">stop slave;</span><br><span class=\"line\"></span><br><span class=\"line\">change master to master_host=&#x27;192.168.60.128&#x27;,master_user=&#x27;xiaoming&#x27;,master_password=&#x27;Root@251314&#x27;,master_log_file=&#x27;mysql-bin.000002&#x27;,master_log_pos=154;</span><br><span class=\"line\"></span><br><span class=\"line\">start slave;</span><br></pre></td></tr></table></figure>\n\n<p>参数说明：</p>\n<p>​\tA. master_host : 主库的IP地址</p>\n<p>​\tB. master_user : 访问主库进行主从复制的用户名(上面在主库创建的)</p>\n<p>​\tC. master_password : 访问主库进行主从复制的用户名对应的密码</p>\n<p>​\tD. master_log_file : 从哪个日志文件开始同步(上述查询master状态中展示的有)</p>\n<p>​\tE. master_log_pos : 从指定日志文件的哪个位置开始同步(上述查询master状态中展示的有)</p>\n<p><strong>查看从数据库的状态</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show slave status\\G</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_16-12-02.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_16-12-02.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>MySQL命令行技巧：</p>\n<p>​\t\\G : 在MySQL的sql语句后加上\\G，表示将查询结果进行按列打印，可以使每个字段打印到单独的行。即将查到的结构旋转90度变成纵向；</p>\n<h1 id=\"2、读写分离案例\"><a href=\"#2、读写分离案例\" class=\"headerlink\" title=\"2、读写分离案例\"></a>2、<strong>读写分离案例</strong></h1><p>对日益增加的系统访问量，数据库的吞吐量面临着巨大瓶颈。 对于同一时刻有大量并发读操作和较少写操作类型的应用系统来说，将数据库拆分为<strong>主库</strong>和<strong>从库</strong>，主库负责处理事务性的增删改操作，从库负责处理查询操作，能够有效的避免由数据更新导致的行锁，使得整个系统的查询性能得到极大的改善。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072836452.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072836452.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>Sharding-JDBC定位为轻量级Java框架，在Java的JDBC层提供的额外服务。 它使用客户端直连数据库，以jar包形式提供服务，无需额外部署和依赖，可理解为增强版的JDBC驱动，完全兼容JDBC和各种ORM框架。</p>\n<p>使用Sharding-JDBC可以在程序中轻松的实现数据库读写分离。</p>\n<p>用法：</p>\n<p>1、在pom.xml中增加shardingJdbc的maven坐标</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;sharding-jdbc-spring-boot-starter&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;4.0.0-RC1&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<p>2、在application.yml中增加数据源的配置</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  shardingsphere:</span><br><span class=\"line\">    datasource:</span><br><span class=\"line\">      names:</span><br><span class=\"line\">        master,slave</span><br><span class=\"line\">      # 主数据源</span><br><span class=\"line\">      master:</span><br><span class=\"line\">        type: com.alibaba.druid.pool.DruidDataSource</span><br><span class=\"line\">        driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">        url: jdbc:mysql://192.168.138.100:3306/rw?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false&amp;allowPublicKeyRetrieval=true</span><br><span class=\"line\">        username: root</span><br><span class=\"line\">        password: root</span><br><span class=\"line\">      # 从数据源</span><br><span class=\"line\">      slave:</span><br><span class=\"line\">        type: com.alibaba.druid.pool.DruidDataSource</span><br><span class=\"line\">        driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">        url: jdbc:mysql://192.168.138.101:3306/rw?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false&amp;allowPublicKeyRetrieval=true</span><br><span class=\"line\">        username: root</span><br><span class=\"line\">        password: root</span><br><span class=\"line\">    masterslave:</span><br><span class=\"line\">      # 读写分离配置</span><br><span class=\"line\">      load-balance-algorithm-type: round_robin #轮询</span><br><span class=\"line\">      # 最终的数据源名称</span><br><span class=\"line\">      name: dataSource</span><br><span class=\"line\">      # 主库数据源名称</span><br><span class=\"line\">      master-data-source-name: master</span><br><span class=\"line\">      # 从库数据源名称列表，多个逗号分隔</span><br><span class=\"line\">      slave-data-source-names: slave</span><br><span class=\"line\">    props:</span><br><span class=\"line\">      sql:</span><br><span class=\"line\">        show: true #开启SQL显示，默认false</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072960206.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072960206.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n","excerpt":"","more":"<h1 id=\"1、MySQL主从复制\"><a href=\"#1、MySQL主从复制\" class=\"headerlink\" title=\"1、MySQL主从复制\"></a>1、<strong>MySQL主从复制</strong></h1><p>MySQL主从复制是一个异步的复制过程，底层是基于Mysql数据库自带的 <strong>二进制日志</strong> 功能。就是一台或多台MySQL数据库（slave，即<strong>从库</strong>）从另一台MySQL数据库（master，即<strong>主库</strong>）进行日志的复制，然后再解析日志并应用到自身，最终实现 <strong>从库</strong> 的数据和 <strong>主库</strong> 的数据保持一致。MySQL主从复制是MySQL数据库自带功能，无需借助第三方工具。</p>\n<p>二进制日志（BINLOG）记录了所有的 DDL（数据定义语言）语句和 DML（数据操纵语言）语句，但是不包括数据查询语句。此日志对于灾难时的数据恢复起着极其重要的作用，MySQL的主从复制， 就是通过该binlog实现的。默认MySQL是未开启该日志的。</p>\n<p><strong>MySQL的主从复制原理如下：</strong></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_14-44-15.jpg\"></p>\n<p><strong>MySQL复制过程分成三步：</strong></p>\n<p>1). MySQL master 将数据变更写入二进制日志( binary log)</p>\n<p>2). slave将master的binary log拷贝到它的中继日志（relay log）</p>\n<p>3). slave重做中继日志中的事件，将数据变更反映它自己的数据</p>\n<h2 id=\"1、主库配置\"><a href=\"#1、主库配置\" class=\"headerlink\" title=\"1、主库配置\"></a>1、<strong>主库配置</strong></h2><p><strong>1、MySQL 默认加载 my.cnf</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mysqld]</span><br><span class=\"line\">log-bin=mysql-bin   #[必须]启用二进制日志</span><br><span class=\"line\">server-id=128      #[必须]服务器唯一ID(唯一即可)</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">max_binlog_size=100M</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --privileged -d -p <span class=\"number\">3306</span>:<span class=\"number\">3306</span> \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/logs:/logs \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/data:/<span class=\"keyword\">var</span>/lib/mysql \\</span><br><span class=\"line\">  -e MYSQL_ROOT_PASSWORD=<span class=\"number\">1234</span> \\</span><br><span class=\"line\">  --name mysql5<span class=\"number\">.7</span> \\</span><br><span class=\"line\">  mysql:<span class=\"number\">5.7</span> \\</span><br><span class=\"line\">  --log-bin=/<span class=\"keyword\">var</span>/lib/mysql/mysql-bin  # 强制启用binlog（确保生效）</span><br></pre></td></tr></table></figure>\n\n<p>2、<strong>验证</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入容器</span><br><span class=\"line\">docker exec -it mysql5.7 mysql -uroot -p1234</span><br><span class=\"line\"># 查看binlog是否启用</span><br><span class=\"line\">show variables like &#x27;log_bin&#x27;;</span><br><span class=\"line\"># 查看主库状态</span><br><span class=\"line\">show master status;</span><br></pre></td></tr></table></figure>\n\n<p><strong>3、创建数据同步的用户并授权</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT REPLICATION SLAVE ON *.* to &#x27;xiaoming&#x27;@&#x27;%&#x27; identified by &#x27;Root@251314&#x27;;</span><br></pre></td></tr></table></figure>\n\n<p>注：上面SQL的作用是创建一个用户 xiaoming ，密码为 Root@123456  ，并且给xiaoming用户授予REPLICATION SLAVE权限。常用于建立复制时所需要用到的用户权限，也就是slave必须被master授权具有该权限的用户，才能通过该用户复制。 </p>\n<p><strong>4、登录Mysql数据库，查看master同步状态</strong></p>\n<p>执行下面SQL，记录下结果中<strong>File</strong>和<strong>Position</strong>的值</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show master status;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072416433.jpg\"></p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072451506.jpg\"></p>\n<p>注：上面SQL的作用是查看Master的状态，执行完此SQL后不要再执行任何操作</p>\n<h2 id=\"2、从库配置\"><a href=\"#2、从库配置\" class=\"headerlink\" title=\"2、从库配置\"></a>2、<strong>从库配置</strong></h2><p><strong>修改Mysql数据库的配置文件&#x2F;etc&#x2F;my.cnf</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=201 \t#[必须]服务器唯一ID</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072533392.jpg\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --privileged -d -p 3306:3306 \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/conf/my.cnf:/etc/mysql/conf.d/my.cnf \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/logs:/logs \\</span><br><span class=\"line\">  -v /data/dockerData/mysql/data:/var/lib/mysql \\</span><br><span class=\"line\">  -e MYSQL_ROOT_PASSWORD=1234 \\</span><br><span class=\"line\">  --name mysql5.7 \\</span><br><span class=\"line\">  mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<p><strong>登录Mysql数据库，设置主库地址及同步位置</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 进入容器</span><br><span class=\"line\">docker exec -it mysql5.7 mysql -uroot -p1234</span><br><span class=\"line\"></span><br><span class=\"line\">stop slave;</span><br><span class=\"line\"></span><br><span class=\"line\">change master to master_host=&#x27;192.168.60.128&#x27;,master_user=&#x27;xiaoming&#x27;,master_password=&#x27;Root@251314&#x27;,master_log_file=&#x27;mysql-bin.000002&#x27;,master_log_pos=154;</span><br><span class=\"line\"></span><br><span class=\"line\">start slave;</span><br></pre></td></tr></table></figure>\n\n<p>参数说明：</p>\n<p>​\tA. master_host : 主库的IP地址</p>\n<p>​\tB. master_user : 访问主库进行主从复制的用户名(上面在主库创建的)</p>\n<p>​\tC. master_password : 访问主库进行主从复制的用户名对应的密码</p>\n<p>​\tD. master_log_file : 从哪个日志文件开始同步(上述查询master状态中展示的有)</p>\n<p>​\tE. master_log_pos : 从指定日志文件的哪个位置开始同步(上述查询master状态中展示的有)</p>\n<p><strong>查看从数据库的状态</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show slave status\\G</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_16-12-02.jpg\"></p>\n<p>MySQL命令行技巧：</p>\n<p>​\t\\G : 在MySQL的sql语句后加上\\G，表示将查询结果进行按列打印，可以使每个字段打印到单独的行。即将查到的结构旋转90度变成纵向；</p>\n<h1 id=\"2、读写分离案例\"><a href=\"#2、读写分离案例\" class=\"headerlink\" title=\"2、读写分离案例\"></a>2、<strong>读写分离案例</strong></h1><p>对日益增加的系统访问量，数据库的吞吐量面临着巨大瓶颈。 对于同一时刻有大量并发读操作和较少写操作类型的应用系统来说，将数据库拆分为<strong>主库</strong>和<strong>从库</strong>，主库负责处理事务性的增删改操作，从库负责处理查询操作，能够有效的避免由数据更新导致的行锁，使得整个系统的查询性能得到极大的改善。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072836452.jpg\"></p>\n<p>Sharding-JDBC定位为轻量级Java框架，在Java的JDBC层提供的额外服务。 它使用客户端直连数据库，以jar包形式提供服务，无需额外部署和依赖，可理解为增强版的JDBC驱动，完全兼容JDBC和各种ORM框架。</p>\n<p>使用Sharding-JDBC可以在程序中轻松的实现数据库读写分离。</p>\n<p>用法：</p>\n<p>1、在pom.xml中增加shardingJdbc的maven坐标</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;sharding-jdbc-spring-boot-starter&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;4.0.0-RC1&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<p>2、在application.yml中增加数据源的配置</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  shardingsphere:</span><br><span class=\"line\">    datasource:</span><br><span class=\"line\">      names:</span><br><span class=\"line\">        master,slave</span><br><span class=\"line\">      # 主数据源</span><br><span class=\"line\">      master:</span><br><span class=\"line\">        type: com.alibaba.druid.pool.DruidDataSource</span><br><span class=\"line\">        driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">        url: jdbc:mysql://192.168.138.100:3306/rw?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false&amp;allowPublicKeyRetrieval=true</span><br><span class=\"line\">        username: root</span><br><span class=\"line\">        password: root</span><br><span class=\"line\">      # 从数据源</span><br><span class=\"line\">      slave:</span><br><span class=\"line\">        type: com.alibaba.druid.pool.DruidDataSource</span><br><span class=\"line\">        driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">        url: jdbc:mysql://192.168.138.101:3306/rw?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false&amp;allowPublicKeyRetrieval=true</span><br><span class=\"line\">        username: root</span><br><span class=\"line\">        password: root</span><br><span class=\"line\">    masterslave:</span><br><span class=\"line\">      # 读写分离配置</span><br><span class=\"line\">      load-balance-algorithm-type: round_robin #轮询</span><br><span class=\"line\">      # 最终的数据源名称</span><br><span class=\"line\">      name: dataSource</span><br><span class=\"line\">      # 主库数据源名称</span><br><span class=\"line\">      master-data-source-name: master</span><br><span class=\"line\">      # 从库数据源名称列表，多个逗号分隔</span><br><span class=\"line\">      slave-data-source-names: slave</span><br><span class=\"line\">    props:</span><br><span class=\"line\">      sql:</span><br><span class=\"line\">        show: true #开启SQL显示，默认false</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/1755072960206.jpg\"></p>\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_14-44-15.jpg","popularPost_tmp_gaData":{"updated":"Wed Nov 05 2025 10:13:30 GMT+0800 (中国标准时间)","title":"MySQL主从复制+读写分离","path":"2024/08/13/MySQL主从复制+读写分离/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-08-13_14-44-15.jpg","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2024-08-13T02:34:26.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2024-08-13T02:34:26.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"MySQL","tags":["MySQL"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"若依框架中使用Velocity模块引擎改造代码生成功能","date":"2025-09-04T06:10:15.000Z","_content":"\n# 若依框架中使用Velocity模块引擎改造代码生成功能\n\n- 支持mybatis-plus\n- 支持Lombok\n- 支持Swagger自动添加\n- 支持LocalDateTime\n\n在若依框架中，主要生成代码的模块是zzyl-generator模块\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/image.png)\n\n上述代码中，以`vm`为后缀的文件，其实是velocity模板引擎的对应的模板文件，如果想要改造代码生成的内容，我们必须要先学习velocity，而后再来看懂这些代码，才能支撑我们去改造这些模板文件，来生成我们想要的内容\n\n## 1、Velocity模块引擎\n\n### 1.1、概述\n\nVelocity是一个基于Java的模板引擎，可以通过特定的语法获取在java对象的数据 , 填充到模板中，从而实现界面和java代码的分离 !\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-17-40.jpg)\n\n常见的应用场景：\n\n- Web应用程序 : 作为为应用程序的视图, 展示数据。\n- 源代码生成  : Velocity可用于基于模板生成Java源代码。\n- 自动电子邮件 : 网站注册 , 认证等的电子邮件模板。\n- 网页静态化  : 基于velocity模板 , 生成静态网页。\n\n### 1.2、快速入门\n\n需求：根据下面html模板，完成对数据的填充\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>velocity快速入门</title>\n</head>\n<body>\n\n    <h3>心怀梦想，坚持不懈，成功即在前方。加油少年！</h3>\n    \n</body>\n</html>\n```\n\n- 要求：**加油少年，**这几个字，需要使用动态填充进来\n\n**入门案例实现步骤**\n\n①准备模板\n\n把上面提供的html文档，拷贝一份到若依项目中的ruoyi-generator模块下的reources目录中\n\n模板文件命名：`index.html.vm`\n\n如下图\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/e44ce461-6e3a-427f-acdb-78fc53d9db12.png)\n\n模板文件内容：\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>velocity快速入门</title>\n</head>\n<body>\n\n<h3>心怀梦想，坚持不懈，成功即在前方。${message}</h3>\n\n</body>\n</html>\n```\n\n**注意**：上述代码中的 加油少年  修改为了  ${message}  这是一个动态变量，方便**动态**填充数据\n\n②编写java代码实现数据填充，并生成文件\n\n```java\nimport com.ruoyi.common.constant.Constants;\nimport org.apache.velocity.Template;\nimport org.apache.velocity.VelocityContext;\nimport org.apache.velocity.app.Velocity;\n\nimport java.io.FileWriter;\nimport java.io.IOException;\nimport java.util.Properties;\n\npublic class VelocityDemoTest {\n\n    public static void main(String[] args) throws IOException {\n\n        Properties p = new Properties();\n        //velocity资源加载器，告诉模板引擎到类路径下寻找资源（比如模板）\n        p.setProperty(\"resource.loader.file.class\", \"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\");\n        // 定义字符集\n        p.setProperty(Velocity.INPUT_ENCODING, Constants.UTF8);\n        //初始化velocity引擎\n        Velocity.init(p);\n\n        //创建velocity上下文对象\n        VelocityContext context = new VelocityContext();\n        //数据模型，这里的key需要跟模板中的变量对应上，不然填充不了数据\n        context.put(\"message\", \"加油朋友！！！\");\n        //获取模板\n        Template template = Velocity.getTemplate(\"vms/index.html.vm\", \"UTF-8\");\n        //输出\n        FileWriter fileWriter = new FileWriter(\"D:\\\\workspace\\\\index.html\");\n        //合并模板和数据模型\n        template.merge(context,fileWriter);\n        //关闭流\n        fileWriter.close();\n\n    }\n}\n```\n\n最终的效果：\n\n在指定的目录中生成index.html文件\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-23-28.jpg)\n\n打开之后的效果：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-24-07.jpg)\n\n### 1.3、AI辅助解读Velocity语法\n\n大模型解读后的代码如下：\n\n```java\n// Velocity模板开始，定义包名\npackage ${packageName}.domain;\n\n// 循环导入所需的类库\n#foreach ($import in $importList)\nimport ${import};\n#end\n\n// 导入其他必要的类库\nimport org.apache.commons.lang3.builder.ToStringBuilder;\nimport org.apache.commons.lang3.builder.ToStringStyle;\nimport com.zzyl.common.annotation.Excel;\n#if($table.crud || $table.sub)\nimport com.zzyl.common.core.domain.BaseEntity;\n#elseif($table.tree)\nimport com.zzyl.common.core.domain.TreeEntity;\n#end\n\n/**\n * ${functionName}对象 ${tableName}\n *\n * @author ${author}\n * @date ${datetime}\n */\n#if($table.crud || $table.sub)\n#set($Entity=\"BaseEntity\")\n#elseif($table.tree)\n#set($Entity=\"TreeEntity\")\n#end\n\n// 定义Java类，继承自BaseEntity或TreeEntity\npublic class ${ClassName} extends ${Entity}\n{\n    // 序列化版本ID\n    private static final long serialVersionUID = 1L;\n\n    // 循环定义类中的属性\n    #foreach ($column in $columns)\n    #if(!$table.isSuperColumn($column.javaField))\n        // 添加属性的注释\n        /** $column.columnComment */\n\n        // 根据属性是否为列表类型，决定是否添加Excel注解\n        #if($column.list)\n        #set($parentheseIndex=$column.columnComment.indexOf(\"（\"))\n        #if($parentheseIndex != -1)\n        #set($comment=$column.columnComment.substring(0, $parentheseIndex))\n        #else\n        #set($comment=$column.columnComment)\n        #end\n        #if($parentheseIndex != -1)\n        // 如果属性名中有括号，则截取括号前的内容作为Excel注解的名字\n        @Excel(name = \"${comment}\", readConverterExp = \"$column.readConverterExp()\")\n        #else\n        // 如果是日期类型，添加JSON格式化注解\n        #elseif($column.javaType == 'Date')\n        @JsonFormat(pattern = \"yyyy-MM-dd\")\n        @Excel(name = \"${comment}\", width = 30, dateFormat = \"yyyy-MM-dd\")\n        #else\n        // 其他情况直接添加Excel注解\n        @Excel(name = \"${comment}\")\n        #end\n        #end\n\n        // 定义属性\n        private $column.javaType $column.javaField;\n\n    #end\n    #end\n\n    // 如果是子表，添加子表的集合属性\n    #if($table.sub)\n        /** $table.subTable.functionName信息 */\n        private List<${subClassName}> ${subclassName}List;\n\n    #end\n\n    // 生成getter和setter方法\n    #foreach ($column in $columns)\n    #if(!$table.isSuperColumn($column.javaField))\n        #if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n        #set($AttrName=$column.javaField)\n        #else\n        #set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n        #end\n\n        // setter方法\n        public void set${AttrName}($column.javaType $column.javaField)\n        {\n            this.$column.javaField = $column.javaField;\n        }\n\n        // getter方法\n        public $column.javaType get${AttrName}()\n        {\n            return $column.javaField;\n        }\n    #end\n    #end\n\n    // 如果是子表，生成子表集合的getter和setter方法\n    #if($table.sub)\n        public List<${subClassName}> get${subClassName}List()\n        {\n            return ${subclassName}List;\n        }\n\n        public void set${subClassName}List(List<${subClassName}> ${subclassName}List)\n        {\n            this.${subclassName}List = ${subclassName}List;\n        }\n\n    #end\n\n    // 重写toString方法\n    @Override\n    public String toString() {\n        return new ToStringBuilder(this,ToStringStyle.MULTI_LINE_STYLE)\n        #foreach ($column in $columns)\n        #if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n        #set($AttrName=$column.javaField)\n        #else\n        #set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n        #end\n            .append(\"${column.javaField}\", get${AttrName}())\n        #end\n        #if($table.sub)\n            .append(\"${subclassName}List\", get${subClassName}List())\n        #end\n            .toString();\n    }\n}\n```\n\n- Velocity语法解释\n  - `${variable}`: 表示插入变量值。\n  - `#foreach` 和 `#end`: 循环结构，用于遍历列表。\n  - `#if` 和 `#end`: 条件判断结构。\n  - `#set`: 设置变量。\n  - `#elseif`: 条件分支。\n- Java类结构说明\n  - 包声明: 定义类所在的包。\n  - 导入语句: 导入类所需要的类库。\n  - 类注释: 描述类的功能和作者信息。\n  - 类定义: 定义类并继承自`BaseEntity`或`TreeEntity`。\n  - 属性定义: 根据模板参数定义类的属性。\n  - 属性注释: 对属性进行描述。\n  - Excel注解: 标记属性以方便导出Excel。\n  - getter和setter方法: 自动生成属性的访问方法。\n  - 子表集合: 如果是子表，则定义子表集合。\n  - 重写toString方法: 提供类实例的字符串表示形式。\n\n## 2、代码生成流程\n\n目前，我们已经基本熟悉了velocity的作用和一些语法，那接下来，我们就通过这些知识来去改造若依框架的代码生成部分，在改造之前，我们对于生成代码的核心部分来阅读一下\n\n代码位置：com.zzyl.generator.service.GenTableServiceImpl.generatorCode()\n\n```java\n/**\n * 生成代码\n * @param tableName 表名\n * @param zip       压缩输出流\n */\nprivate void generatorCode(String tableName, ZipOutputStream zip)\n{\n    // 查询表信息\n    GenTable table = genTableMapper.selectGenTableByName(tableName);\n    // 设置主子表信息\n    setSubTable(table);\n    // 设置主键列信息\n    setPkColumn(table);\n\n    // 初始化Velocity引擎\n    VelocityInitializer.initVelocity();\n\n    // 准备Velocity上下文   获取详细的该表的数据，并设置模板所需要的数据模型\n    VelocityContext context = VelocityUtils.prepareContext(table);\n\n    // 获取模板列表   读取resources/vm目录中的定义的模板文件\n    List<String> templates = VelocityUtils.getTemplateList(table.getTplCategory(), table.getTplWebType());\n    for (String template : templates)\n    {\n        // 渲染模板\n        StringWriter sw = new StringWriter();\n        Template tpl = Velocity.getTemplate(template, Constants.UTF8);\n        // 合并模板和数据模型\n        tpl.merge(context, sw);\n        try\n        {\n            // 将渲染结果添加到zip文件\n            zip.putNextEntry(new ZipEntry(VelocityUtils.getFileName(template, table)));\n            IOUtils.write(sw.toString(), zip, Constants.UTF8);\n            IOUtils.closeQuietly(sw);\n            zip.flush();\n            zip.closeEntry();\n        }\n        catch (IOException e)\n        {\n            // 记录日志\n            log.error(\"渲染模板失败，表名：\" + table.getTableName(), e);\n        }\n    }\n}\n```\n\n## 3、Lombok集成\n\n### 3.1、依赖导入\n\n```java\n<dependency>\n  <groupId>org.projectlombok</groupId>\n  <artifactId>lombok</artifactId>\n  <version>1.18.22</version>\n</dependency>\n```\n\n### 3.2、修改模板\n\n我们主要修改的模板为 `domain.java.vm`，让它支持lombok\n\n修改模板如下：\n\n```java\npackage ${packageName}.domain;\n\n#foreach ($import in $importList)\nimport ${import};\n#end\nimport org.apache.commons.lang3.builder.ToStringBuilder;  ## 用不到，可删\nimport org.apache.commons.lang3.builder.ToStringStyle;  ## 用不到，可删\nimport com.zzyl.common.annotation.Excel;\n#if($table.crud || $table.sub)\nimport com.zzyl.common.core.domain.BaseEntity;\n#elseif($table.tree)\nimport com.zzyl.common.core.domain.TreeEntity;\n#end\nimport lombok.Data;  ## 导入lombok的依赖\n\n/**\n * ${functionName}对象 ${tableName}\n * \n * @author ${author}\n * @date ${datetime}\n */\n#if($table.crud || $table.sub)\n#set($Entity=\"BaseEntity\")\n#elseif($table.tree)\n#set($Entity=\"TreeEntity\")\n#end\n@Data  ## 添加lombok的注解\npublic class ${ClassName} extends ${Entity}\n{\n    private static final long serialVersionUID = 1L;\n\n#foreach ($column in $columns)\n#if(!$table.isSuperColumn($column.javaField))\n    /** $column.columnComment */\n#if($column.list)\n#set($parentheseIndex=$column.columnComment.indexOf(\"（\"))\n#if($parentheseIndex != -1)\n#set($comment=$column.columnComment.substring(0, $parentheseIndex))\n#else\n#set($comment=$column.columnComment)\n#end\n#if($parentheseIndex != -1)\n    @Excel(name = \"${comment}\", readConverterExp = \"$column.readConverterExp()\")\n#elseif($column.javaType == 'Date')\n    @JsonFormat(pattern = \"yyyy-MM-dd\")\n    @Excel(name = \"${comment}\", width = 30, dateFormat = \"yyyy-MM-dd\")\n#else\n    @Excel(name = \"${comment}\")\n#end\n#end\n    private $column.javaType $column.javaField;\n\n#end\n#end\n#if($table.sub)\n    /** $table.subTable.functionName信息 */\n    private List<${subClassName}> ${subclassName}List;\n\n#end\n\n## 以下是生成属性的get/set方法  start....  删除这部分内容\n#foreach ($column in $columns)\n#if(!$table.isSuperColumn($column.javaField))\n#if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n#set($AttrName=$column.javaField)\n#else\n#set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n#end\n    public void set${AttrName}($column.javaType $column.javaField) \n    {\n        this.$column.javaField = $column.javaField;\n    }\n\n    public $column.javaType get${AttrName}() \n    {\n        return $column.javaField;\n    }\n#end\n#end\n\n## 以下是生成属性的get/set方法  end....  删除这部分内容\n\n## 如果是主子表，生成子表相关的get/set方法，start....  删除这部分内容\n#if($table.sub)\n    public List<${subClassName}> get${subClassName}List()\n    {\n        return ${subclassName}List;\n    }\n\n    public void set${subClassName}List(List<${subClassName}> ${subclassName}List)\n    {\n        this.${subclassName}List = ${subclassName}List;\n    }\n\n#end\n\n## 如果是主子表，生成子表相关的get/set方法，end....  删除这部分内容\n\n\n##以下代码生成 toString方法， start....  删除这部分内容\n    @Override\n    public String toString() {\n        return new ToStringBuilder(this,ToStringStyle.MULTI_LINE_STYLE)\n#foreach ($column in $columns)\n#if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n#set($AttrName=$column.javaField)\n#else\n#set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n#end\n            .append(\"${column.javaField}\", get${AttrName}())\n#end\n#if($table.sub)\n            .append(\"${subclassName}List\", get${subClassName}List())\n#end\n            .toString();\n    }\n##以下代码生成 toString方法， end....  删除这部分内容\n\n}\n```\n\n### 3.3、生成后的效果\n\n修改完成之后，重启项目，找到代码生成的功能，通过**代码预览**可以查看实体类的代码：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-59-09.jpg)\n\n> - 正常添加了关于lombok的注解\n> - 删除了setter、 getter  、toString 等方法\n\n**测试**\n\n可以把生成后的代码，拷贝到项目中，如果护理项目能够正常访问和操作，就算修改成功了，后期再次生成的代码，全部都支持lombok\n\n## 4、Mybatis-Plus集成\n\n我们改造主要参考的是官方推荐的项目：https://gitee.com/tellsea/ruoyi-vue-plus（目前已集成mybatis-plus）\n\n### 4.1、添加依赖\n\n在父工程中的pom文件中添加mybatis-plus的依赖，如下：\n\n```xml\n<properties>\n    <mybatis-plus-spring-boot.version>3.5.2</mybatis-plus-spring-boot.version>\n</properties>\n\n<!-- 依赖声明 -->\n<dependencyManagement>\n    <dependencies>\n        <!-- mybatis-plus 增强CRUD -->\n        <dependency>\n            <groupId>com.baomidou</groupId>\n            <artifactId>mybatis-plus-boot-starter</artifactId>\n            <version>${mybatis-plus-spring-boot.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>com.baomidou</groupId>\n            <artifactId>mybatis-plus-annotation</artifactId>\n            <version>${mybatis-plus-spring-boot.version}</version>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n\n在zzyl-common模块中新增mybatis-plus的依赖\n\n```xml\n<dependency>\n    <groupId>com.baomidou</groupId>\n    <artifactId>mybatis-plus-boot-starter</artifactId>\n</dependency>\n<dependency>\n    <groupId>com.baomidou</groupId>\n    <artifactId>mybatis-plus-annotation</artifactId>\n</dependency>\n```\n\n### 4.2、核心配置\n\nappliation.yml文件中新增MyBatisPlus配置，同时**删除Mybatis相关的配置**\n\n```yaml\n# MyBatisPlus配置\nmybatis-plus:\n  # 搜索指定包别名\n  typeAliasesPackage: com.zzyl.**.domain\n  # 配置mapper的扫描，找到所有的mapper.xml映射文件\n  mapperLocations: classpath*:mapper/**/*Mapper.xml\n  # 全局配置\n  global-config:\n    db-config:\n      id-type: auto   #id生成策略为自增\n  configuration: \n    map-underscore-to-camel-case: true    #字段与属性，自动转换为驼峰命名\n```\n\n新增核心配置类，**删除MyBatisConfig**\n\n```Java\npackage com.zzyl.framework.config;\n\nimport com.baomidou.mybatisplus.annotation.DbType;\nimport com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;\nimport com.baomidou.mybatisplus.extension.plugins.inner.BlockAttackInnerInterceptor;\nimport com.baomidou.mybatisplus.extension.plugins.inner.OptimisticLockerInnerInterceptor;\nimport com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\n\n/**\n * Mybatis Plus 配置\n *\n * @author ruoyi\n */\n@EnableTransactionManagement(proxyTargetClass = true)\n@Configuration\npublic class MybatisPlusConfig {\n\n    @Bean\n    public MybatisPlusInterceptor mybatisPlusInterceptor() {\n        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();\n        // 分页插件\n        interceptor.addInnerInterceptor(paginationInnerInterceptor());\n        // 乐观锁插件\n        interceptor.addInnerInterceptor(optimisticLockerInnerInterceptor());\n        // 阻断插件\n        interceptor.addInnerInterceptor(blockAttackInnerInterceptor());\n        return interceptor;\n    }\n\n    /**\n     * 分页插件，自动识别数据库类型 https://baomidou.com/guide/interceptor-pagination.html\n     */\n    public PaginationInnerInterceptor paginationInnerInterceptor() {\n        PaginationInnerInterceptor paginationInnerInterceptor = new PaginationInnerInterceptor();\n        // 设置数据库类型为mysql\n        paginationInnerInterceptor.setDbType(DbType.MYSQL);\n        // 设置最大单页限制数量，默认 500 条，-1 不受限制\n        paginationInnerInterceptor.setMaxLimit(-1L);\n        return paginationInnerInterceptor;\n    }\n\n    /**\n     * 乐观锁插件 https://baomidou.com/guide/interceptor-optimistic-locker.html\n     */\n    public OptimisticLockerInnerInterceptor optimisticLockerInnerInterceptor() {\n        return new OptimisticLockerInnerInterceptor();\n    }\n\n    /**\n     * 如果是对全表的删除或更新操作，就会终止该操作 https://baomidou.com/guide/interceptor-block-attack.html\n     */\n    public BlockAttackInnerInterceptor blockAttackInnerInterceptor() {\n        return new BlockAttackInnerInterceptor();\n    }\n\n}\n```\n\n### 4.3、代码生成模板\n\n在目前的模板文件中，我们需要修改的模板共有3个，分别是：\n\n- mapper.java.vm   继承BaseMapper \n- service.java.vm   继承IService<T> \n- serviceImpl.java.vm    继承ServiceImpl<XxxMapper,T>  常见方法的使用（单表的增删改查）\n\n> - domain.java.vm  无需修改，类名与表名一致，会自动映射，主键已经在yaml文件中配置\n> - controller.java.vm 无需修改，保留原有的接口方法和命名\n\n**mapper.java.vm**\n\n```Java\npackage ${packageName}.mapper;\n\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Mapper;\nimport java.util.List;\nimport ${packageName}.domain.${ClassName};\n#if($table.sub)\nimport ${packageName}.domain.${subClassName};\n#end\n\n/**\n * ${functionName}Mapper接口\n * \n * @author ${author}\n * @date ${datetime}\n */\n@Mapper\npublic interface ${ClassName}Mapper extends BaseMapper<${ClassName}>\n{\n    /**\n     * 查询${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return ${functionName}\n     */\n    public ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n\n    /**\n     * 查询${functionName}列表\n     * \n     * @param ${className} ${functionName}\n     * @return ${functionName}集合\n     */\n    public List<${ClassName}> select${ClassName}List(${ClassName} ${className});\n\n    /**\n     * 新增${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int insert${ClassName}(${ClassName} ${className});\n\n    /**\n     * 修改${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int update${ClassName}(${ClassName} ${className});\n\n    /**\n     * 删除${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n\n    /**\n     * 批量删除${functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的数据主键集合\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);\n#if($table.sub)\n\n    /**\n     * 批量删除${subTable.functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的数据主键集合\n     * @return 结果\n     */\n    public int delete${subClassName}By${subTableFkClassName}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);\n    \n    /**\n     * 批量新增${subTable.functionName}\n     * \n     * @param ${subclassName}List ${subTable.functionName}列表\n     * @return 结果\n     */\n    public int batch${subClassName}(List<${subClassName}> ${subclassName}List);\n    \n\n    /**\n     * 通过${functionName}主键删除${subTable.functionName}信息\n     * \n     * @param ${pkColumn.javaField} ${functionName}ID\n     * @return 结果\n     */\n    public int delete${subClassName}By${subTableFkClassName}(${pkColumn.javaType} ${pkColumn.javaField});\n#end\n}\n```\n\n**service.java.vm**\n\n```Java\npackage ${packageName}.service;\n\nimport com.baomidou.mybatisplus.extension.service.IService;\nimport java.util.List;\nimport ${packageName}.domain.${ClassName};\n\n/**\n * ${functionName}Service接口\n * \n * @author ${author}\n * @date ${datetime}\n */\npublic interface I${ClassName}Service extends IService<${ClassName}>\n{\n    /**\n     * 查询${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return ${functionName}\n     */\n    public ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n\n    /**\n     * 查询${functionName}列表\n     * \n     * @param ${className} ${functionName}\n     * @return ${functionName}集合\n     */\n    public List<${ClassName}> select${ClassName}List(${ClassName} ${className});\n\n    /**\n     * 新增${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int insert${ClassName}(${ClassName} ${className});\n\n    /**\n     * 修改${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int update${ClassName}(${ClassName} ${className});\n\n    /**\n     * 批量删除${functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的${functionName}主键集合\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);\n\n    /**\n     * 删除${functionName}信息\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n}\n```\n\n**serviceImpl.java.vm**\n\n```Java\npackage ${packageName}.service.impl;\n\nimport java.util.List;\n#foreach ($column in $columns)\n#if($column.javaField == 'createTime' || $column.javaField == 'updateTime')\nimport com.zzyl.common.utils.DateUtils;\n#break\n#end\n#end\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n#if($table.sub)\nimport java.util.ArrayList;\nimport com.zzyl.common.utils.StringUtils;\nimport org.springframework.transaction.annotation.Transactional;\nimport ${packageName}.domain.${subClassName};\n#end\nimport ${packageName}.mapper.${ClassName}Mapper;\nimport ${packageName}.domain.${ClassName};\nimport ${packageName}.service.I${ClassName}Service;\n\nimport ${packageName}.mapper.${ClassName}Mapper;\nimport com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;\nimport java.util.Arrays;\n\n/**\n * ${functionName}Service业务层处理\n * \n * @author ${author}\n * @date ${datetime}\n */\n@Service\npublic class ${ClassName}ServiceImpl extends ServiceImpl<${ClassName}Mapper, ${ClassName}> implements I${ClassName}Service\n{\n    @Autowired\n    private ${ClassName}Mapper ${className}Mapper;\n\n    /**\n     * 查询${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return ${functionName}\n     */\n    @Override\n    public ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField})\n    {\n        ##return ${className}Mapper.select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaField});\n        return getById(${pkColumn.javaField});\n    }\n\n    /**\n     * 查询${functionName}列表\n     * \n     * @param ${className} ${functionName}\n     * @return ${functionName}\n     */\n    @Override\n    public List<${ClassName}> select${ClassName}List(${ClassName} ${className})\n    {\n        return ${className}Mapper.select${ClassName}List(${className});\n    }\n\n    /**\n     * 新增${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int insert${ClassName}(${ClassName} ${className})\n    {\n#foreach ($column in $columns)   删除这些 新增的时候，给创建时间赋值\n#if($column.javaField == 'createTime')\n        ${className}.setCreateTime(DateUtils.getNowDate());\n#end\n#end\n#if($table.sub)\n        int rows = ${className}Mapper.insert${ClassName}(${className});\n        insert${subClassName}(${className});\n        return rows;\n#else\n        ##return ${className}Mapper.insert${ClassName}(${className});\n        return save(${className}) == true? 1 : 0;\n#end\n    }\n\n    /**\n     * 修改${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int update${ClassName}(${ClassName} ${className})\n    {\n#foreach ($column in $columns)  删除这些，修改的时候给修改时间赋值\n#if($column.javaField == 'updateTime')\n        ${className}.setUpdateTime(DateUtils.getNowDate());\n#end\n#end\n#if($table.sub)\n        ${className}Mapper.delete${subClassName}By${subTableFkClassName}(${className}.get${pkColumn.capJavaField}());\n        insert${subClassName}(${className});\n#end\n##        return ${className}Mapper.update${ClassName}(${className});\n        return updateById(${className}) == true ? 1 : 0;\n    }\n\n    /**\n     * 批量删除${functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的${functionName}主键\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s)\n    {\n#if($table.sub)\n        ${className}Mapper.delete${subClassName}By${subTableFkClassName}s(${pkColumn.javaField}s);\n#end\n##        return ${className}Mapper.delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaField}s);\n        return removeByIds(Arrays.asList(${pkColumn.javaField}s)) == true ? 1 : 0;\n    }\n\n    /**\n     * 删除${functionName}信息\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField})\n    {\n#if($table.sub)\n        ${className}Mapper.delete${subClassName}By${subTableFkClassName}(${pkColumn.javaField});\n#end\n##        return ${className}Mapper.delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaField});\n        return removeById(${pkColumn.javaField}) == true ? 1 : 0;\n    }\n#if($table.sub)\n\n    /**\n     * 新增${subTable.functionName}信息\n     * \n     * @param ${className} ${functionName}对象\n     */\n    public void insert${subClassName}(${ClassName} ${className})\n    {\n        List<${subClassName}> ${subclassName}List = ${className}.get${subClassName}List();\n        ${pkColumn.javaType} ${pkColumn.javaField} = ${className}.get${pkColumn.capJavaField}();\n        if (StringUtils.isNotNull(${subclassName}List))\n        {\n            List<${subClassName}> list = new ArrayList<${subClassName}>();\n            for (${subClassName} ${subclassName} : ${subclassName}List)\n            {\n                ${subclassName}.set${subTableFkClassName}(${pkColumn.javaField});\n                list.add(${subclassName});\n            }\n            if (list.size() > 0)\n            {\n                ${className}Mapper.batch${subClassName}(list);\n            }\n        }\n    }\n#end\n}\n```\n\n**其他必要修改**\n\n集成MP之后，项目中的BaseEntity类中的字段有些会受影响，需要添加如下注解\n\n由于这几个字段，并不会跟数据库中的表字段进行映射，必须要添加@TableField(exist = false)表示，表示该字段不存在于数据库表中\n\n```Java\n/**\n * Entity基类\n * \n * @author ruoyi\n */\npublic class BaseEntity implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n\n    /** 搜索值 */\n    @JsonIgnore\n    @TableField(exist = false)\n    private String searchValue;\n\n    /** 请求参数 */\n    @JsonInclude(JsonInclude.Include.NON_EMPTY)\n    @TableField(exist = false)\n    private Map<String, Object> params;\n\n}\n```\n\n### 4.4、字段自动填充\n\nMyBatis-Plus 提供的字段自动填充功能是一种非常实用的特性，它能够在插入或更新数据库记录时自动填充一些公共字段，如创建时间（createTime）、更新时间（updateTime）、创建人（createBy）、更新人（updateBy）等。这一功能极大地简化了开发过程，减少了重复的代码编写，提高了开发效率。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-06-29.jpg)\n\n官网链接：https://mybatis.plus/guide/auto-fill-metainfo.html（可能打不开，官网本身的问题）\n\n在MybatisPlus中通过两步可以实现这个功能：\n\n1、在实体类中，使用`@TableField`注解，来标明哪些字段是需要自动填充的，并且需要指定填充策略\n\n```Java\npackage com.zzyl.common.core.domain;\n\nimport java.io.Serializable;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\n\nimport com.baomidou.mybatisplus.annotation.FieldFill;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.fasterxml.jackson.annotation.JsonFormat;\nimport com.fasterxml.jackson.annotation.JsonIgnore;\nimport com.fasterxml.jackson.annotation.JsonInclude;\nimport io.swagger.annotations.ApiModel;\nimport io.swagger.annotations.ApiModelProperty;\n\n/**\n * Entity基类\n * \n * @author ruoyi\n */\n@ApiModel(\"Entity基类\")\npublic class BaseEntity implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n\n    /** 搜索值 */\n    @JsonIgnore\n    @TableField(exist = false)\n    private String searchValue;\n\n    /** 创建者 */\n    @ApiModelProperty(value = \"创建者\")\n    @TableField(fill = FieldFill.INSERT)\n    private String createBy;\n\n    /** 创建时间 */\n    @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n    @ApiModelProperty(value = \"创建时间\")\n    @TableField(fill = FieldFill.INSERT)\n    private Date createTime;\n\n    /** 更新者 */\n    @ApiModelProperty(value = \"更新者\")\n    @TableField(fill = FieldFill.UPDATE)\n    private String updateBy;\n\n    /** 更新时间 */\n    @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n    @ApiModelProperty(value = \"更新时间\")\n    @TableField(fill = FieldFill.UPDATE)\n    private Date updateTime;\n\n    /** 备注 */\n    @ApiModelProperty(value = \"备注\")\n    private String remark;\n\n    /** 请求参数 */\n    @JsonInclude(JsonInclude.Include.NON_EMPTY)\n    @ApiModelProperty(value = \"请求参数\")\n    @TableField(exist = false)\n    private Map<String, Object> params;\n    \n}\n```\n\n2、在zzyl-framework模块中新增MyMetaObjectHandler 来处理自动自动填充\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-07-54.jpg)\n\n详细的代码如下：\n\n```Java\npackage com.zzyl.framework.interceptor;\n\nimport com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;\nimport com.zzyl.common.core.domain.model.LoginUser;\nimport com.zzyl.common.utils.SecurityUtils;\nimport org.apache.commons.lang3.ObjectUtils;\nimport org.apache.ibatis.reflection.MetaObject;\nimport org.springframework.stereotype.Component;\n\nimport java.util.Date;\n\n@Component\npublic class MyMetaObjectHandler implements MetaObjectHandler {\n\n    @Override\n    public void insertFill(MetaObject metaObject) {\n        this.strictInsertFill(metaObject, \"createTime\", Date.class, new Date());\n        this.strictInsertFill(metaObject, \"createBy\", String.class, loadUserId()+\"\");\n    }\n\n    @Override\n    public void updateFill(MetaObject metaObject) {\n        this.strictUpdateFill(metaObject, \"updateTime\", Date.class, new Date());\n        this.strictUpdateFill(metaObject, \"updateBy\", String.class, loadUserId()+\"\");\n    }\n\n    /**\n     * 获取当前登录人的ID\n     * @return\n     */\n    public static Long loadUserId(){\n        //获取当前登录人的id\n        LoginUser loginUser = SecurityUtils.getLoginUser();\n        if(ObjectUtils.isNotEmpty(loginUser)){\n            return loginUser.getUserId();\n        }\n        return 1L;\n    }\n}\n```\n\n## 5、Swagger集成\n\n在我们定义的所有controller中，为了更好的体现接口文档，我们都需要添加swagger注解才可以。这些注解我们也可以通过代码的模板来生成，节省我们的开发工作\n\n我们主要的工作就是来修改**controller.java.vm**文件即可，具体的修改的内容如下：\n\n```Java\npackage ${packageName}.controller;\n\nimport io.swagger.annotations.Api;\nimport io.swagger.annotations.ApiOperation;\nimport io.swagger.annotations.ApiParam;\nimport java.util.List;\nimport javax.servlet.http.HttpServletResponse;\nimport org.springframework.security.access.prepost.PreAuthorize;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.PutMapping;\nimport org.springframework.web.bind.annotation.DeleteMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport com.zzyl.common.annotation.Log;\nimport com.zzyl.common.core.controller.BaseController;\nimport com.zzyl.common.core.domain.AjaxResult;\nimport com.zzyl.common.enums.BusinessType;\nimport ${packageName}.domain.${ClassName};\nimport ${packageName}.service.I${ClassName}Service;\nimport com.zzyl.common.utils.poi.ExcelUtil;\n#if($table.crud || $table.sub)\nimport com.zzyl.common.core.page.TableDataInfo;\n#elseif($table.tree)\n#end\n\n/**\n * ${functionName}Controller\n * \n * @author ${author}\n * @date ${datetime}\n */\n@RestController\n@RequestMapping(\"/${moduleName}/${businessName}\")\n@Api(tags =  \"${functionName}相关接口\")\npublic class ${ClassName}Controller extends BaseController\n{\n    @Autowired\n    private I${ClassName}Service ${className}Service;\n\n    /**\n     * 查询${functionName}列表\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:list')\")\n    @GetMapping(\"/list\")\n    @ApiOperation(\"查询${functionName}列表\")\n#if($table.crud || $table.sub)\n    public TableDataInfo list(${ClassName} ${className})\n    {\n        startPage();\n        List<${ClassName}> list = ${className}Service.select${ClassName}List(${className});\n        return getDataTable(list);\n    }\n#elseif($table.tree)\n    public AjaxResult list(${ClassName} ${className})\n    {\n        List<${ClassName}> list = ${className}Service.select${ClassName}List(${className});\n        return success(list);\n    }\n#end\n\n    /**\n     * 导出${functionName}列表\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:export')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.EXPORT)\n    @PostMapping(\"/export\")\n    @ApiOperation(\"导出${functionName}列表\")\n    public void export(HttpServletResponse response, ${ClassName} ${className})\n    {\n        List<${ClassName}> list = ${className}Service.select${ClassName}List(${className});\n        ExcelUtil<${ClassName}> util = new ExcelUtil<${ClassName}>(${ClassName}.class);\n        util.exportExcel(response, list, \"${functionName}数据\");\n    }\n\n    /**\n     * 获取${functionName}详细信息\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:query')\")\n    @GetMapping(value = \"/{${pkColumn.javaField}}\")\n    @ApiOperation(\"获取${functionName}详细信息\")\n    public AjaxResult getInfo(@ApiParam(value = \"${functionName}ID\", required = true)\n                                  @PathVariable(\"${pkColumn.javaField}\") ${pkColumn.javaType} ${pkColumn.javaField})\n    {\n        return success(${className}Service.select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaField}));\n    }\n\n    /**\n     * 新增${functionName}\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:add')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.INSERT)\n    @PostMapping\n    @ApiOperation(\"新增${functionName}\")\n    public AjaxResult add(@ApiParam(value = \"${functionName}实体\", required = true) @RequestBody ${ClassName} ${className})\n    {\n        return toAjax(${className}Service.insert${ClassName}(${className}));\n    }\n\n    /**\n     * 修改${functionName}\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:edit')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.UPDATE)\n    @PutMapping\n    @ApiOperation(\"修改${functionName}\")\n    public AjaxResult edit(@ApiParam(value = \"${functionName}实体\", required = true)  @RequestBody ${ClassName} ${className})\n    {\n        return toAjax(${className}Service.update${ClassName}(${className}));\n    }\n\n    /**\n     * 删除${functionName}\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:remove')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.DELETE)\n    @DeleteMapping(\"/{${pkColumn.javaField}s}\")\n    @ApiOperation(\"删除${functionName}\")\n    public AjaxResult remove(@PathVariable ${pkColumn.javaType}[] ${pkColumn.javaField}s)\n    {\n        return toAjax(${className}Service.delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaField}s));\n    }\n}\n```\n\n重启服务之后，我们可以预览生成后的效果：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-18-37.jpg)\n\n## 6、由Date类型改为LocalDateTime\n\n若依目前提供的代码中，如果遇到日期类型则使用的是Date，由于目前使用比较流行的是LocalDateTime类型，我们也可以把它改为该类型进行使用\n\n> **知识扩展**\n>\n> Date类型与LocalDateTime的区别？\n>\n> 1. 不可变性与线程安全性 \n>    1. Date一旦创建Date对象，可以通过setTime(long time)进行修改，多线程下存在线程安全问题\n>    2. LocalDateTime是不可变的，线程安全\n> 2. 时间精度\n>    1. Date可以表示到毫秒的时间值\n>    2. LocalDateTime可以表示到纳秒的时间值\n> 3. 易用性：LocalDateTime的API设计的更现代化，易于使用\n\n在目前代码生成中，其中字段详细这一栏中的Java类型并不支持LocalDateTime类型，所以我们需要在前端也要修改其内容，让它支持LocalDateTime\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-12.jpg)\n\n打开前端项目，找到src/views/tool/gen/editTable.vue文件，在这个文件添加中以上一行代码，如下：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-23.jpg)\n\n当前端选择了LocalDateTime类型之后，在后端的代码生成中，需要导入对应的包才可以，后端的代码也需要修改\n\n我们打开VelocityUtils类，这里面有处理导入包的逻辑，找到getImportList方法，在其中添加对应的包导入\n\n```\n/**\n * 根据列类型获取导入包\n * \n * @param genTable 业务表对象\n * @return 返回需要导入的包列表\n */\npublic static HashSet<String> getImportList(GenTable genTable)\n{\n    List<GenTableColumn> columns = genTable.getColumns();\n    GenTable subGenTable = genTable.getSubTable();\n    HashSet<String> importList = new HashSet<String>();\n    if (StringUtils.isNotNull(subGenTable))\n    {\n        importList.add(\"java.util.List\");\n    }\n    for (GenTableColumn column : columns)\n    {\n        if (!column.isSuperColumn() && GenConstants.TYPE_DATE.equals(column.getJavaType()))\n        {\n            importList.add(\"java.util.Date\");\n            importList.add(\"com.fasterxml.jackson.annotation.JsonFormat\");\n        }\n        else if (!column.isSuperColumn() && GenConstants.TYPE_BIGDECIMAL.equals(column.getJavaType()))\n        {\n            importList.add(\"java.math.BigDecimal\");\n        }\n        \n        //加入下面这些功能\n        // 如果字段类型在前端选择的是LocalDateTime，则导入对应的包\n        if (!column.isSuperColumn() && \"LocalDateTime\".equals(column.getJavaType()))\n        {\n            importList.add(\"java.time.LocalDateTime\");\n            //导入这个是为了格式化日期\n            importList.add(\"com.fasterxml.jackson.annotation.JsonFormat\");\n        }\n        \n        \n        \n    }\n    return importList;\n}\n```\n\n修改模块文件domain.java.vm文件，修改的内容如下：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-22-43.jpg)\n","source":"_posts/若依框架中使用Velocity模块引擎改造代码生成功能.md","raw":"---\ntitle: 若依框架中使用Velocity模块引擎改造代码生成功能\ndate: 2025-09-04 14:10:15\ntags:\n- 若依\ncategories:\n- Java\n---\n\n# 若依框架中使用Velocity模块引擎改造代码生成功能\n\n- 支持mybatis-plus\n- 支持Lombok\n- 支持Swagger自动添加\n- 支持LocalDateTime\n\n在若依框架中，主要生成代码的模块是zzyl-generator模块\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/image.png)\n\n上述代码中，以`vm`为后缀的文件，其实是velocity模板引擎的对应的模板文件，如果想要改造代码生成的内容，我们必须要先学习velocity，而后再来看懂这些代码，才能支撑我们去改造这些模板文件，来生成我们想要的内容\n\n## 1、Velocity模块引擎\n\n### 1.1、概述\n\nVelocity是一个基于Java的模板引擎，可以通过特定的语法获取在java对象的数据 , 填充到模板中，从而实现界面和java代码的分离 !\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-17-40.jpg)\n\n常见的应用场景：\n\n- Web应用程序 : 作为为应用程序的视图, 展示数据。\n- 源代码生成  : Velocity可用于基于模板生成Java源代码。\n- 自动电子邮件 : 网站注册 , 认证等的电子邮件模板。\n- 网页静态化  : 基于velocity模板 , 生成静态网页。\n\n### 1.2、快速入门\n\n需求：根据下面html模板，完成对数据的填充\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>velocity快速入门</title>\n</head>\n<body>\n\n    <h3>心怀梦想，坚持不懈，成功即在前方。加油少年！</h3>\n    \n</body>\n</html>\n```\n\n- 要求：**加油少年，**这几个字，需要使用动态填充进来\n\n**入门案例实现步骤**\n\n①准备模板\n\n把上面提供的html文档，拷贝一份到若依项目中的ruoyi-generator模块下的reources目录中\n\n模板文件命名：`index.html.vm`\n\n如下图\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/e44ce461-6e3a-427f-acdb-78fc53d9db12.png)\n\n模板文件内容：\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>velocity快速入门</title>\n</head>\n<body>\n\n<h3>心怀梦想，坚持不懈，成功即在前方。${message}</h3>\n\n</body>\n</html>\n```\n\n**注意**：上述代码中的 加油少年  修改为了  ${message}  这是一个动态变量，方便**动态**填充数据\n\n②编写java代码实现数据填充，并生成文件\n\n```java\nimport com.ruoyi.common.constant.Constants;\nimport org.apache.velocity.Template;\nimport org.apache.velocity.VelocityContext;\nimport org.apache.velocity.app.Velocity;\n\nimport java.io.FileWriter;\nimport java.io.IOException;\nimport java.util.Properties;\n\npublic class VelocityDemoTest {\n\n    public static void main(String[] args) throws IOException {\n\n        Properties p = new Properties();\n        //velocity资源加载器，告诉模板引擎到类路径下寻找资源（比如模板）\n        p.setProperty(\"resource.loader.file.class\", \"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\");\n        // 定义字符集\n        p.setProperty(Velocity.INPUT_ENCODING, Constants.UTF8);\n        //初始化velocity引擎\n        Velocity.init(p);\n\n        //创建velocity上下文对象\n        VelocityContext context = new VelocityContext();\n        //数据模型，这里的key需要跟模板中的变量对应上，不然填充不了数据\n        context.put(\"message\", \"加油朋友！！！\");\n        //获取模板\n        Template template = Velocity.getTemplate(\"vms/index.html.vm\", \"UTF-8\");\n        //输出\n        FileWriter fileWriter = new FileWriter(\"D:\\\\workspace\\\\index.html\");\n        //合并模板和数据模型\n        template.merge(context,fileWriter);\n        //关闭流\n        fileWriter.close();\n\n    }\n}\n```\n\n最终的效果：\n\n在指定的目录中生成index.html文件\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-23-28.jpg)\n\n打开之后的效果：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-24-07.jpg)\n\n### 1.3、AI辅助解读Velocity语法\n\n大模型解读后的代码如下：\n\n```java\n// Velocity模板开始，定义包名\npackage ${packageName}.domain;\n\n// 循环导入所需的类库\n#foreach ($import in $importList)\nimport ${import};\n#end\n\n// 导入其他必要的类库\nimport org.apache.commons.lang3.builder.ToStringBuilder;\nimport org.apache.commons.lang3.builder.ToStringStyle;\nimport com.zzyl.common.annotation.Excel;\n#if($table.crud || $table.sub)\nimport com.zzyl.common.core.domain.BaseEntity;\n#elseif($table.tree)\nimport com.zzyl.common.core.domain.TreeEntity;\n#end\n\n/**\n * ${functionName}对象 ${tableName}\n *\n * @author ${author}\n * @date ${datetime}\n */\n#if($table.crud || $table.sub)\n#set($Entity=\"BaseEntity\")\n#elseif($table.tree)\n#set($Entity=\"TreeEntity\")\n#end\n\n// 定义Java类，继承自BaseEntity或TreeEntity\npublic class ${ClassName} extends ${Entity}\n{\n    // 序列化版本ID\n    private static final long serialVersionUID = 1L;\n\n    // 循环定义类中的属性\n    #foreach ($column in $columns)\n    #if(!$table.isSuperColumn($column.javaField))\n        // 添加属性的注释\n        /** $column.columnComment */\n\n        // 根据属性是否为列表类型，决定是否添加Excel注解\n        #if($column.list)\n        #set($parentheseIndex=$column.columnComment.indexOf(\"（\"))\n        #if($parentheseIndex != -1)\n        #set($comment=$column.columnComment.substring(0, $parentheseIndex))\n        #else\n        #set($comment=$column.columnComment)\n        #end\n        #if($parentheseIndex != -1)\n        // 如果属性名中有括号，则截取括号前的内容作为Excel注解的名字\n        @Excel(name = \"${comment}\", readConverterExp = \"$column.readConverterExp()\")\n        #else\n        // 如果是日期类型，添加JSON格式化注解\n        #elseif($column.javaType == 'Date')\n        @JsonFormat(pattern = \"yyyy-MM-dd\")\n        @Excel(name = \"${comment}\", width = 30, dateFormat = \"yyyy-MM-dd\")\n        #else\n        // 其他情况直接添加Excel注解\n        @Excel(name = \"${comment}\")\n        #end\n        #end\n\n        // 定义属性\n        private $column.javaType $column.javaField;\n\n    #end\n    #end\n\n    // 如果是子表，添加子表的集合属性\n    #if($table.sub)\n        /** $table.subTable.functionName信息 */\n        private List<${subClassName}> ${subclassName}List;\n\n    #end\n\n    // 生成getter和setter方法\n    #foreach ($column in $columns)\n    #if(!$table.isSuperColumn($column.javaField))\n        #if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n        #set($AttrName=$column.javaField)\n        #else\n        #set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n        #end\n\n        // setter方法\n        public void set${AttrName}($column.javaType $column.javaField)\n        {\n            this.$column.javaField = $column.javaField;\n        }\n\n        // getter方法\n        public $column.javaType get${AttrName}()\n        {\n            return $column.javaField;\n        }\n    #end\n    #end\n\n    // 如果是子表，生成子表集合的getter和setter方法\n    #if($table.sub)\n        public List<${subClassName}> get${subClassName}List()\n        {\n            return ${subclassName}List;\n        }\n\n        public void set${subClassName}List(List<${subClassName}> ${subclassName}List)\n        {\n            this.${subclassName}List = ${subclassName}List;\n        }\n\n    #end\n\n    // 重写toString方法\n    @Override\n    public String toString() {\n        return new ToStringBuilder(this,ToStringStyle.MULTI_LINE_STYLE)\n        #foreach ($column in $columns)\n        #if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n        #set($AttrName=$column.javaField)\n        #else\n        #set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n        #end\n            .append(\"${column.javaField}\", get${AttrName}())\n        #end\n        #if($table.sub)\n            .append(\"${subclassName}List\", get${subClassName}List())\n        #end\n            .toString();\n    }\n}\n```\n\n- Velocity语法解释\n  - `${variable}`: 表示插入变量值。\n  - `#foreach` 和 `#end`: 循环结构，用于遍历列表。\n  - `#if` 和 `#end`: 条件判断结构。\n  - `#set`: 设置变量。\n  - `#elseif`: 条件分支。\n- Java类结构说明\n  - 包声明: 定义类所在的包。\n  - 导入语句: 导入类所需要的类库。\n  - 类注释: 描述类的功能和作者信息。\n  - 类定义: 定义类并继承自`BaseEntity`或`TreeEntity`。\n  - 属性定义: 根据模板参数定义类的属性。\n  - 属性注释: 对属性进行描述。\n  - Excel注解: 标记属性以方便导出Excel。\n  - getter和setter方法: 自动生成属性的访问方法。\n  - 子表集合: 如果是子表，则定义子表集合。\n  - 重写toString方法: 提供类实例的字符串表示形式。\n\n## 2、代码生成流程\n\n目前，我们已经基本熟悉了velocity的作用和一些语法，那接下来，我们就通过这些知识来去改造若依框架的代码生成部分，在改造之前，我们对于生成代码的核心部分来阅读一下\n\n代码位置：com.zzyl.generator.service.GenTableServiceImpl.generatorCode()\n\n```java\n/**\n * 生成代码\n * @param tableName 表名\n * @param zip       压缩输出流\n */\nprivate void generatorCode(String tableName, ZipOutputStream zip)\n{\n    // 查询表信息\n    GenTable table = genTableMapper.selectGenTableByName(tableName);\n    // 设置主子表信息\n    setSubTable(table);\n    // 设置主键列信息\n    setPkColumn(table);\n\n    // 初始化Velocity引擎\n    VelocityInitializer.initVelocity();\n\n    // 准备Velocity上下文   获取详细的该表的数据，并设置模板所需要的数据模型\n    VelocityContext context = VelocityUtils.prepareContext(table);\n\n    // 获取模板列表   读取resources/vm目录中的定义的模板文件\n    List<String> templates = VelocityUtils.getTemplateList(table.getTplCategory(), table.getTplWebType());\n    for (String template : templates)\n    {\n        // 渲染模板\n        StringWriter sw = new StringWriter();\n        Template tpl = Velocity.getTemplate(template, Constants.UTF8);\n        // 合并模板和数据模型\n        tpl.merge(context, sw);\n        try\n        {\n            // 将渲染结果添加到zip文件\n            zip.putNextEntry(new ZipEntry(VelocityUtils.getFileName(template, table)));\n            IOUtils.write(sw.toString(), zip, Constants.UTF8);\n            IOUtils.closeQuietly(sw);\n            zip.flush();\n            zip.closeEntry();\n        }\n        catch (IOException e)\n        {\n            // 记录日志\n            log.error(\"渲染模板失败，表名：\" + table.getTableName(), e);\n        }\n    }\n}\n```\n\n## 3、Lombok集成\n\n### 3.1、依赖导入\n\n```java\n<dependency>\n  <groupId>org.projectlombok</groupId>\n  <artifactId>lombok</artifactId>\n  <version>1.18.22</version>\n</dependency>\n```\n\n### 3.2、修改模板\n\n我们主要修改的模板为 `domain.java.vm`，让它支持lombok\n\n修改模板如下：\n\n```java\npackage ${packageName}.domain;\n\n#foreach ($import in $importList)\nimport ${import};\n#end\nimport org.apache.commons.lang3.builder.ToStringBuilder;  ## 用不到，可删\nimport org.apache.commons.lang3.builder.ToStringStyle;  ## 用不到，可删\nimport com.zzyl.common.annotation.Excel;\n#if($table.crud || $table.sub)\nimport com.zzyl.common.core.domain.BaseEntity;\n#elseif($table.tree)\nimport com.zzyl.common.core.domain.TreeEntity;\n#end\nimport lombok.Data;  ## 导入lombok的依赖\n\n/**\n * ${functionName}对象 ${tableName}\n * \n * @author ${author}\n * @date ${datetime}\n */\n#if($table.crud || $table.sub)\n#set($Entity=\"BaseEntity\")\n#elseif($table.tree)\n#set($Entity=\"TreeEntity\")\n#end\n@Data  ## 添加lombok的注解\npublic class ${ClassName} extends ${Entity}\n{\n    private static final long serialVersionUID = 1L;\n\n#foreach ($column in $columns)\n#if(!$table.isSuperColumn($column.javaField))\n    /** $column.columnComment */\n#if($column.list)\n#set($parentheseIndex=$column.columnComment.indexOf(\"（\"))\n#if($parentheseIndex != -1)\n#set($comment=$column.columnComment.substring(0, $parentheseIndex))\n#else\n#set($comment=$column.columnComment)\n#end\n#if($parentheseIndex != -1)\n    @Excel(name = \"${comment}\", readConverterExp = \"$column.readConverterExp()\")\n#elseif($column.javaType == 'Date')\n    @JsonFormat(pattern = \"yyyy-MM-dd\")\n    @Excel(name = \"${comment}\", width = 30, dateFormat = \"yyyy-MM-dd\")\n#else\n    @Excel(name = \"${comment}\")\n#end\n#end\n    private $column.javaType $column.javaField;\n\n#end\n#end\n#if($table.sub)\n    /** $table.subTable.functionName信息 */\n    private List<${subClassName}> ${subclassName}List;\n\n#end\n\n## 以下是生成属性的get/set方法  start....  删除这部分内容\n#foreach ($column in $columns)\n#if(!$table.isSuperColumn($column.javaField))\n#if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n#set($AttrName=$column.javaField)\n#else\n#set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n#end\n    public void set${AttrName}($column.javaType $column.javaField) \n    {\n        this.$column.javaField = $column.javaField;\n    }\n\n    public $column.javaType get${AttrName}() \n    {\n        return $column.javaField;\n    }\n#end\n#end\n\n## 以下是生成属性的get/set方法  end....  删除这部分内容\n\n## 如果是主子表，生成子表相关的get/set方法，start....  删除这部分内容\n#if($table.sub)\n    public List<${subClassName}> get${subClassName}List()\n    {\n        return ${subclassName}List;\n    }\n\n    public void set${subClassName}List(List<${subClassName}> ${subclassName}List)\n    {\n        this.${subclassName}List = ${subclassName}List;\n    }\n\n#end\n\n## 如果是主子表，生成子表相关的get/set方法，end....  删除这部分内容\n\n\n##以下代码生成 toString方法， start....  删除这部分内容\n    @Override\n    public String toString() {\n        return new ToStringBuilder(this,ToStringStyle.MULTI_LINE_STYLE)\n#foreach ($column in $columns)\n#if($column.javaField.length() > 2 && $column.javaField.substring(1,2).matches(\"[A-Z]\"))\n#set($AttrName=$column.javaField)\n#else\n#set($AttrName=$column.javaField.substring(0,1).toUpperCase() + ${column.javaField.substring(1)})\n#end\n            .append(\"${column.javaField}\", get${AttrName}())\n#end\n#if($table.sub)\n            .append(\"${subclassName}List\", get${subClassName}List())\n#end\n            .toString();\n    }\n##以下代码生成 toString方法， end....  删除这部分内容\n\n}\n```\n\n### 3.3、生成后的效果\n\n修改完成之后，重启项目，找到代码生成的功能，通过**代码预览**可以查看实体类的代码：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-59-09.jpg)\n\n> - 正常添加了关于lombok的注解\n> - 删除了setter、 getter  、toString 等方法\n\n**测试**\n\n可以把生成后的代码，拷贝到项目中，如果护理项目能够正常访问和操作，就算修改成功了，后期再次生成的代码，全部都支持lombok\n\n## 4、Mybatis-Plus集成\n\n我们改造主要参考的是官方推荐的项目：https://gitee.com/tellsea/ruoyi-vue-plus（目前已集成mybatis-plus）\n\n### 4.1、添加依赖\n\n在父工程中的pom文件中添加mybatis-plus的依赖，如下：\n\n```xml\n<properties>\n    <mybatis-plus-spring-boot.version>3.5.2</mybatis-plus-spring-boot.version>\n</properties>\n\n<!-- 依赖声明 -->\n<dependencyManagement>\n    <dependencies>\n        <!-- mybatis-plus 增强CRUD -->\n        <dependency>\n            <groupId>com.baomidou</groupId>\n            <artifactId>mybatis-plus-boot-starter</artifactId>\n            <version>${mybatis-plus-spring-boot.version}</version>\n        </dependency>\n        <dependency>\n            <groupId>com.baomidou</groupId>\n            <artifactId>mybatis-plus-annotation</artifactId>\n            <version>${mybatis-plus-spring-boot.version}</version>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n\n在zzyl-common模块中新增mybatis-plus的依赖\n\n```xml\n<dependency>\n    <groupId>com.baomidou</groupId>\n    <artifactId>mybatis-plus-boot-starter</artifactId>\n</dependency>\n<dependency>\n    <groupId>com.baomidou</groupId>\n    <artifactId>mybatis-plus-annotation</artifactId>\n</dependency>\n```\n\n### 4.2、核心配置\n\nappliation.yml文件中新增MyBatisPlus配置，同时**删除Mybatis相关的配置**\n\n```yaml\n# MyBatisPlus配置\nmybatis-plus:\n  # 搜索指定包别名\n  typeAliasesPackage: com.zzyl.**.domain\n  # 配置mapper的扫描，找到所有的mapper.xml映射文件\n  mapperLocations: classpath*:mapper/**/*Mapper.xml\n  # 全局配置\n  global-config:\n    db-config:\n      id-type: auto   #id生成策略为自增\n  configuration: \n    map-underscore-to-camel-case: true    #字段与属性，自动转换为驼峰命名\n```\n\n新增核心配置类，**删除MyBatisConfig**\n\n```Java\npackage com.zzyl.framework.config;\n\nimport com.baomidou.mybatisplus.annotation.DbType;\nimport com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;\nimport com.baomidou.mybatisplus.extension.plugins.inner.BlockAttackInnerInterceptor;\nimport com.baomidou.mybatisplus.extension.plugins.inner.OptimisticLockerInnerInterceptor;\nimport com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\n\n/**\n * Mybatis Plus 配置\n *\n * @author ruoyi\n */\n@EnableTransactionManagement(proxyTargetClass = true)\n@Configuration\npublic class MybatisPlusConfig {\n\n    @Bean\n    public MybatisPlusInterceptor mybatisPlusInterceptor() {\n        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();\n        // 分页插件\n        interceptor.addInnerInterceptor(paginationInnerInterceptor());\n        // 乐观锁插件\n        interceptor.addInnerInterceptor(optimisticLockerInnerInterceptor());\n        // 阻断插件\n        interceptor.addInnerInterceptor(blockAttackInnerInterceptor());\n        return interceptor;\n    }\n\n    /**\n     * 分页插件，自动识别数据库类型 https://baomidou.com/guide/interceptor-pagination.html\n     */\n    public PaginationInnerInterceptor paginationInnerInterceptor() {\n        PaginationInnerInterceptor paginationInnerInterceptor = new PaginationInnerInterceptor();\n        // 设置数据库类型为mysql\n        paginationInnerInterceptor.setDbType(DbType.MYSQL);\n        // 设置最大单页限制数量，默认 500 条，-1 不受限制\n        paginationInnerInterceptor.setMaxLimit(-1L);\n        return paginationInnerInterceptor;\n    }\n\n    /**\n     * 乐观锁插件 https://baomidou.com/guide/interceptor-optimistic-locker.html\n     */\n    public OptimisticLockerInnerInterceptor optimisticLockerInnerInterceptor() {\n        return new OptimisticLockerInnerInterceptor();\n    }\n\n    /**\n     * 如果是对全表的删除或更新操作，就会终止该操作 https://baomidou.com/guide/interceptor-block-attack.html\n     */\n    public BlockAttackInnerInterceptor blockAttackInnerInterceptor() {\n        return new BlockAttackInnerInterceptor();\n    }\n\n}\n```\n\n### 4.3、代码生成模板\n\n在目前的模板文件中，我们需要修改的模板共有3个，分别是：\n\n- mapper.java.vm   继承BaseMapper \n- service.java.vm   继承IService<T> \n- serviceImpl.java.vm    继承ServiceImpl<XxxMapper,T>  常见方法的使用（单表的增删改查）\n\n> - domain.java.vm  无需修改，类名与表名一致，会自动映射，主键已经在yaml文件中配置\n> - controller.java.vm 无需修改，保留原有的接口方法和命名\n\n**mapper.java.vm**\n\n```Java\npackage ${packageName}.mapper;\n\nimport com.baomidou.mybatisplus.core.mapper.BaseMapper;\nimport org.apache.ibatis.annotations.Mapper;\nimport java.util.List;\nimport ${packageName}.domain.${ClassName};\n#if($table.sub)\nimport ${packageName}.domain.${subClassName};\n#end\n\n/**\n * ${functionName}Mapper接口\n * \n * @author ${author}\n * @date ${datetime}\n */\n@Mapper\npublic interface ${ClassName}Mapper extends BaseMapper<${ClassName}>\n{\n    /**\n     * 查询${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return ${functionName}\n     */\n    public ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n\n    /**\n     * 查询${functionName}列表\n     * \n     * @param ${className} ${functionName}\n     * @return ${functionName}集合\n     */\n    public List<${ClassName}> select${ClassName}List(${ClassName} ${className});\n\n    /**\n     * 新增${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int insert${ClassName}(${ClassName} ${className});\n\n    /**\n     * 修改${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int update${ClassName}(${ClassName} ${className});\n\n    /**\n     * 删除${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n\n    /**\n     * 批量删除${functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的数据主键集合\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);\n#if($table.sub)\n\n    /**\n     * 批量删除${subTable.functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的数据主键集合\n     * @return 结果\n     */\n    public int delete${subClassName}By${subTableFkClassName}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);\n    \n    /**\n     * 批量新增${subTable.functionName}\n     * \n     * @param ${subclassName}List ${subTable.functionName}列表\n     * @return 结果\n     */\n    public int batch${subClassName}(List<${subClassName}> ${subclassName}List);\n    \n\n    /**\n     * 通过${functionName}主键删除${subTable.functionName}信息\n     * \n     * @param ${pkColumn.javaField} ${functionName}ID\n     * @return 结果\n     */\n    public int delete${subClassName}By${subTableFkClassName}(${pkColumn.javaType} ${pkColumn.javaField});\n#end\n}\n```\n\n**service.java.vm**\n\n```Java\npackage ${packageName}.service;\n\nimport com.baomidou.mybatisplus.extension.service.IService;\nimport java.util.List;\nimport ${packageName}.domain.${ClassName};\n\n/**\n * ${functionName}Service接口\n * \n * @author ${author}\n * @date ${datetime}\n */\npublic interface I${ClassName}Service extends IService<${ClassName}>\n{\n    /**\n     * 查询${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return ${functionName}\n     */\n    public ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n\n    /**\n     * 查询${functionName}列表\n     * \n     * @param ${className} ${functionName}\n     * @return ${functionName}集合\n     */\n    public List<${ClassName}> select${ClassName}List(${ClassName} ${className});\n\n    /**\n     * 新增${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int insert${ClassName}(${ClassName} ${className});\n\n    /**\n     * 修改${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n    public int update${ClassName}(${ClassName} ${className});\n\n    /**\n     * 批量删除${functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的${functionName}主键集合\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);\n\n    /**\n     * 删除${functionName}信息\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return 结果\n     */\n    public int delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});\n}\n```\n\n**serviceImpl.java.vm**\n\n```Java\npackage ${packageName}.service.impl;\n\nimport java.util.List;\n#foreach ($column in $columns)\n#if($column.javaField == 'createTime' || $column.javaField == 'updateTime')\nimport com.zzyl.common.utils.DateUtils;\n#break\n#end\n#end\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n#if($table.sub)\nimport java.util.ArrayList;\nimport com.zzyl.common.utils.StringUtils;\nimport org.springframework.transaction.annotation.Transactional;\nimport ${packageName}.domain.${subClassName};\n#end\nimport ${packageName}.mapper.${ClassName}Mapper;\nimport ${packageName}.domain.${ClassName};\nimport ${packageName}.service.I${ClassName}Service;\n\nimport ${packageName}.mapper.${ClassName}Mapper;\nimport com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;\nimport java.util.Arrays;\n\n/**\n * ${functionName}Service业务层处理\n * \n * @author ${author}\n * @date ${datetime}\n */\n@Service\npublic class ${ClassName}ServiceImpl extends ServiceImpl<${ClassName}Mapper, ${ClassName}> implements I${ClassName}Service\n{\n    @Autowired\n    private ${ClassName}Mapper ${className}Mapper;\n\n    /**\n     * 查询${functionName}\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return ${functionName}\n     */\n    @Override\n    public ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField})\n    {\n        ##return ${className}Mapper.select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaField});\n        return getById(${pkColumn.javaField});\n    }\n\n    /**\n     * 查询${functionName}列表\n     * \n     * @param ${className} ${functionName}\n     * @return ${functionName}\n     */\n    @Override\n    public List<${ClassName}> select${ClassName}List(${ClassName} ${className})\n    {\n        return ${className}Mapper.select${ClassName}List(${className});\n    }\n\n    /**\n     * 新增${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int insert${ClassName}(${ClassName} ${className})\n    {\n#foreach ($column in $columns)   删除这些 新增的时候，给创建时间赋值\n#if($column.javaField == 'createTime')\n        ${className}.setCreateTime(DateUtils.getNowDate());\n#end\n#end\n#if($table.sub)\n        int rows = ${className}Mapper.insert${ClassName}(${className});\n        insert${subClassName}(${className});\n        return rows;\n#else\n        ##return ${className}Mapper.insert${ClassName}(${className});\n        return save(${className}) == true? 1 : 0;\n#end\n    }\n\n    /**\n     * 修改${functionName}\n     * \n     * @param ${className} ${functionName}\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int update${ClassName}(${ClassName} ${className})\n    {\n#foreach ($column in $columns)  删除这些，修改的时候给修改时间赋值\n#if($column.javaField == 'updateTime')\n        ${className}.setUpdateTime(DateUtils.getNowDate());\n#end\n#end\n#if($table.sub)\n        ${className}Mapper.delete${subClassName}By${subTableFkClassName}(${className}.get${pkColumn.capJavaField}());\n        insert${subClassName}(${className});\n#end\n##        return ${className}Mapper.update${ClassName}(${className});\n        return updateById(${className}) == true ? 1 : 0;\n    }\n\n    /**\n     * 批量删除${functionName}\n     * \n     * @param ${pkColumn.javaField}s 需要删除的${functionName}主键\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s)\n    {\n#if($table.sub)\n        ${className}Mapper.delete${subClassName}By${subTableFkClassName}s(${pkColumn.javaField}s);\n#end\n##        return ${className}Mapper.delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaField}s);\n        return removeByIds(Arrays.asList(${pkColumn.javaField}s)) == true ? 1 : 0;\n    }\n\n    /**\n     * 删除${functionName}信息\n     * \n     * @param ${pkColumn.javaField} ${functionName}主键\n     * @return 结果\n     */\n#if($table.sub)\n    @Transactional\n#end\n    @Override\n    public int delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField})\n    {\n#if($table.sub)\n        ${className}Mapper.delete${subClassName}By${subTableFkClassName}(${pkColumn.javaField});\n#end\n##        return ${className}Mapper.delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaField});\n        return removeById(${pkColumn.javaField}) == true ? 1 : 0;\n    }\n#if($table.sub)\n\n    /**\n     * 新增${subTable.functionName}信息\n     * \n     * @param ${className} ${functionName}对象\n     */\n    public void insert${subClassName}(${ClassName} ${className})\n    {\n        List<${subClassName}> ${subclassName}List = ${className}.get${subClassName}List();\n        ${pkColumn.javaType} ${pkColumn.javaField} = ${className}.get${pkColumn.capJavaField}();\n        if (StringUtils.isNotNull(${subclassName}List))\n        {\n            List<${subClassName}> list = new ArrayList<${subClassName}>();\n            for (${subClassName} ${subclassName} : ${subclassName}List)\n            {\n                ${subclassName}.set${subTableFkClassName}(${pkColumn.javaField});\n                list.add(${subclassName});\n            }\n            if (list.size() > 0)\n            {\n                ${className}Mapper.batch${subClassName}(list);\n            }\n        }\n    }\n#end\n}\n```\n\n**其他必要修改**\n\n集成MP之后，项目中的BaseEntity类中的字段有些会受影响，需要添加如下注解\n\n由于这几个字段，并不会跟数据库中的表字段进行映射，必须要添加@TableField(exist = false)表示，表示该字段不存在于数据库表中\n\n```Java\n/**\n * Entity基类\n * \n * @author ruoyi\n */\npublic class BaseEntity implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n\n    /** 搜索值 */\n    @JsonIgnore\n    @TableField(exist = false)\n    private String searchValue;\n\n    /** 请求参数 */\n    @JsonInclude(JsonInclude.Include.NON_EMPTY)\n    @TableField(exist = false)\n    private Map<String, Object> params;\n\n}\n```\n\n### 4.4、字段自动填充\n\nMyBatis-Plus 提供的字段自动填充功能是一种非常实用的特性，它能够在插入或更新数据库记录时自动填充一些公共字段，如创建时间（createTime）、更新时间（updateTime）、创建人（createBy）、更新人（updateBy）等。这一功能极大地简化了开发过程，减少了重复的代码编写，提高了开发效率。\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-06-29.jpg)\n\n官网链接：https://mybatis.plus/guide/auto-fill-metainfo.html（可能打不开，官网本身的问题）\n\n在MybatisPlus中通过两步可以实现这个功能：\n\n1、在实体类中，使用`@TableField`注解，来标明哪些字段是需要自动填充的，并且需要指定填充策略\n\n```Java\npackage com.zzyl.common.core.domain;\n\nimport java.io.Serializable;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\n\nimport com.baomidou.mybatisplus.annotation.FieldFill;\nimport com.baomidou.mybatisplus.annotation.TableField;\nimport com.fasterxml.jackson.annotation.JsonFormat;\nimport com.fasterxml.jackson.annotation.JsonIgnore;\nimport com.fasterxml.jackson.annotation.JsonInclude;\nimport io.swagger.annotations.ApiModel;\nimport io.swagger.annotations.ApiModelProperty;\n\n/**\n * Entity基类\n * \n * @author ruoyi\n */\n@ApiModel(\"Entity基类\")\npublic class BaseEntity implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n\n    /** 搜索值 */\n    @JsonIgnore\n    @TableField(exist = false)\n    private String searchValue;\n\n    /** 创建者 */\n    @ApiModelProperty(value = \"创建者\")\n    @TableField(fill = FieldFill.INSERT)\n    private String createBy;\n\n    /** 创建时间 */\n    @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n    @ApiModelProperty(value = \"创建时间\")\n    @TableField(fill = FieldFill.INSERT)\n    private Date createTime;\n\n    /** 更新者 */\n    @ApiModelProperty(value = \"更新者\")\n    @TableField(fill = FieldFill.UPDATE)\n    private String updateBy;\n\n    /** 更新时间 */\n    @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n    @ApiModelProperty(value = \"更新时间\")\n    @TableField(fill = FieldFill.UPDATE)\n    private Date updateTime;\n\n    /** 备注 */\n    @ApiModelProperty(value = \"备注\")\n    private String remark;\n\n    /** 请求参数 */\n    @JsonInclude(JsonInclude.Include.NON_EMPTY)\n    @ApiModelProperty(value = \"请求参数\")\n    @TableField(exist = false)\n    private Map<String, Object> params;\n    \n}\n```\n\n2、在zzyl-framework模块中新增MyMetaObjectHandler 来处理自动自动填充\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-07-54.jpg)\n\n详细的代码如下：\n\n```Java\npackage com.zzyl.framework.interceptor;\n\nimport com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;\nimport com.zzyl.common.core.domain.model.LoginUser;\nimport com.zzyl.common.utils.SecurityUtils;\nimport org.apache.commons.lang3.ObjectUtils;\nimport org.apache.ibatis.reflection.MetaObject;\nimport org.springframework.stereotype.Component;\n\nimport java.util.Date;\n\n@Component\npublic class MyMetaObjectHandler implements MetaObjectHandler {\n\n    @Override\n    public void insertFill(MetaObject metaObject) {\n        this.strictInsertFill(metaObject, \"createTime\", Date.class, new Date());\n        this.strictInsertFill(metaObject, \"createBy\", String.class, loadUserId()+\"\");\n    }\n\n    @Override\n    public void updateFill(MetaObject metaObject) {\n        this.strictUpdateFill(metaObject, \"updateTime\", Date.class, new Date());\n        this.strictUpdateFill(metaObject, \"updateBy\", String.class, loadUserId()+\"\");\n    }\n\n    /**\n     * 获取当前登录人的ID\n     * @return\n     */\n    public static Long loadUserId(){\n        //获取当前登录人的id\n        LoginUser loginUser = SecurityUtils.getLoginUser();\n        if(ObjectUtils.isNotEmpty(loginUser)){\n            return loginUser.getUserId();\n        }\n        return 1L;\n    }\n}\n```\n\n## 5、Swagger集成\n\n在我们定义的所有controller中，为了更好的体现接口文档，我们都需要添加swagger注解才可以。这些注解我们也可以通过代码的模板来生成，节省我们的开发工作\n\n我们主要的工作就是来修改**controller.java.vm**文件即可，具体的修改的内容如下：\n\n```Java\npackage ${packageName}.controller;\n\nimport io.swagger.annotations.Api;\nimport io.swagger.annotations.ApiOperation;\nimport io.swagger.annotations.ApiParam;\nimport java.util.List;\nimport javax.servlet.http.HttpServletResponse;\nimport org.springframework.security.access.prepost.PreAuthorize;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.PutMapping;\nimport org.springframework.web.bind.annotation.DeleteMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport com.zzyl.common.annotation.Log;\nimport com.zzyl.common.core.controller.BaseController;\nimport com.zzyl.common.core.domain.AjaxResult;\nimport com.zzyl.common.enums.BusinessType;\nimport ${packageName}.domain.${ClassName};\nimport ${packageName}.service.I${ClassName}Service;\nimport com.zzyl.common.utils.poi.ExcelUtil;\n#if($table.crud || $table.sub)\nimport com.zzyl.common.core.page.TableDataInfo;\n#elseif($table.tree)\n#end\n\n/**\n * ${functionName}Controller\n * \n * @author ${author}\n * @date ${datetime}\n */\n@RestController\n@RequestMapping(\"/${moduleName}/${businessName}\")\n@Api(tags =  \"${functionName}相关接口\")\npublic class ${ClassName}Controller extends BaseController\n{\n    @Autowired\n    private I${ClassName}Service ${className}Service;\n\n    /**\n     * 查询${functionName}列表\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:list')\")\n    @GetMapping(\"/list\")\n    @ApiOperation(\"查询${functionName}列表\")\n#if($table.crud || $table.sub)\n    public TableDataInfo list(${ClassName} ${className})\n    {\n        startPage();\n        List<${ClassName}> list = ${className}Service.select${ClassName}List(${className});\n        return getDataTable(list);\n    }\n#elseif($table.tree)\n    public AjaxResult list(${ClassName} ${className})\n    {\n        List<${ClassName}> list = ${className}Service.select${ClassName}List(${className});\n        return success(list);\n    }\n#end\n\n    /**\n     * 导出${functionName}列表\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:export')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.EXPORT)\n    @PostMapping(\"/export\")\n    @ApiOperation(\"导出${functionName}列表\")\n    public void export(HttpServletResponse response, ${ClassName} ${className})\n    {\n        List<${ClassName}> list = ${className}Service.select${ClassName}List(${className});\n        ExcelUtil<${ClassName}> util = new ExcelUtil<${ClassName}>(${ClassName}.class);\n        util.exportExcel(response, list, \"${functionName}数据\");\n    }\n\n    /**\n     * 获取${functionName}详细信息\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:query')\")\n    @GetMapping(value = \"/{${pkColumn.javaField}}\")\n    @ApiOperation(\"获取${functionName}详细信息\")\n    public AjaxResult getInfo(@ApiParam(value = \"${functionName}ID\", required = true)\n                                  @PathVariable(\"${pkColumn.javaField}\") ${pkColumn.javaType} ${pkColumn.javaField})\n    {\n        return success(${className}Service.select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaField}));\n    }\n\n    /**\n     * 新增${functionName}\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:add')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.INSERT)\n    @PostMapping\n    @ApiOperation(\"新增${functionName}\")\n    public AjaxResult add(@ApiParam(value = \"${functionName}实体\", required = true) @RequestBody ${ClassName} ${className})\n    {\n        return toAjax(${className}Service.insert${ClassName}(${className}));\n    }\n\n    /**\n     * 修改${functionName}\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:edit')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.UPDATE)\n    @PutMapping\n    @ApiOperation(\"修改${functionName}\")\n    public AjaxResult edit(@ApiParam(value = \"${functionName}实体\", required = true)  @RequestBody ${ClassName} ${className})\n    {\n        return toAjax(${className}Service.update${ClassName}(${className}));\n    }\n\n    /**\n     * 删除${functionName}\n     */\n    @PreAuthorize(\"@ss.hasPermi('${permissionPrefix}:remove')\")\n    @Log(title = \"${functionName}\", businessType = BusinessType.DELETE)\n    @DeleteMapping(\"/{${pkColumn.javaField}s}\")\n    @ApiOperation(\"删除${functionName}\")\n    public AjaxResult remove(@PathVariable ${pkColumn.javaType}[] ${pkColumn.javaField}s)\n    {\n        return toAjax(${className}Service.delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaField}s));\n    }\n}\n```\n\n重启服务之后，我们可以预览生成后的效果：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-18-37.jpg)\n\n## 6、由Date类型改为LocalDateTime\n\n若依目前提供的代码中，如果遇到日期类型则使用的是Date，由于目前使用比较流行的是LocalDateTime类型，我们也可以把它改为该类型进行使用\n\n> **知识扩展**\n>\n> Date类型与LocalDateTime的区别？\n>\n> 1. 不可变性与线程安全性 \n>    1. Date一旦创建Date对象，可以通过setTime(long time)进行修改，多线程下存在线程安全问题\n>    2. LocalDateTime是不可变的，线程安全\n> 2. 时间精度\n>    1. Date可以表示到毫秒的时间值\n>    2. LocalDateTime可以表示到纳秒的时间值\n> 3. 易用性：LocalDateTime的API设计的更现代化，易于使用\n\n在目前代码生成中，其中字段详细这一栏中的Java类型并不支持LocalDateTime类型，所以我们需要在前端也要修改其内容，让它支持LocalDateTime\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-12.jpg)\n\n打开前端项目，找到src/views/tool/gen/editTable.vue文件，在这个文件添加中以上一行代码，如下：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-23.jpg)\n\n当前端选择了LocalDateTime类型之后，在后端的代码生成中，需要导入对应的包才可以，后端的代码也需要修改\n\n我们打开VelocityUtils类，这里面有处理导入包的逻辑，找到getImportList方法，在其中添加对应的包导入\n\n```\n/**\n * 根据列类型获取导入包\n * \n * @param genTable 业务表对象\n * @return 返回需要导入的包列表\n */\npublic static HashSet<String> getImportList(GenTable genTable)\n{\n    List<GenTableColumn> columns = genTable.getColumns();\n    GenTable subGenTable = genTable.getSubTable();\n    HashSet<String> importList = new HashSet<String>();\n    if (StringUtils.isNotNull(subGenTable))\n    {\n        importList.add(\"java.util.List\");\n    }\n    for (GenTableColumn column : columns)\n    {\n        if (!column.isSuperColumn() && GenConstants.TYPE_DATE.equals(column.getJavaType()))\n        {\n            importList.add(\"java.util.Date\");\n            importList.add(\"com.fasterxml.jackson.annotation.JsonFormat\");\n        }\n        else if (!column.isSuperColumn() && GenConstants.TYPE_BIGDECIMAL.equals(column.getJavaType()))\n        {\n            importList.add(\"java.math.BigDecimal\");\n        }\n        \n        //加入下面这些功能\n        // 如果字段类型在前端选择的是LocalDateTime，则导入对应的包\n        if (!column.isSuperColumn() && \"LocalDateTime\".equals(column.getJavaType()))\n        {\n            importList.add(\"java.time.LocalDateTime\");\n            //导入这个是为了格式化日期\n            importList.add(\"com.fasterxml.jackson.annotation.JsonFormat\");\n        }\n        \n        \n        \n    }\n    return importList;\n}\n```\n\n修改模块文件domain.java.vm文件，修改的内容如下：\n\n![](https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-22-43.jpg)\n","slug":"若依框架中使用Velocity模块引擎改造代码生成功能","published":1,"updated":"2025-11-05T02:15:07.748Z","_id":"cmhk8wmwn0000x0amb7mwh1kf","comments":1,"layout":"post","photos":[],"content":"<h1 id=\"若依框架中使用Velocity模块引擎改造代码生成功能\"><a href=\"#若依框架中使用Velocity模块引擎改造代码生成功能\" class=\"headerlink\" title=\"若依框架中使用Velocity模块引擎改造代码生成功能\"></a>若依框架中使用Velocity模块引擎改造代码生成功能</h1><ul>\n<li>支持mybatis-plus</li>\n<li>支持Lombok</li>\n<li>支持Swagger自动添加</li>\n<li>支持LocalDateTime</li>\n</ul>\n<p>在若依框架中，主要生成代码的模块是zzyl-generator模块</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/image.png\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/image.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>上述代码中，以<code>vm</code>为后缀的文件，其实是velocity模板引擎的对应的模板文件，如果想要改造代码生成的内容，我们必须要先学习velocity，而后再来看懂这些代码，才能支撑我们去改造这些模板文件，来生成我们想要的内容</p>\n<h2 id=\"1、Velocity模块引擎\"><a href=\"#1、Velocity模块引擎\" class=\"headerlink\" title=\"1、Velocity模块引擎\"></a>1、Velocity模块引擎</h2><h3 id=\"1-1、概述\"><a href=\"#1-1、概述\" class=\"headerlink\" title=\"1.1、概述\"></a>1.1、概述</h3><p>Velocity是一个基于Java的模板引擎，可以通过特定的语法获取在java对象的数据 , 填充到模板中，从而实现界面和java代码的分离 !</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-17-40.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-17-40.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>常见的应用场景：</p>\n<ul>\n<li>Web应用程序 : 作为为应用程序的视图, 展示数据。</li>\n<li>源代码生成  : Velocity可用于基于模板生成Java源代码。</li>\n<li>自动电子邮件 : 网站注册 , 认证等的电子邮件模板。</li>\n<li>网页静态化  : 基于velocity模板 , 生成静态网页。</li>\n</ul>\n<h3 id=\"1-2、快速入门\"><a href=\"#1-2、快速入门\" class=\"headerlink\" title=\"1.2、快速入门\"></a>1.2、快速入门</h3><p>需求：根据下面html模板，完成对数据的填充</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>velocity快速入门<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>心怀梦想，坚持不懈，成功即在前方。加油少年！<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>要求：<strong>加油少年，</strong>这几个字，需要使用动态填充进来</li>\n</ul>\n<p><strong>入门案例实现步骤</strong></p>\n<p>①准备模板</p>\n<p>把上面提供的html文档，拷贝一份到若依项目中的ruoyi-generator模块下的reources目录中</p>\n<p>模板文件命名：<code>index.html.vm</code></p>\n<p>如下图</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/e44ce461-6e3a-427f-acdb-78fc53d9db12.png\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/e44ce461-6e3a-427f-acdb-78fc53d9db12.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>模板文件内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>velocity快速入门<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>心怀梦想，坚持不懈，成功即在前方。$&#123;message&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：上述代码中的 加油少年  修改为了  ${message}  这是一个动态变量，方便<strong>动态</strong>填充数据</p>\n<p>②编写java代码实现数据填充，并生成文件</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.ruoyi.common.constant.Constants;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.velocity.Template;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.velocity.VelocityContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.velocity.app.Velocity;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileWriter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VelocityDemoTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Properties</span> <span class=\"variable\">p</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Properties</span>();</span><br><span class=\"line\">        <span class=\"comment\">//velocity资源加载器，告诉模板引擎到类路径下寻找资源（比如模板）</span></span><br><span class=\"line\">        p.setProperty(<span class=\"string\">&quot;resource.loader.file.class&quot;</span>, <span class=\"string\">&quot;org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 定义字符集</span></span><br><span class=\"line\">        p.setProperty(Velocity.INPUT_ENCODING, Constants.UTF8);</span><br><span class=\"line\">        <span class=\"comment\">//初始化velocity引擎</span></span><br><span class=\"line\">        Velocity.init(p);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//创建velocity上下文对象</span></span><br><span class=\"line\">        <span class=\"type\">VelocityContext</span> <span class=\"variable\">context</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">VelocityContext</span>();</span><br><span class=\"line\">        <span class=\"comment\">//数据模型，这里的key需要跟模板中的变量对应上，不然填充不了数据</span></span><br><span class=\"line\">        context.put(<span class=\"string\">&quot;message&quot;</span>, <span class=\"string\">&quot;加油朋友！！！&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//获取模板</span></span><br><span class=\"line\">        <span class=\"type\">Template</span> <span class=\"variable\">template</span> <span class=\"operator\">=</span> Velocity.getTemplate(<span class=\"string\">&quot;vms/index.html.vm&quot;</span>, <span class=\"string\">&quot;UTF-8&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//输出</span></span><br><span class=\"line\">        <span class=\"type\">FileWriter</span> <span class=\"variable\">fileWriter</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileWriter</span>(<span class=\"string\">&quot;D:\\\\workspace\\\\index.html&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//合并模板和数据模型</span></span><br><span class=\"line\">        template.merge(context,fileWriter);</span><br><span class=\"line\">        <span class=\"comment\">//关闭流</span></span><br><span class=\"line\">        fileWriter.close();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>最终的效果：</p>\n<p>在指定的目录中生成index.html文件</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-23-28.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-23-28.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>打开之后的效果：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-24-07.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-24-07.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h3 id=\"1-3、AI辅助解读Velocity语法\"><a href=\"#1-3、AI辅助解读Velocity语法\" class=\"headerlink\" title=\"1.3、AI辅助解读Velocity语法\"></a>1.3、AI辅助解读Velocity语法</h3><p>大模型解读后的代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Velocity模板开始，定义包名</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.domain;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 循环导入所需的类库</span></span><br><span class=\"line\">#foreach ($<span class=\"keyword\">import</span> in $importList)</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;<span class=\"keyword\">import</span>&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 导入其他必要的类库</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringBuilder;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringStyle;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.annotation.Excel;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.BaseEntity;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.TreeEntity;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;对象 $&#123;tableName&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;BaseEntity&quot;</span>)</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;TreeEntity&quot;</span>)</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义Java类，继承自BaseEntity或TreeEntity</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125; <span class=\"keyword\">extends</span> <span class=\"title class_\">$</span>&#123;Entity&#125;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 序列化版本ID</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 循环定义类中的属性</span></span><br><span class=\"line\">    #foreach ($column in $columns)</span><br><span class=\"line\">    #<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">        <span class=\"comment\">// 添加属性的注释</span></span><br><span class=\"line\">        <span class=\"comment\">/** $column.columnComment */</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 根据属性是否为列表类型，决定是否添加Excel注解</span></span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($column.list)</span><br><span class=\"line\">        #set($parentheseIndex=$column.columnComment.indexOf(<span class=\"string\">&quot;（&quot;</span>))</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">        #set($comment=$column.columnComment.substring(<span class=\"number\">0</span>, $parentheseIndex))</span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        #set($comment=$column.columnComment)</span><br><span class=\"line\">        #end</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\">// 如果属性名中有括号，则截取括号前的内容作为Excel注解的名字</span></span><br><span class=\"line\">        <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, readConverterExp = &quot;$column.readConverterExp()&quot;)</span></span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"comment\">// 如果是日期类型，添加JSON格式化注解</span></span><br><span class=\"line\">        #elseif($column.javaType == <span class=\"string\">&#x27;Date&#x27;</span>)</span><br><span class=\"line\">        <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">        <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, width = 30, dateFormat = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"comment\">// 其他情况直接添加Excel注解</span></span><br><span class=\"line\">        <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;)</span></span><br><span class=\"line\">        #end</span><br><span class=\"line\">        #end</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 定义属性</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> $column.javaType $column.javaField;</span><br><span class=\"line\"></span><br><span class=\"line\">    #end</span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果是子表，添加子表的集合属性</span></span><br><span class=\"line\">    #<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        <span class=\"comment\">/** $table.subTable.functionName信息 */</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List;</span><br><span class=\"line\"></span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成getter和setter方法</span></span><br><span class=\"line\">    #foreach ($column in $columns)</span><br><span class=\"line\">    #<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">        #set($AttrName=$column.javaField)</span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        #set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">        #end</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// setter方法</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;AttrName&#125;($column.javaType $column.javaField)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.$column.javaField = $column.javaField;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// getter方法</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> $column.javaType get$&#123;AttrName&#125;()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> $column.javaField;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    #end</span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果是子表，生成子表集合的getter和setter方法</span></span><br><span class=\"line\">    #<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        <span class=\"keyword\">public</span> List&lt;$&#123;subClassName&#125;&gt; get$&#123;subClassName&#125;List()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> $&#123;subclassName&#125;List;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;subClassName&#125;List(List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.$&#123;subclassName&#125;List = $&#123;subclassName&#125;List;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 重写toString方法</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ToStringBuilder</span>(<span class=\"built_in\">this</span>,ToStringStyle.MULTI_LINE_STYLE)</span><br><span class=\"line\">        #foreach ($column in $columns)</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">        #set($AttrName=$column.javaField)</span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        #set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">        #end</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;column.javaField&#125;&quot;</span>, get$&#123;AttrName&#125;())</span><br><span class=\"line\">        #end</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;subclassName&#125;List&quot;</span>, get$&#123;subClassName&#125;List())</span><br><span class=\"line\">        #end</span><br><span class=\"line\">            .toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Velocity语法解释<ul>\n<li><code>$&#123;variable&#125;</code>: 表示插入变量值。</li>\n<li><code>#foreach</code> 和 <code>#end</code>: 循环结构，用于遍历列表。</li>\n<li><code>#if</code> 和 <code>#end</code>: 条件判断结构。</li>\n<li><code>#set</code>: 设置变量。</li>\n<li><code>#elseif</code>: 条件分支。</li>\n</ul>\n</li>\n<li>Java类结构说明<ul>\n<li>包声明: 定义类所在的包。</li>\n<li>导入语句: 导入类所需要的类库。</li>\n<li>类注释: 描述类的功能和作者信息。</li>\n<li>类定义: 定义类并继承自<code>BaseEntity</code>或<code>TreeEntity</code>。</li>\n<li>属性定义: 根据模板参数定义类的属性。</li>\n<li>属性注释: 对属性进行描述。</li>\n<li>Excel注解: 标记属性以方便导出Excel。</li>\n<li>getter和setter方法: 自动生成属性的访问方法。</li>\n<li>子表集合: 如果是子表，则定义子表集合。</li>\n<li>重写toString方法: 提供类实例的字符串表示形式。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2、代码生成流程\"><a href=\"#2、代码生成流程\" class=\"headerlink\" title=\"2、代码生成流程\"></a>2、代码生成流程</h2><p>目前，我们已经基本熟悉了velocity的作用和一些语法，那接下来，我们就通过这些知识来去改造若依框架的代码生成部分，在改造之前，我们对于生成代码的核心部分来阅读一下</p>\n<p>代码位置：com.zzyl.generator.service.GenTableServiceImpl.generatorCode()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 生成代码</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> tableName 表名</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> zip       压缩输出流</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">generatorCode</span><span class=\"params\">(String tableName, ZipOutputStream zip)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 查询表信息</span></span><br><span class=\"line\">    <span class=\"type\">GenTable</span> <span class=\"variable\">table</span> <span class=\"operator\">=</span> genTableMapper.selectGenTableByName(tableName);</span><br><span class=\"line\">    <span class=\"comment\">// 设置主子表信息</span></span><br><span class=\"line\">    setSubTable(table);</span><br><span class=\"line\">    <span class=\"comment\">// 设置主键列信息</span></span><br><span class=\"line\">    setPkColumn(table);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 初始化Velocity引擎</span></span><br><span class=\"line\">    VelocityInitializer.initVelocity();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 准备Velocity上下文   获取详细的该表的数据，并设置模板所需要的数据模型</span></span><br><span class=\"line\">    <span class=\"type\">VelocityContext</span> <span class=\"variable\">context</span> <span class=\"operator\">=</span> VelocityUtils.prepareContext(table);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 获取模板列表   读取resources/vm目录中的定义的模板文件</span></span><br><span class=\"line\">    List&lt;String&gt; templates = VelocityUtils.getTemplateList(table.getTplCategory(), table.getTplWebType());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String template : templates)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 渲染模板</span></span><br><span class=\"line\">        <span class=\"type\">StringWriter</span> <span class=\"variable\">sw</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringWriter</span>();</span><br><span class=\"line\">        <span class=\"type\">Template</span> <span class=\"variable\">tpl</span> <span class=\"operator\">=</span> Velocity.getTemplate(template, Constants.UTF8);</span><br><span class=\"line\">        <span class=\"comment\">// 合并模板和数据模型</span></span><br><span class=\"line\">        tpl.merge(context, sw);</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 将渲染结果添加到zip文件</span></span><br><span class=\"line\">            zip.putNextEntry(<span class=\"keyword\">new</span> <span class=\"title class_\">ZipEntry</span>(VelocityUtils.getFileName(template, table)));</span><br><span class=\"line\">            IOUtils.write(sw.toString(), zip, Constants.UTF8);</span><br><span class=\"line\">            IOUtils.closeQuietly(sw);</span><br><span class=\"line\">            zip.flush();</span><br><span class=\"line\">            zip.closeEntry();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (IOException e)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 记录日志</span></span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;渲染模板失败，表名：&quot;</span> + table.getTableName(), e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、Lombok集成\"><a href=\"#3、Lombok集成\" class=\"headerlink\" title=\"3、Lombok集成\"></a>3、Lombok集成</h2><h3 id=\"3-1、依赖导入\"><a href=\"#3-1、依赖导入\" class=\"headerlink\" title=\"3.1、依赖导入\"></a>3.1、依赖导入</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">  &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class=\"line\">  &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;version&gt;<span class=\"number\">1.18</span><span class=\"number\">.22</span>&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2、修改模板\"><a href=\"#3-2、修改模板\" class=\"headerlink\" title=\"3.2、修改模板\"></a>3.2、修改模板</h3><p>我们主要修改的模板为 <code>domain.java.vm</code>，让它支持lombok</p>\n<p>修改模板如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.domain;</span><br><span class=\"line\"></span><br><span class=\"line\">#foreach ($<span class=\"keyword\">import</span> in $importList)</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;<span class=\"keyword\">import</span>&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringBuilder;  ## 用不到，可删</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringStyle;  ## 用不到，可删</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.annotation.Excel;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.BaseEntity;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.TreeEntity;</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.Data;  ## 导入lombok的依赖</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;对象 $&#123;tableName&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;BaseEntity&quot;</span>)</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;TreeEntity&quot;</span>)</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"meta\">@Data</span>  ## 添加lombok的注解</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125; <span class=\"keyword\">extends</span> <span class=\"title class_\">$</span>&#123;Entity&#125;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">    <span class=\"comment\">/** $column.columnComment */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.list)</span><br><span class=\"line\">#set($parentheseIndex=$column.columnComment.indexOf(<span class=\"string\">&quot;（&quot;</span>))</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">#set($comment=$column.columnComment.substring(<span class=\"number\">0</span>, $parentheseIndex))</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">#set($comment=$column.columnComment)</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, readConverterExp = &quot;$column.readConverterExp()&quot;)</span></span><br><span class=\"line\">#elseif($column.javaType == <span class=\"string\">&#x27;Date&#x27;</span>)</span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, width = 30, dateFormat = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;)</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"keyword\">private</span> $column.javaType $column.javaField;</span><br><span class=\"line\"></span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"comment\">/** $table.subTable.functionName信息 */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List;</span><br><span class=\"line\"></span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">## 以下是生成属性的get/set方法  start....  删除这部分内容</span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">#set($AttrName=$column.javaField)</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">#set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;AttrName&#125;($column.javaType $column.javaField) </span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.$column.javaField = $column.javaField;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $column.javaType get$&#123;AttrName&#125;() </span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> $column.javaField;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">## 以下是生成属性的get/set方法  end....  删除这部分内容</span><br><span class=\"line\"></span><br><span class=\"line\">## 如果是主子表，生成子表相关的get/set方法，start....  删除这部分内容</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;subClassName&#125;&gt; get$&#123;subClassName&#125;List()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> $&#123;subclassName&#125;List;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;subClassName&#125;List(List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.$&#123;subclassName&#125;List = $&#123;subclassName&#125;List;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">## 如果是主子表，生成子表相关的get/set方法，end....  删除这部分内容</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##以下代码生成 toString方法， start....  删除这部分内容</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ToStringBuilder</span>(<span class=\"built_in\">this</span>,ToStringStyle.MULTI_LINE_STYLE)</span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">#set($AttrName=$column.javaField)</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">#set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">#end</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;column.javaField&#125;&quot;</span>, get$&#123;AttrName&#125;())</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;subclassName&#125;List&quot;</span>, get$&#123;subClassName&#125;List())</span><br><span class=\"line\">#end</span><br><span class=\"line\">            .toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">##以下代码生成 toString方法， end....  删除这部分内容</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-3、生成后的效果\"><a href=\"#3-3、生成后的效果\" class=\"headerlink\" title=\"3.3、生成后的效果\"></a>3.3、生成后的效果</h3><p>修改完成之后，重启项目，找到代码生成的功能，通过<strong>代码预览</strong>可以查看实体类的代码：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-59-09.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-59-09.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<blockquote>\n<ul>\n<li>正常添加了关于lombok的注解</li>\n<li>删除了setter、 getter  、toString 等方法</li>\n</ul>\n</blockquote>\n<p><strong>测试</strong></p>\n<p>可以把生成后的代码，拷贝到项目中，如果护理项目能够正常访问和操作，就算修改成功了，后期再次生成的代码，全部都支持lombok</p>\n<h2 id=\"4、Mybatis-Plus集成\"><a href=\"#4、Mybatis-Plus集成\" class=\"headerlink\" title=\"4、Mybatis-Plus集成\"></a>4、Mybatis-Plus集成</h2><p>我们改造主要参考的是官方推荐的项目：<a href=\"https://gitee.com/tellsea/ruoyi-vue-plus%EF%BC%88%E7%9B%AE%E5%89%8D%E5%B7%B2%E9%9B%86%E6%88%90mybatis-plus%EF%BC%89\">https://gitee.com/tellsea/ruoyi-vue-plus（目前已集成mybatis-plus）</a></p>\n<h3 id=\"4-1、添加依赖\"><a href=\"#4-1、添加依赖\" class=\"headerlink\" title=\"4.1、添加依赖\"></a>4.1、添加依赖</h3><p>在父工程中的pom文件中添加mybatis-plus的依赖，如下：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mybatis-plus-spring-boot.version</span>&gt;</span>3.5.2<span class=\"tag\">&lt;/<span class=\"name\">mybatis-plus-spring-boot.version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 依赖声明 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- mybatis-plus 增强CRUD --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis-plus-spring-boot.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-annotation<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis-plus-spring-boot.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在zzyl-common模块中新增mybatis-plus的依赖</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-annotation<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-2、核心配置\"><a href=\"#4-2、核心配置\" class=\"headerlink\" title=\"4.2、核心配置\"></a>4.2、核心配置</h3><p>appliation.yml文件中新增MyBatisPlus配置，同时<strong>删除Mybatis相关的配置</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># MyBatisPlus配置</span></span><br><span class=\"line\"><span class=\"attr\">mybatis-plus:</span></span><br><span class=\"line\">  <span class=\"comment\"># 搜索指定包别名</span></span><br><span class=\"line\">  <span class=\"attr\">typeAliasesPackage:</span> <span class=\"string\">com.zzyl.**.domain</span></span><br><span class=\"line\">  <span class=\"comment\"># 配置mapper的扫描，找到所有的mapper.xml映射文件</span></span><br><span class=\"line\">  <span class=\"attr\">mapperLocations:</span> <span class=\"string\">classpath*:mapper/**/*Mapper.xml</span></span><br><span class=\"line\">  <span class=\"comment\"># 全局配置</span></span><br><span class=\"line\">  <span class=\"attr\">global-config:</span></span><br><span class=\"line\">    <span class=\"attr\">db-config:</span></span><br><span class=\"line\">      <span class=\"attr\">id-type:</span> <span class=\"string\">auto</span>   <span class=\"comment\">#id生成策略为自增</span></span><br><span class=\"line\">  <span class=\"attr\">configuration:</span> </span><br><span class=\"line\">    <span class=\"attr\">map-underscore-to-camel-case:</span> <span class=\"literal\">true</span>    <span class=\"comment\">#字段与属性，自动转换为驼峰命名</span></span><br></pre></td></tr></table></figure>\n\n<p>新增核心配置类，<strong>删除MyBatisConfig</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.zzyl.framework.config;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.inner.BlockAttackInnerInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.inner.OptimisticLockerInnerInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Mybatis Plus 配置</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> ruoyi</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@EnableTransactionManagement(proxyTargetClass = true)</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MybatisPlusConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> MybatisPlusInterceptor <span class=\"title function_\">mybatisPlusInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">MybatisPlusInterceptor</span> <span class=\"variable\">interceptor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MybatisPlusInterceptor</span>();</span><br><span class=\"line\">        <span class=\"comment\">// 分页插件</span></span><br><span class=\"line\">        interceptor.addInnerInterceptor(paginationInnerInterceptor());</span><br><span class=\"line\">        <span class=\"comment\">// 乐观锁插件</span></span><br><span class=\"line\">        interceptor.addInnerInterceptor(optimisticLockerInnerInterceptor());</span><br><span class=\"line\">        <span class=\"comment\">// 阻断插件</span></span><br><span class=\"line\">        interceptor.addInnerInterceptor(blockAttackInnerInterceptor());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> interceptor;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 分页插件，自动识别数据库类型 https://baomidou.com/guide/interceptor-pagination.html</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> PaginationInnerInterceptor <span class=\"title function_\">paginationInnerInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">PaginationInnerInterceptor</span> <span class=\"variable\">paginationInnerInterceptor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">PaginationInnerInterceptor</span>();</span><br><span class=\"line\">        <span class=\"comment\">// 设置数据库类型为mysql</span></span><br><span class=\"line\">        paginationInnerInterceptor.setDbType(DbType.MYSQL);</span><br><span class=\"line\">        <span class=\"comment\">// 设置最大单页限制数量，默认 500 条，-1 不受限制</span></span><br><span class=\"line\">        paginationInnerInterceptor.setMaxLimit(-<span class=\"number\">1L</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> paginationInnerInterceptor;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 乐观锁插件 https://baomidou.com/guide/interceptor-optimistic-locker.html</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> OptimisticLockerInnerInterceptor <span class=\"title function_\">optimisticLockerInnerInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OptimisticLockerInnerInterceptor</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 如果是对全表的删除或更新操作，就会终止该操作 https://baomidou.com/guide/interceptor-block-attack.html</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> BlockAttackInnerInterceptor <span class=\"title function_\">blockAttackInnerInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BlockAttackInnerInterceptor</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-3、代码生成模板\"><a href=\"#4-3、代码生成模板\" class=\"headerlink\" title=\"4.3、代码生成模板\"></a>4.3、代码生成模板</h3><p>在目前的模板文件中，我们需要修改的模板共有3个，分别是：</p>\n<ul>\n<li>mapper.java.vm   继承BaseMapper </li>\n<li>service.java.vm   继承IService<T> </li>\n<li>serviceImpl.java.vm    继承ServiceImpl&lt;XxxMapper,T&gt;  常见方法的使用（单表的增删改查）</li>\n</ul>\n<blockquote>\n<ul>\n<li>domain.java.vm  无需修改，类名与表名一致，会自动映射，主键已经在yaml文件中配置</li>\n<li>controller.java.vm 无需修改，保留原有的接口方法和命名</li>\n</ul>\n</blockquote>\n<p><strong>mapper.java.vm</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.mapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;subClassName&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Mapper接口</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Mapper</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">$</span>&#123;ClassName&#125;Mapper <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseMapper</span>&lt;$&#123;ClassName&#125;&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;ClassName&#125; select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;集合</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;ClassName&#125;&gt; select$&#123;ClassName&#125;List($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> insert$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> update$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的数据主键集合</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;subTable.functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的数据主键集合</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量新增$&#123;subTable.functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;subclassName&#125;List $&#123;subTable.functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> batch$&#123;subClassName&#125;(List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List);</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过$&#123;functionName&#125;主键删除$&#123;subTable.functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">#end</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>service.java.vm</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Service接口</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">I$</span>&#123;ClassName&#125;Service <span class=\"keyword\">extends</span> <span class=\"title class_\">IService</span>&lt;$&#123;ClassName&#125;&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;ClassName&#125; select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;集合</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;ClassName&#125;&gt; select$&#123;ClassName&#125;List($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> insert$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> update$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的$&#123;functionName&#125;主键集合</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>serviceImpl.java.vm</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.service.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField == <span class=\"string\">&#x27;createTime&#x27;</span> || $column.javaField == <span class=\"string\">&#x27;updateTime&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.DateUtils;</span><br><span class=\"line\">#<span class=\"keyword\">break</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.StringUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;subClassName&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.mapper.$&#123;ClassName&#125;Mapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.service.I$&#123;ClassName&#125;Service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.mapper.$&#123;ClassName&#125;Mapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Service业务层处理</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125;ServiceImpl <span class=\"keyword\">extends</span> <span class=\"title class_\">ServiceImpl</span>&lt;$&#123;ClassName&#125;Mapper, $&#123;ClassName&#125;&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">I$</span>&#123;ClassName&#125;Service</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> $&#123;ClassName&#125;Mapper $&#123;className&#125;Mapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;ClassName&#125; select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ##<span class=\"keyword\">return</span> $&#123;className&#125;Mapper.select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getById($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;ClassName&#125;&gt; select$&#123;ClassName&#125;List($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> insert$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#foreach ($column in $columns)   删除这些 新增的时候，给创建时间赋值</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField == <span class=\"string\">&#x27;createTime&#x27;</span>)</span><br><span class=\"line\">        $&#123;className&#125;.setCreateTime(DateUtils.getNowDate());</span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rows</span> <span class=\"operator\">=</span> $&#123;className&#125;Mapper.insert$&#123;ClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        insert$&#123;subClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rows;</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">        ##<span class=\"keyword\">return</span> $&#123;className&#125;Mapper.insert$&#123;ClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> save($&#123;className&#125;) == <span class=\"literal\">true</span>? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">#end</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> update$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#foreach ($column in $columns)  删除这些，修改的时候给修改时间赋值</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField == <span class=\"string\">&#x27;updateTime&#x27;</span>)</span><br><span class=\"line\">        $&#123;className&#125;.setUpdateTime(DateUtils.getNowDate());</span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        $&#123;className&#125;Mapper.delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;($&#123;className&#125;.get$&#123;pkColumn.capJavaField&#125;());</span><br><span class=\"line\">        insert$&#123;subClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">#end</span><br><span class=\"line\">##        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.update$&#123;ClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> updateById($&#123;className&#125;) == <span class=\"literal\">true</span> ? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的$&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        $&#123;className&#125;Mapper.delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;s($&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">#end</span><br><span class=\"line\">##        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> removeByIds(Arrays.asList($&#123;pkColumn.javaField&#125;s)) == <span class=\"literal\">true</span> ? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        $&#123;className&#125;Mapper.delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">#end</span><br><span class=\"line\">##        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> removeById($&#123;pkColumn.javaField&#125;) == <span class=\"literal\">true</span> ? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;subTable.functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> insert$&#123;subClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List = $&#123;className&#125;.get$&#123;subClassName&#125;List();</span><br><span class=\"line\">        $&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125; = $&#123;className&#125;.get$&#123;pkColumn.capJavaField&#125;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (StringUtils.isNotNull($&#123;subclassName&#125;List))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            List&lt;$&#123;subClassName&#125;&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;$&#123;subClassName&#125;&gt;();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> ($&#123;subClassName&#125; $&#123;subclassName&#125; : $&#123;subclassName&#125;List)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                $&#123;subclassName&#125;.set$&#123;subTableFkClassName&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">                list.add($&#123;subclassName&#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (list.size() &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                $&#123;className&#125;Mapper.batch$&#123;subClassName&#125;(list);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#end</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>其他必要修改</strong></p>\n<p>集成MP之后，项目中的BaseEntity类中的字段有些会受影响，需要添加如下注解</p>\n<p>由于这几个字段，并不会跟数据库中的表字段进行映射，必须要添加@TableField(exist &#x3D; false)表示，表示该字段不存在于数据库表中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Entity基类</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> ruoyi</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BaseEntity</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 搜索值 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String searchValue;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 请求参数 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonInclude(JsonInclude.Include.NON_EMPTY)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, Object&gt; params;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-4、字段自动填充\"><a href=\"#4-4、字段自动填充\" class=\"headerlink\" title=\"4.4、字段自动填充\"></a>4.4、字段自动填充</h3><p>MyBatis-Plus 提供的字段自动填充功能是一种非常实用的特性，它能够在插入或更新数据库记录时自动填充一些公共字段，如创建时间（createTime）、更新时间（updateTime）、创建人（createBy）、更新人（updateBy）等。这一功能极大地简化了开发过程，减少了重复的代码编写，提高了开发效率。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-06-29.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-06-29.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>官网链接：<a href=\"https://mybatis.plus/guide/auto-fill-metainfo.html%EF%BC%88%E5%8F%AF%E8%83%BD%E6%89%93%E4%B8%8D%E5%BC%80%EF%BC%8C%E5%AE%98%E7%BD%91%E6%9C%AC%E8%BA%AB%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%89\">https://mybatis.plus/guide/auto-fill-metainfo.html（可能打不开，官网本身的问题）</a></p>\n<p>在MybatisPlus中通过两步可以实现这个功能：</p>\n<p>1、在实体类中，使用<code>@TableField</code>注解，来标明哪些字段是需要自动填充的，并且需要指定填充策略</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.zzyl.common.core.domain;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.Serializable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.FieldFill;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.fasterxml.jackson.annotation.JsonFormat;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.fasterxml.jackson.annotation.JsonInclude;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiModel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Entity基类</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> ruoyi</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@ApiModel(&quot;Entity基类&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BaseEntity</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 搜索值 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String searchValue;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 创建者 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;创建者&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.INSERT)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String createBy;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 创建时间 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;创建时间&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.INSERT)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date createTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 更新者 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;更新者&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.UPDATE)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String updateBy;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 更新时间 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;更新时间&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.UPDATE)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date updateTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 备注 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;备注&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String remark;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 请求参数 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonInclude(JsonInclude.Include.NON_EMPTY)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;请求参数&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, Object&gt; params;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>2、在zzyl-framework模块中新增MyMetaObjectHandler 来处理自动自动填充</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-07-54.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-07-54.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>详细的代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.zzyl.framework.interceptor;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.model.LoginUser;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.SecurityUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.ObjectUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.reflection.MetaObject;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyMetaObjectHandler</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">MetaObjectHandler</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insertFill</span><span class=\"params\">(MetaObject metaObject)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictInsertFill(metaObject, <span class=\"string\">&quot;createTime&quot;</span>, Date.class, <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictInsertFill(metaObject, <span class=\"string\">&quot;createBy&quot;</span>, String.class, loadUserId()+<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">updateFill</span><span class=\"params\">(MetaObject metaObject)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictUpdateFill(metaObject, <span class=\"string\">&quot;updateTime&quot;</span>, Date.class, <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictUpdateFill(metaObject, <span class=\"string\">&quot;updateBy&quot;</span>, String.class, loadUserId()+<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取当前登录人的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Long <span class=\"title function_\">loadUserId</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//获取当前登录人的id</span></span><br><span class=\"line\">        <span class=\"type\">LoginUser</span> <span class=\"variable\">loginUser</span> <span class=\"operator\">=</span> SecurityUtils.getLoginUser();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(ObjectUtils.isNotEmpty(loginUser))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> loginUser.getUserId();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5、Swagger集成\"><a href=\"#5、Swagger集成\" class=\"headerlink\" title=\"5、Swagger集成\"></a>5、Swagger集成</h2><p>在我们定义的所有controller中，为了更好的体现接口文档，我们都需要添加swagger注解才可以。这些注解我们也可以通过代码的模板来生成，节省我们的开发工作</p>\n<p>我们主要的工作就是来修改<strong>controller.java.vm</strong>文件即可，具体的修改的内容如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.Api;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiOperation;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiParam;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.security.access.prepost.PreAuthorize;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.DeleteMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.annotation.Log;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.controller.BaseController;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.AjaxResult;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.enums.BusinessType;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.service.I$&#123;ClassName&#125;Service;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.poi.ExcelUtil;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.page.TableDataInfo;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Controller</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/$&#123;moduleName&#125;/$&#123;businessName&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Api(tags =  &quot;$&#123;functionName&#125;相关接口&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125;Controller <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseController</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> I$&#123;ClassName&#125;Service $&#123;className&#125;Service;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:list&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/list&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;查询$&#123;functionName&#125;列表&quot;)</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\">    <span class=\"keyword\">public</span> TableDataInfo <span class=\"title function_\">list</span><span class=\"params\">($&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        startPage();</span><br><span class=\"line\">        List&lt;$&#123;ClassName&#125;&gt; list = $&#123;className&#125;Service.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getDataTable(list);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">list</span><span class=\"params\">($&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        List&lt;$&#123;ClassName&#125;&gt; list = $&#123;className&#125;Service.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(list);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 导出$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:export&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.EXPORT)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/export&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;导出$&#123;functionName&#125;列表&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">export</span><span class=\"params\">(HttpServletResponse response, $&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        List&lt;$&#123;ClassName&#125;&gt; list = $&#123;className&#125;Service.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">        ExcelUtil&lt;$&#123;ClassName&#125;&gt; util = <span class=\"keyword\">new</span> <span class=\"title class_\">ExcelUtil</span>&lt;$&#123;ClassName&#125;&gt;($&#123;ClassName&#125;.class);</span><br><span class=\"line\">        util.exportExcel(response, list, <span class=\"string\">&quot;$&#123;functionName&#125;数据&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取$&#123;functionName&#125;详细信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:query&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(value = &quot;/&#123;$&#123;pkColumn.javaField&#125;&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;获取$&#123;functionName&#125;详细信息&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">getInfo</span><span class=\"params\">(<span class=\"meta\">@ApiParam(value = &quot;$&#123;functionName&#125;ID&quot;, required = true)</span></span></span><br><span class=\"line\"><span class=\"params\">                                  <span class=\"meta\">@PathVariable(&quot;$&#123;pkColumn.javaField&#125;&quot;)</span> $&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success($&#123;className&#125;Service.select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaField&#125;));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:add&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.INSERT)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;新增$&#123;functionName&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"meta\">@ApiParam(value = &quot;$&#123;functionName&#125;实体&quot;, required = true)</span> <span class=\"meta\">@RequestBody</span> $&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> toAjax($&#123;className&#125;Service.insert$&#123;ClassName&#125;($&#123;className&#125;));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:edit&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.UPDATE)</span></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;修改$&#123;functionName&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">edit</span><span class=\"params\">(<span class=\"meta\">@ApiParam(value = &quot;$&#123;functionName&#125;实体&quot;, required = true)</span>  <span class=\"meta\">@RequestBody</span> $&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> toAjax($&#123;className&#125;Service.update$&#123;ClassName&#125;($&#123;className&#125;));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:remove&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.DELETE)</span></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping(&quot;/&#123;$&#123;pkColumn.javaField&#125;s&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;删除$&#123;functionName&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">remove</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> $&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> toAjax($&#123;className&#125;Service.delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaField&#125;s));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>重启服务之后，我们可以预览生成后的效果：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-18-37.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-18-37.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<h2 id=\"6、由Date类型改为LocalDateTime\"><a href=\"#6、由Date类型改为LocalDateTime\" class=\"headerlink\" title=\"6、由Date类型改为LocalDateTime\"></a>6、由Date类型改为LocalDateTime</h2><p>若依目前提供的代码中，如果遇到日期类型则使用的是Date，由于目前使用比较流行的是LocalDateTime类型，我们也可以把它改为该类型进行使用</p>\n<blockquote>\n<p><strong>知识扩展</strong></p>\n<p>Date类型与LocalDateTime的区别？</p>\n<ol>\n<li>不可变性与线程安全性 <ol>\n<li>Date一旦创建Date对象，可以通过setTime(long time)进行修改，多线程下存在线程安全问题</li>\n<li>LocalDateTime是不可变的，线程安全</li>\n</ol>\n</li>\n<li>时间精度<ol>\n<li>Date可以表示到毫秒的时间值</li>\n<li>LocalDateTime可以表示到纳秒的时间值</li>\n</ol>\n</li>\n<li>易用性：LocalDateTime的API设计的更现代化，易于使用</li>\n</ol>\n</blockquote>\n<p>在目前代码生成中，其中字段详细这一栏中的Java类型并不支持LocalDateTime类型，所以我们需要在前端也要修改其内容，让它支持LocalDateTime</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-12.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-12.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>打开前端项目，找到src&#x2F;views&#x2F;tool&#x2F;gen&#x2F;editTable.vue文件，在这个文件添加中以上一行代码，如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-23.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-23.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n<p>当前端选择了LocalDateTime类型之后，在后端的代码生成中，需要导入对应的包才可以，后端的代码也需要修改</p>\n<p>我们打开VelocityUtils类，这里面有处理导入包的逻辑，找到getImportList方法，在其中添加对应的包导入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * 根据列类型获取导入包</span><br><span class=\"line\"> * </span><br><span class=\"line\"> * @param genTable 业务表对象</span><br><span class=\"line\"> * @return 返回需要导入的包列表</span><br><span class=\"line\"> */</span><br><span class=\"line\">public static HashSet&lt;String&gt; getImportList(GenTable genTable)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    List&lt;GenTableColumn&gt; columns = genTable.getColumns();</span><br><span class=\"line\">    GenTable subGenTable = genTable.getSubTable();</span><br><span class=\"line\">    HashSet&lt;String&gt; importList = new HashSet&lt;String&gt;();</span><br><span class=\"line\">    if (StringUtils.isNotNull(subGenTable))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        importList.add(&quot;java.util.List&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    for (GenTableColumn column : columns)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if (!column.isSuperColumn() &amp;&amp; GenConstants.TYPE_DATE.equals(column.getJavaType()))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            importList.add(&quot;java.util.Date&quot;);</span><br><span class=\"line\">            importList.add(&quot;com.fasterxml.jackson.annotation.JsonFormat&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else if (!column.isSuperColumn() &amp;&amp; GenConstants.TYPE_BIGDECIMAL.equals(column.getJavaType()))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            importList.add(&quot;java.math.BigDecimal&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        //加入下面这些功能</span><br><span class=\"line\">        // 如果字段类型在前端选择的是LocalDateTime，则导入对应的包</span><br><span class=\"line\">        if (!column.isSuperColumn() &amp;&amp; &quot;LocalDateTime&quot;.equals(column.getJavaType()))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            importList.add(&quot;java.time.LocalDateTime&quot;);</span><br><span class=\"line\">            //导入这个是为了格式化日期</span><br><span class=\"line\">            importList.add(&quot;com.fasterxml.jackson.annotation.JsonFormat&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return importList;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>修改模块文件domain.java.vm文件，修改的内容如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-22-43.jpg\" class=\"lazyload\" data-srcset=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-22-43.jpg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"></p>\n","excerpt":"","more":"<h1 id=\"若依框架中使用Velocity模块引擎改造代码生成功能\"><a href=\"#若依框架中使用Velocity模块引擎改造代码生成功能\" class=\"headerlink\" title=\"若依框架中使用Velocity模块引擎改造代码生成功能\"></a>若依框架中使用Velocity模块引擎改造代码生成功能</h1><ul>\n<li>支持mybatis-plus</li>\n<li>支持Lombok</li>\n<li>支持Swagger自动添加</li>\n<li>支持LocalDateTime</li>\n</ul>\n<p>在若依框架中，主要生成代码的模块是zzyl-generator模块</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/image.png\"></p>\n<p>上述代码中，以<code>vm</code>为后缀的文件，其实是velocity模板引擎的对应的模板文件，如果想要改造代码生成的内容，我们必须要先学习velocity，而后再来看懂这些代码，才能支撑我们去改造这些模板文件，来生成我们想要的内容</p>\n<h2 id=\"1、Velocity模块引擎\"><a href=\"#1、Velocity模块引擎\" class=\"headerlink\" title=\"1、Velocity模块引擎\"></a>1、Velocity模块引擎</h2><h3 id=\"1-1、概述\"><a href=\"#1-1、概述\" class=\"headerlink\" title=\"1.1、概述\"></a>1.1、概述</h3><p>Velocity是一个基于Java的模板引擎，可以通过特定的语法获取在java对象的数据 , 填充到模板中，从而实现界面和java代码的分离 !</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-17-40.jpg\"></p>\n<p>常见的应用场景：</p>\n<ul>\n<li>Web应用程序 : 作为为应用程序的视图, 展示数据。</li>\n<li>源代码生成  : Velocity可用于基于模板生成Java源代码。</li>\n<li>自动电子邮件 : 网站注册 , 认证等的电子邮件模板。</li>\n<li>网页静态化  : 基于velocity模板 , 生成静态网页。</li>\n</ul>\n<h3 id=\"1-2、快速入门\"><a href=\"#1-2、快速入门\" class=\"headerlink\" title=\"1.2、快速入门\"></a>1.2、快速入门</h3><p>需求：根据下面html模板，完成对数据的填充</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>velocity快速入门<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>心怀梦想，坚持不懈，成功即在前方。加油少年！<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>要求：<strong>加油少年，</strong>这几个字，需要使用动态填充进来</li>\n</ul>\n<p><strong>入门案例实现步骤</strong></p>\n<p>①准备模板</p>\n<p>把上面提供的html文档，拷贝一份到若依项目中的ruoyi-generator模块下的reources目录中</p>\n<p>模板文件命名：<code>index.html.vm</code></p>\n<p>如下图</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/e44ce461-6e3a-427f-acdb-78fc53d9db12.png\"></p>\n<p>模板文件内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>velocity快速入门<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>心怀梦想，坚持不懈，成功即在前方。$&#123;message&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意</strong>：上述代码中的 加油少年  修改为了  ${message}  这是一个动态变量，方便<strong>动态</strong>填充数据</p>\n<p>②编写java代码实现数据填充，并生成文件</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.ruoyi.common.constant.Constants;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.velocity.Template;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.velocity.VelocityContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.velocity.app.Velocity;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileWriter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VelocityDemoTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Properties</span> <span class=\"variable\">p</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Properties</span>();</span><br><span class=\"line\">        <span class=\"comment\">//velocity资源加载器，告诉模板引擎到类路径下寻找资源（比如模板）</span></span><br><span class=\"line\">        p.setProperty(<span class=\"string\">&quot;resource.loader.file.class&quot;</span>, <span class=\"string\">&quot;org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 定义字符集</span></span><br><span class=\"line\">        p.setProperty(Velocity.INPUT_ENCODING, Constants.UTF8);</span><br><span class=\"line\">        <span class=\"comment\">//初始化velocity引擎</span></span><br><span class=\"line\">        Velocity.init(p);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//创建velocity上下文对象</span></span><br><span class=\"line\">        <span class=\"type\">VelocityContext</span> <span class=\"variable\">context</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">VelocityContext</span>();</span><br><span class=\"line\">        <span class=\"comment\">//数据模型，这里的key需要跟模板中的变量对应上，不然填充不了数据</span></span><br><span class=\"line\">        context.put(<span class=\"string\">&quot;message&quot;</span>, <span class=\"string\">&quot;加油朋友！！！&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//获取模板</span></span><br><span class=\"line\">        <span class=\"type\">Template</span> <span class=\"variable\">template</span> <span class=\"operator\">=</span> Velocity.getTemplate(<span class=\"string\">&quot;vms/index.html.vm&quot;</span>, <span class=\"string\">&quot;UTF-8&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//输出</span></span><br><span class=\"line\">        <span class=\"type\">FileWriter</span> <span class=\"variable\">fileWriter</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileWriter</span>(<span class=\"string\">&quot;D:\\\\workspace\\\\index.html&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//合并模板和数据模型</span></span><br><span class=\"line\">        template.merge(context,fileWriter);</span><br><span class=\"line\">        <span class=\"comment\">//关闭流</span></span><br><span class=\"line\">        fileWriter.close();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>最终的效果：</p>\n<p>在指定的目录中生成index.html文件</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-23-28.jpg\"></p>\n<p>打开之后的效果：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-24-07.jpg\"></p>\n<h3 id=\"1-3、AI辅助解读Velocity语法\"><a href=\"#1-3、AI辅助解读Velocity语法\" class=\"headerlink\" title=\"1.3、AI辅助解读Velocity语法\"></a>1.3、AI辅助解读Velocity语法</h3><p>大模型解读后的代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Velocity模板开始，定义包名</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.domain;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 循环导入所需的类库</span></span><br><span class=\"line\">#foreach ($<span class=\"keyword\">import</span> in $importList)</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;<span class=\"keyword\">import</span>&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 导入其他必要的类库</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringBuilder;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringStyle;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.annotation.Excel;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.BaseEntity;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.TreeEntity;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;对象 $&#123;tableName&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;BaseEntity&quot;</span>)</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;TreeEntity&quot;</span>)</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义Java类，继承自BaseEntity或TreeEntity</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125; <span class=\"keyword\">extends</span> <span class=\"title class_\">$</span>&#123;Entity&#125;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 序列化版本ID</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 循环定义类中的属性</span></span><br><span class=\"line\">    #foreach ($column in $columns)</span><br><span class=\"line\">    #<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">        <span class=\"comment\">// 添加属性的注释</span></span><br><span class=\"line\">        <span class=\"comment\">/** $column.columnComment */</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 根据属性是否为列表类型，决定是否添加Excel注解</span></span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($column.list)</span><br><span class=\"line\">        #set($parentheseIndex=$column.columnComment.indexOf(<span class=\"string\">&quot;（&quot;</span>))</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">        #set($comment=$column.columnComment.substring(<span class=\"number\">0</span>, $parentheseIndex))</span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        #set($comment=$column.columnComment)</span><br><span class=\"line\">        #end</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\">// 如果属性名中有括号，则截取括号前的内容作为Excel注解的名字</span></span><br><span class=\"line\">        <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, readConverterExp = &quot;$column.readConverterExp()&quot;)</span></span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"comment\">// 如果是日期类型，添加JSON格式化注解</span></span><br><span class=\"line\">        #elseif($column.javaType == <span class=\"string\">&#x27;Date&#x27;</span>)</span><br><span class=\"line\">        <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">        <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, width = 30, dateFormat = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"comment\">// 其他情况直接添加Excel注解</span></span><br><span class=\"line\">        <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;)</span></span><br><span class=\"line\">        #end</span><br><span class=\"line\">        #end</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 定义属性</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> $column.javaType $column.javaField;</span><br><span class=\"line\"></span><br><span class=\"line\">    #end</span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果是子表，添加子表的集合属性</span></span><br><span class=\"line\">    #<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        <span class=\"comment\">/** $table.subTable.functionName信息 */</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List;</span><br><span class=\"line\"></span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 生成getter和setter方法</span></span><br><span class=\"line\">    #foreach ($column in $columns)</span><br><span class=\"line\">    #<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">        #set($AttrName=$column.javaField)</span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        #set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">        #end</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// setter方法</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;AttrName&#125;($column.javaType $column.javaField)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.$column.javaField = $column.javaField;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// getter方法</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> $column.javaType get$&#123;AttrName&#125;()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> $column.javaField;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    #end</span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果是子表，生成子表集合的getter和setter方法</span></span><br><span class=\"line\">    #<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        <span class=\"keyword\">public</span> List&lt;$&#123;subClassName&#125;&gt; get$&#123;subClassName&#125;List()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> $&#123;subclassName&#125;List;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;subClassName&#125;List(List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.$&#123;subclassName&#125;List = $&#123;subclassName&#125;List;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 重写toString方法</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ToStringBuilder</span>(<span class=\"built_in\">this</span>,ToStringStyle.MULTI_LINE_STYLE)</span><br><span class=\"line\">        #foreach ($column in $columns)</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">        #set($AttrName=$column.javaField)</span><br><span class=\"line\">        #<span class=\"keyword\">else</span></span><br><span class=\"line\">        #set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">        #end</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;column.javaField&#125;&quot;</span>, get$&#123;AttrName&#125;())</span><br><span class=\"line\">        #end</span><br><span class=\"line\">        #<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;subclassName&#125;List&quot;</span>, get$&#123;subClassName&#125;List())</span><br><span class=\"line\">        #end</span><br><span class=\"line\">            .toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Velocity语法解释<ul>\n<li><code>$&#123;variable&#125;</code>: 表示插入变量值。</li>\n<li><code>#foreach</code> 和 <code>#end</code>: 循环结构，用于遍历列表。</li>\n<li><code>#if</code> 和 <code>#end</code>: 条件判断结构。</li>\n<li><code>#set</code>: 设置变量。</li>\n<li><code>#elseif</code>: 条件分支。</li>\n</ul>\n</li>\n<li>Java类结构说明<ul>\n<li>包声明: 定义类所在的包。</li>\n<li>导入语句: 导入类所需要的类库。</li>\n<li>类注释: 描述类的功能和作者信息。</li>\n<li>类定义: 定义类并继承自<code>BaseEntity</code>或<code>TreeEntity</code>。</li>\n<li>属性定义: 根据模板参数定义类的属性。</li>\n<li>属性注释: 对属性进行描述。</li>\n<li>Excel注解: 标记属性以方便导出Excel。</li>\n<li>getter和setter方法: 自动生成属性的访问方法。</li>\n<li>子表集合: 如果是子表，则定义子表集合。</li>\n<li>重写toString方法: 提供类实例的字符串表示形式。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2、代码生成流程\"><a href=\"#2、代码生成流程\" class=\"headerlink\" title=\"2、代码生成流程\"></a>2、代码生成流程</h2><p>目前，我们已经基本熟悉了velocity的作用和一些语法，那接下来，我们就通过这些知识来去改造若依框架的代码生成部分，在改造之前，我们对于生成代码的核心部分来阅读一下</p>\n<p>代码位置：com.zzyl.generator.service.GenTableServiceImpl.generatorCode()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 生成代码</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> tableName 表名</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> zip       压缩输出流</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">generatorCode</span><span class=\"params\">(String tableName, ZipOutputStream zip)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 查询表信息</span></span><br><span class=\"line\">    <span class=\"type\">GenTable</span> <span class=\"variable\">table</span> <span class=\"operator\">=</span> genTableMapper.selectGenTableByName(tableName);</span><br><span class=\"line\">    <span class=\"comment\">// 设置主子表信息</span></span><br><span class=\"line\">    setSubTable(table);</span><br><span class=\"line\">    <span class=\"comment\">// 设置主键列信息</span></span><br><span class=\"line\">    setPkColumn(table);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 初始化Velocity引擎</span></span><br><span class=\"line\">    VelocityInitializer.initVelocity();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 准备Velocity上下文   获取详细的该表的数据，并设置模板所需要的数据模型</span></span><br><span class=\"line\">    <span class=\"type\">VelocityContext</span> <span class=\"variable\">context</span> <span class=\"operator\">=</span> VelocityUtils.prepareContext(table);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 获取模板列表   读取resources/vm目录中的定义的模板文件</span></span><br><span class=\"line\">    List&lt;String&gt; templates = VelocityUtils.getTemplateList(table.getTplCategory(), table.getTplWebType());</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (String template : templates)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 渲染模板</span></span><br><span class=\"line\">        <span class=\"type\">StringWriter</span> <span class=\"variable\">sw</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringWriter</span>();</span><br><span class=\"line\">        <span class=\"type\">Template</span> <span class=\"variable\">tpl</span> <span class=\"operator\">=</span> Velocity.getTemplate(template, Constants.UTF8);</span><br><span class=\"line\">        <span class=\"comment\">// 合并模板和数据模型</span></span><br><span class=\"line\">        tpl.merge(context, sw);</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 将渲染结果添加到zip文件</span></span><br><span class=\"line\">            zip.putNextEntry(<span class=\"keyword\">new</span> <span class=\"title class_\">ZipEntry</span>(VelocityUtils.getFileName(template, table)));</span><br><span class=\"line\">            IOUtils.write(sw.toString(), zip, Constants.UTF8);</span><br><span class=\"line\">            IOUtils.closeQuietly(sw);</span><br><span class=\"line\">            zip.flush();</span><br><span class=\"line\">            zip.closeEntry();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (IOException e)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 记录日志</span></span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;渲染模板失败，表名：&quot;</span> + table.getTableName(), e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、Lombok集成\"><a href=\"#3、Lombok集成\" class=\"headerlink\" title=\"3、Lombok集成\"></a>3、Lombok集成</h2><h3 id=\"3-1、依赖导入\"><a href=\"#3-1、依赖导入\" class=\"headerlink\" title=\"3.1、依赖导入\"></a>3.1、依赖导入</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">  &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class=\"line\">  &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;version&gt;<span class=\"number\">1.18</span><span class=\"number\">.22</span>&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2、修改模板\"><a href=\"#3-2、修改模板\" class=\"headerlink\" title=\"3.2、修改模板\"></a>3.2、修改模板</h3><p>我们主要修改的模板为 <code>domain.java.vm</code>，让它支持lombok</p>\n<p>修改模板如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.domain;</span><br><span class=\"line\"></span><br><span class=\"line\">#foreach ($<span class=\"keyword\">import</span> in $importList)</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;<span class=\"keyword\">import</span>&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringBuilder;  ## 用不到，可删</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.builder.ToStringStyle;  ## 用不到，可删</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.annotation.Excel;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.BaseEntity;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.TreeEntity;</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.Data;  ## 导入lombok的依赖</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;对象 $&#123;tableName&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;BaseEntity&quot;</span>)</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">#set($Entity=<span class=\"string\">&quot;TreeEntity&quot;</span>)</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"meta\">@Data</span>  ## 添加lombok的注解</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125; <span class=\"keyword\">extends</span> <span class=\"title class_\">$</span>&#123;Entity&#125;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">    <span class=\"comment\">/** $column.columnComment */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.list)</span><br><span class=\"line\">#set($parentheseIndex=$column.columnComment.indexOf(<span class=\"string\">&quot;（&quot;</span>))</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">#set($comment=$column.columnComment.substring(<span class=\"number\">0</span>, $parentheseIndex))</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">#set($comment=$column.columnComment)</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($parentheseIndex != -<span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, readConverterExp = &quot;$column.readConverterExp()&quot;)</span></span><br><span class=\"line\">#elseif($column.javaType == <span class=\"string\">&#x27;Date&#x27;</span>)</span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;, width = 30, dateFormat = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;$&#123;comment&#125;&quot;)</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"keyword\">private</span> $column.javaType $column.javaField;</span><br><span class=\"line\"></span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"comment\">/** $table.subTable.functionName信息 */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List;</span><br><span class=\"line\"></span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">## 以下是生成属性的get/set方法  start....  删除这部分内容</span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>(!$table.isSuperColumn($column.javaField))</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">#set($AttrName=$column.javaField)</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">#set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;AttrName&#125;($column.javaType $column.javaField) </span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.$column.javaField = $column.javaField;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $column.javaType get$&#123;AttrName&#125;() </span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> $column.javaField;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">## 以下是生成属性的get/set方法  end....  删除这部分内容</span><br><span class=\"line\"></span><br><span class=\"line\">## 如果是主子表，生成子表相关的get/set方法，start....  删除这部分内容</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;subClassName&#125;&gt; get$&#123;subClassName&#125;List()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> $&#123;subclassName&#125;List;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> set$&#123;subClassName&#125;List(List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.$&#123;subclassName&#125;List = $&#123;subclassName&#125;List;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">## 如果是主子表，生成子表相关的get/set方法，end....  删除这部分内容</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##以下代码生成 toString方法， start....  删除这部分内容</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ToStringBuilder</span>(<span class=\"built_in\">this</span>,ToStringStyle.MULTI_LINE_STYLE)</span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField.length() &gt; <span class=\"number\">2</span> &amp;&amp; $column.javaField.substring(<span class=\"number\">1</span>,<span class=\"number\">2</span>).matches(<span class=\"string\">&quot;[A-Z]&quot;</span>))</span><br><span class=\"line\">#set($AttrName=$column.javaField)</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">#set($AttrName=$column.javaField.substring(<span class=\"number\">0</span>,<span class=\"number\">1</span>).toUpperCase() + $&#123;column.javaField.substring(<span class=\"number\">1</span>)&#125;)</span><br><span class=\"line\">#end</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;column.javaField&#125;&quot;</span>, get$&#123;AttrName&#125;())</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">            .append(<span class=\"string\">&quot;$&#123;subclassName&#125;List&quot;</span>, get$&#123;subClassName&#125;List())</span><br><span class=\"line\">#end</span><br><span class=\"line\">            .toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">##以下代码生成 toString方法， end....  删除这部分内容</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-3、生成后的效果\"><a href=\"#3-3、生成后的效果\" class=\"headerlink\" title=\"3.3、生成后的效果\"></a>3.3、生成后的效果</h3><p>修改完成之后，重启项目，找到代码生成的功能，通过<strong>代码预览</strong>可以查看实体类的代码：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_14-59-09.jpg\"></p>\n<blockquote>\n<ul>\n<li>正常添加了关于lombok的注解</li>\n<li>删除了setter、 getter  、toString 等方法</li>\n</ul>\n</blockquote>\n<p><strong>测试</strong></p>\n<p>可以把生成后的代码，拷贝到项目中，如果护理项目能够正常访问和操作，就算修改成功了，后期再次生成的代码，全部都支持lombok</p>\n<h2 id=\"4、Mybatis-Plus集成\"><a href=\"#4、Mybatis-Plus集成\" class=\"headerlink\" title=\"4、Mybatis-Plus集成\"></a>4、Mybatis-Plus集成</h2><p>我们改造主要参考的是官方推荐的项目：<a href=\"https://gitee.com/tellsea/ruoyi-vue-plus%EF%BC%88%E7%9B%AE%E5%89%8D%E5%B7%B2%E9%9B%86%E6%88%90mybatis-plus%EF%BC%89\">https://gitee.com/tellsea/ruoyi-vue-plus（目前已集成mybatis-plus）</a></p>\n<h3 id=\"4-1、添加依赖\"><a href=\"#4-1、添加依赖\" class=\"headerlink\" title=\"4.1、添加依赖\"></a>4.1、添加依赖</h3><p>在父工程中的pom文件中添加mybatis-plus的依赖，如下：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mybatis-plus-spring-boot.version</span>&gt;</span>3.5.2<span class=\"tag\">&lt;/<span class=\"name\">mybatis-plus-spring-boot.version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 依赖声明 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- mybatis-plus 增强CRUD --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis-plus-spring-boot.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-annotation<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis-plus-spring-boot.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在zzyl-common模块中新增mybatis-plus的依赖</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-annotation<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-2、核心配置\"><a href=\"#4-2、核心配置\" class=\"headerlink\" title=\"4.2、核心配置\"></a>4.2、核心配置</h3><p>appliation.yml文件中新增MyBatisPlus配置，同时<strong>删除Mybatis相关的配置</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># MyBatisPlus配置</span></span><br><span class=\"line\"><span class=\"attr\">mybatis-plus:</span></span><br><span class=\"line\">  <span class=\"comment\"># 搜索指定包别名</span></span><br><span class=\"line\">  <span class=\"attr\">typeAliasesPackage:</span> <span class=\"string\">com.zzyl.**.domain</span></span><br><span class=\"line\">  <span class=\"comment\"># 配置mapper的扫描，找到所有的mapper.xml映射文件</span></span><br><span class=\"line\">  <span class=\"attr\">mapperLocations:</span> <span class=\"string\">classpath*:mapper/**/*Mapper.xml</span></span><br><span class=\"line\">  <span class=\"comment\"># 全局配置</span></span><br><span class=\"line\">  <span class=\"attr\">global-config:</span></span><br><span class=\"line\">    <span class=\"attr\">db-config:</span></span><br><span class=\"line\">      <span class=\"attr\">id-type:</span> <span class=\"string\">auto</span>   <span class=\"comment\">#id生成策略为自增</span></span><br><span class=\"line\">  <span class=\"attr\">configuration:</span> </span><br><span class=\"line\">    <span class=\"attr\">map-underscore-to-camel-case:</span> <span class=\"literal\">true</span>    <span class=\"comment\">#字段与属性，自动转换为驼峰命名</span></span><br></pre></td></tr></table></figure>\n\n<p>新增核心配置类，<strong>删除MyBatisConfig</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.zzyl.framework.config;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.inner.BlockAttackInnerInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.inner.OptimisticLockerInnerInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Mybatis Plus 配置</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> ruoyi</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@EnableTransactionManagement(proxyTargetClass = true)</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MybatisPlusConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> MybatisPlusInterceptor <span class=\"title function_\">mybatisPlusInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">MybatisPlusInterceptor</span> <span class=\"variable\">interceptor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MybatisPlusInterceptor</span>();</span><br><span class=\"line\">        <span class=\"comment\">// 分页插件</span></span><br><span class=\"line\">        interceptor.addInnerInterceptor(paginationInnerInterceptor());</span><br><span class=\"line\">        <span class=\"comment\">// 乐观锁插件</span></span><br><span class=\"line\">        interceptor.addInnerInterceptor(optimisticLockerInnerInterceptor());</span><br><span class=\"line\">        <span class=\"comment\">// 阻断插件</span></span><br><span class=\"line\">        interceptor.addInnerInterceptor(blockAttackInnerInterceptor());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> interceptor;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 分页插件，自动识别数据库类型 https://baomidou.com/guide/interceptor-pagination.html</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> PaginationInnerInterceptor <span class=\"title function_\">paginationInnerInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">PaginationInnerInterceptor</span> <span class=\"variable\">paginationInnerInterceptor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">PaginationInnerInterceptor</span>();</span><br><span class=\"line\">        <span class=\"comment\">// 设置数据库类型为mysql</span></span><br><span class=\"line\">        paginationInnerInterceptor.setDbType(DbType.MYSQL);</span><br><span class=\"line\">        <span class=\"comment\">// 设置最大单页限制数量，默认 500 条，-1 不受限制</span></span><br><span class=\"line\">        paginationInnerInterceptor.setMaxLimit(-<span class=\"number\">1L</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> paginationInnerInterceptor;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 乐观锁插件 https://baomidou.com/guide/interceptor-optimistic-locker.html</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> OptimisticLockerInnerInterceptor <span class=\"title function_\">optimisticLockerInnerInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OptimisticLockerInnerInterceptor</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 如果是对全表的删除或更新操作，就会终止该操作 https://baomidou.com/guide/interceptor-block-attack.html</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> BlockAttackInnerInterceptor <span class=\"title function_\">blockAttackInnerInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BlockAttackInnerInterceptor</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-3、代码生成模板\"><a href=\"#4-3、代码生成模板\" class=\"headerlink\" title=\"4.3、代码生成模板\"></a>4.3、代码生成模板</h3><p>在目前的模板文件中，我们需要修改的模板共有3个，分别是：</p>\n<ul>\n<li>mapper.java.vm   继承BaseMapper </li>\n<li>service.java.vm   继承IService<T> </li>\n<li>serviceImpl.java.vm    继承ServiceImpl&lt;XxxMapper,T&gt;  常见方法的使用（单表的增删改查）</li>\n</ul>\n<blockquote>\n<ul>\n<li>domain.java.vm  无需修改，类名与表名一致，会自动映射，主键已经在yaml文件中配置</li>\n<li>controller.java.vm 无需修改，保留原有的接口方法和命名</li>\n</ul>\n</blockquote>\n<p><strong>mapper.java.vm</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.mapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;subClassName&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Mapper接口</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Mapper</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">$</span>&#123;ClassName&#125;Mapper <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseMapper</span>&lt;$&#123;ClassName&#125;&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;ClassName&#125; select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;集合</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;ClassName&#125;&gt; select$&#123;ClassName&#125;List($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> insert$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> update$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的数据主键集合</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;subTable.functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的数据主键集合</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量新增$&#123;subTable.functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;subclassName&#125;List $&#123;subTable.functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> batch$&#123;subClassName&#125;(List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List);</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过$&#123;functionName&#125;主键删除$&#123;subTable.functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">#end</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>service.java.vm</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Service接口</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">I$</span>&#123;ClassName&#125;Service <span class=\"keyword\">extends</span> <span class=\"title class_\">IService</span>&lt;$&#123;ClassName&#125;&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;ClassName&#125; select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;集合</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;ClassName&#125;&gt; select$&#123;ClassName&#125;List($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> insert$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> update$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的$&#123;functionName&#125;主键集合</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>serviceImpl.java.vm</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.service.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\">#foreach ($column in $columns)</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField == <span class=\"string\">&#x27;createTime&#x27;</span> || $column.javaField == <span class=\"string\">&#x27;updateTime&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.DateUtils;</span><br><span class=\"line\">#<span class=\"keyword\">break</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.StringUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;subClassName&#125;;</span><br><span class=\"line\">#end</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.mapper.$&#123;ClassName&#125;Mapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.service.I$&#123;ClassName&#125;Service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.mapper.$&#123;ClassName&#125;Mapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Service业务层处理</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125;ServiceImpl <span class=\"keyword\">extends</span> <span class=\"title class_\">ServiceImpl</span>&lt;$&#123;ClassName&#125;Mapper, $&#123;ClassName&#125;&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">I$</span>&#123;ClassName&#125;Service</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> $&#123;ClassName&#125;Mapper $&#123;className&#125;Mapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;ClassName&#125; select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        ##<span class=\"keyword\">return</span> $&#123;className&#125;Mapper.select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getById($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;$&#123;ClassName&#125;&gt; select$&#123;ClassName&#125;List($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> insert$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#foreach ($column in $columns)   删除这些 新增的时候，给创建时间赋值</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField == <span class=\"string\">&#x27;createTime&#x27;</span>)</span><br><span class=\"line\">        $&#123;className&#125;.setCreateTime(DateUtils.getNowDate());</span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rows</span> <span class=\"operator\">=</span> $&#123;className&#125;Mapper.insert$&#123;ClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        insert$&#123;subClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rows;</span><br><span class=\"line\">#<span class=\"keyword\">else</span></span><br><span class=\"line\">        ##<span class=\"keyword\">return</span> $&#123;className&#125;Mapper.insert$&#123;ClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> save($&#123;className&#125;) == <span class=\"literal\">true</span>? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">#end</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> update$&#123;ClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#foreach ($column in $columns)  删除这些，修改的时候给修改时间赋值</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($column.javaField == <span class=\"string\">&#x27;updateTime&#x27;</span>)</span><br><span class=\"line\">        $&#123;className&#125;.setUpdateTime(DateUtils.getNowDate());</span><br><span class=\"line\">#end</span><br><span class=\"line\">#end</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        $&#123;className&#125;Mapper.delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;($&#123;className&#125;.get$&#123;pkColumn.capJavaField&#125;());</span><br><span class=\"line\">        insert$&#123;subClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">#end</span><br><span class=\"line\">##        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.update$&#123;ClassName&#125;($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> updateById($&#123;className&#125;) == <span class=\"literal\">true</span> ? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 批量删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125;s 需要删除的$&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        $&#123;className&#125;Mapper.delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;s($&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">#end</span><br><span class=\"line\">##        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaField&#125;s);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> removeByIds(Arrays.asList($&#123;pkColumn.javaField&#125;s)) == <span class=\"literal\">true</span> ? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;pkColumn.javaField&#125; $&#123;functionName&#125;主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 结果</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">    <span class=\"meta\">@Transactional</span></span><br><span class=\"line\">#end</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\">        $&#123;className&#125;Mapper.delete$&#123;subClassName&#125;By$&#123;subTableFkClassName&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">#end</span><br><span class=\"line\">##        <span class=\"keyword\">return</span> $&#123;className&#125;Mapper.delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> removeById($&#123;pkColumn.javaField&#125;) == <span class=\"literal\">true</span> ? <span class=\"number\">1</span> : <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.sub)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;subTable.functionName&#125;信息</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> $&#123;className&#125; $&#123;functionName&#125;对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> insert$&#123;subClassName&#125;($&#123;ClassName&#125; $&#123;className&#125;)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        List&lt;$&#123;subClassName&#125;&gt; $&#123;subclassName&#125;List = $&#123;className&#125;.get$&#123;subClassName&#125;List();</span><br><span class=\"line\">        $&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125; = $&#123;className&#125;.get$&#123;pkColumn.capJavaField&#125;();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (StringUtils.isNotNull($&#123;subclassName&#125;List))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            List&lt;$&#123;subClassName&#125;&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;$&#123;subClassName&#125;&gt;();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> ($&#123;subClassName&#125; $&#123;subclassName&#125; : $&#123;subclassName&#125;List)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                $&#123;subclassName&#125;.set$&#123;subTableFkClassName&#125;($&#123;pkColumn.javaField&#125;);</span><br><span class=\"line\">                list.add($&#123;subclassName&#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (list.size() &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                $&#123;className&#125;Mapper.batch$&#123;subClassName&#125;(list);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#end</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>其他必要修改</strong></p>\n<p>集成MP之后，项目中的BaseEntity类中的字段有些会受影响，需要添加如下注解</p>\n<p>由于这几个字段，并不会跟数据库中的表字段进行映射，必须要添加@TableField(exist &#x3D; false)表示，表示该字段不存在于数据库表中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Entity基类</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> ruoyi</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BaseEntity</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 搜索值 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String searchValue;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 请求参数 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonInclude(JsonInclude.Include.NON_EMPTY)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, Object&gt; params;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-4、字段自动填充\"><a href=\"#4-4、字段自动填充\" class=\"headerlink\" title=\"4.4、字段自动填充\"></a>4.4、字段自动填充</h3><p>MyBatis-Plus 提供的字段自动填充功能是一种非常实用的特性，它能够在插入或更新数据库记录时自动填充一些公共字段，如创建时间（createTime）、更新时间（updateTime）、创建人（createBy）、更新人（updateBy）等。这一功能极大地简化了开发过程，减少了重复的代码编写，提高了开发效率。</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-06-29.jpg\"></p>\n<p>官网链接：<a href=\"https://mybatis.plus/guide/auto-fill-metainfo.html%EF%BC%88%E5%8F%AF%E8%83%BD%E6%89%93%E4%B8%8D%E5%BC%80%EF%BC%8C%E5%AE%98%E7%BD%91%E6%9C%AC%E8%BA%AB%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%89\">https://mybatis.plus/guide/auto-fill-metainfo.html（可能打不开，官网本身的问题）</a></p>\n<p>在MybatisPlus中通过两步可以实现这个功能：</p>\n<p>1、在实体类中，使用<code>@TableField</code>注解，来标明哪些字段是需要自动填充的，并且需要指定填充策略</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.zzyl.common.core.domain;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.Serializable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.FieldFill;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.fasterxml.jackson.annotation.JsonFormat;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.fasterxml.jackson.annotation.JsonInclude;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiModel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Entity基类</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> ruoyi</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@ApiModel(&quot;Entity基类&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BaseEntity</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 搜索值 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String searchValue;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 创建者 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;创建者&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.INSERT)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String createBy;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 创建时间 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;创建时间&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.INSERT)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date createTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 更新者 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;更新者&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.UPDATE)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String updateBy;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 更新时间 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;更新时间&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(fill = FieldFill.UPDATE)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date updateTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 备注 */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;备注&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String remark;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 请求参数 */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonInclude(JsonInclude.Include.NON_EMPTY)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;请求参数&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, Object&gt; params;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>2、在zzyl-framework模块中新增MyMetaObjectHandler 来处理自动自动填充</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-07-54.jpg\"></p>\n<p>详细的代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.zzyl.framework.interceptor;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.model.LoginUser;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.SecurityUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.ObjectUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.reflection.MetaObject;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyMetaObjectHandler</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">MetaObjectHandler</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insertFill</span><span class=\"params\">(MetaObject metaObject)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictInsertFill(metaObject, <span class=\"string\">&quot;createTime&quot;</span>, Date.class, <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictInsertFill(metaObject, <span class=\"string\">&quot;createBy&quot;</span>, String.class, loadUserId()+<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">updateFill</span><span class=\"params\">(MetaObject metaObject)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictUpdateFill(metaObject, <span class=\"string\">&quot;updateTime&quot;</span>, Date.class, <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.strictUpdateFill(metaObject, <span class=\"string\">&quot;updateBy&quot;</span>, String.class, loadUserId()+<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取当前登录人的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Long <span class=\"title function_\">loadUserId</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//获取当前登录人的id</span></span><br><span class=\"line\">        <span class=\"type\">LoginUser</span> <span class=\"variable\">loginUser</span> <span class=\"operator\">=</span> SecurityUtils.getLoginUser();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(ObjectUtils.isNotEmpty(loginUser))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> loginUser.getUserId();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1L</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5、Swagger集成\"><a href=\"#5、Swagger集成\" class=\"headerlink\" title=\"5、Swagger集成\"></a>5、Swagger集成</h2><p>在我们定义的所有controller中，为了更好的体现接口文档，我们都需要添加swagger注解才可以。这些注解我们也可以通过代码的模板来生成，节省我们的开发工作</p>\n<p>我们主要的工作就是来修改<strong>controller.java.vm</strong>文件即可，具体的修改的内容如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;packageName&#125;.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.Api;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiOperation;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiParam;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.security.access.prepost.PreAuthorize;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.DeleteMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.annotation.Log;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.controller.BaseController;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.domain.AjaxResult;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.enums.BusinessType;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.domain.$&#123;ClassName&#125;;</span><br><span class=\"line\"><span class=\"keyword\">import</span> $&#123;packageName&#125;.service.I$&#123;ClassName&#125;Service;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.utils.poi.ExcelUtil;</span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zzyl.common.core.page.TableDataInfo;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;functionName&#125;Controller</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;author&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> $&#123;datetime&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/$&#123;moduleName&#125;/$&#123;businessName&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Api(tags =  &quot;$&#123;functionName&#125;相关接口&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;ClassName&#125;Controller <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseController</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> I$&#123;ClassName&#125;Service $&#123;className&#125;Service;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:list&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/list&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;查询$&#123;functionName&#125;列表&quot;)</span></span><br><span class=\"line\">#<span class=\"keyword\">if</span>($table.crud || $table.sub)</span><br><span class=\"line\">    <span class=\"keyword\">public</span> TableDataInfo <span class=\"title function_\">list</span><span class=\"params\">($&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        startPage();</span><br><span class=\"line\">        List&lt;$&#123;ClassName&#125;&gt; list = $&#123;className&#125;Service.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getDataTable(list);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#elseif($table.tree)</span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">list</span><span class=\"params\">($&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        List&lt;$&#123;ClassName&#125;&gt; list = $&#123;className&#125;Service.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(list);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">#end</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 导出$&#123;functionName&#125;列表</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:export&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.EXPORT)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/export&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;导出$&#123;functionName&#125;列表&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">export</span><span class=\"params\">(HttpServletResponse response, $&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        List&lt;$&#123;ClassName&#125;&gt; list = $&#123;className&#125;Service.select$&#123;ClassName&#125;List($&#123;className&#125;);</span><br><span class=\"line\">        ExcelUtil&lt;$&#123;ClassName&#125;&gt; util = <span class=\"keyword\">new</span> <span class=\"title class_\">ExcelUtil</span>&lt;$&#123;ClassName&#125;&gt;($&#123;ClassName&#125;.class);</span><br><span class=\"line\">        util.exportExcel(response, list, <span class=\"string\">&quot;$&#123;functionName&#125;数据&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取$&#123;functionName&#125;详细信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:query&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(value = &quot;/&#123;$&#123;pkColumn.javaField&#125;&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;获取$&#123;functionName&#125;详细信息&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">getInfo</span><span class=\"params\">(<span class=\"meta\">@ApiParam(value = &quot;$&#123;functionName&#125;ID&quot;, required = true)</span></span></span><br><span class=\"line\"><span class=\"params\">                                  <span class=\"meta\">@PathVariable(&quot;$&#123;pkColumn.javaField&#125;&quot;)</span> $&#123;pkColumn.javaType&#125; $&#123;pkColumn.javaField&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success($&#123;className&#125;Service.select$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;($&#123;pkColumn.javaField&#125;));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 新增$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:add&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.INSERT)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;新增$&#123;functionName&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"meta\">@ApiParam(value = &quot;$&#123;functionName&#125;实体&quot;, required = true)</span> <span class=\"meta\">@RequestBody</span> $&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> toAjax($&#123;className&#125;Service.insert$&#123;ClassName&#125;($&#123;className&#125;));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 修改$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:edit&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.UPDATE)</span></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;修改$&#123;functionName&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">edit</span><span class=\"params\">(<span class=\"meta\">@ApiParam(value = &quot;$&#123;functionName&#125;实体&quot;, required = true)</span>  <span class=\"meta\">@RequestBody</span> $&#123;ClassName&#125; $&#123;className&#125;)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> toAjax($&#123;className&#125;Service.update$&#123;ClassName&#125;($&#123;className&#125;));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除$&#123;functionName&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PreAuthorize(&quot;@ss.hasPermi(&#x27;$&#123;permissionPrefix&#125;:remove&#x27;)&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Log(title = &quot;$&#123;functionName&#125;&quot;, businessType = BusinessType.DELETE)</span></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping(&quot;/&#123;$&#123;pkColumn.javaField&#125;s&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;删除$&#123;functionName&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AjaxResult <span class=\"title function_\">remove</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> $&#123;pkColumn.javaType&#125;[] $&#123;pkColumn.javaField&#125;s)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> toAjax($&#123;className&#125;Service.delete$&#123;ClassName&#125;By$&#123;pkColumn.capJavaField&#125;s($&#123;pkColumn.javaField&#125;s));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>重启服务之后，我们可以预览生成后的效果：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-18-37.jpg\"></p>\n<h2 id=\"6、由Date类型改为LocalDateTime\"><a href=\"#6、由Date类型改为LocalDateTime\" class=\"headerlink\" title=\"6、由Date类型改为LocalDateTime\"></a>6、由Date类型改为LocalDateTime</h2><p>若依目前提供的代码中，如果遇到日期类型则使用的是Date，由于目前使用比较流行的是LocalDateTime类型，我们也可以把它改为该类型进行使用</p>\n<blockquote>\n<p><strong>知识扩展</strong></p>\n<p>Date类型与LocalDateTime的区别？</p>\n<ol>\n<li>不可变性与线程安全性 <ol>\n<li>Date一旦创建Date对象，可以通过setTime(long time)进行修改，多线程下存在线程安全问题</li>\n<li>LocalDateTime是不可变的，线程安全</li>\n</ol>\n</li>\n<li>时间精度<ol>\n<li>Date可以表示到毫秒的时间值</li>\n<li>LocalDateTime可以表示到纳秒的时间值</li>\n</ol>\n</li>\n<li>易用性：LocalDateTime的API设计的更现代化，易于使用</li>\n</ol>\n</blockquote>\n<p>在目前代码生成中，其中字段详细这一栏中的Java类型并不支持LocalDateTime类型，所以我们需要在前端也要修改其内容，让它支持LocalDateTime</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-12.jpg\"></p>\n<p>打开前端项目，找到src&#x2F;views&#x2F;tool&#x2F;gen&#x2F;editTable.vue文件，在这个文件添加中以上一行代码，如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-20-23.jpg\"></p>\n<p>当前端选择了LocalDateTime类型之后，在后端的代码生成中，需要导入对应的包才可以，后端的代码也需要修改</p>\n<p>我们打开VelocityUtils类，这里面有处理导入包的逻辑，找到getImportList方法，在其中添加对应的包导入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * 根据列类型获取导入包</span><br><span class=\"line\"> * </span><br><span class=\"line\"> * @param genTable 业务表对象</span><br><span class=\"line\"> * @return 返回需要导入的包列表</span><br><span class=\"line\"> */</span><br><span class=\"line\">public static HashSet&lt;String&gt; getImportList(GenTable genTable)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    List&lt;GenTableColumn&gt; columns = genTable.getColumns();</span><br><span class=\"line\">    GenTable subGenTable = genTable.getSubTable();</span><br><span class=\"line\">    HashSet&lt;String&gt; importList = new HashSet&lt;String&gt;();</span><br><span class=\"line\">    if (StringUtils.isNotNull(subGenTable))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        importList.add(&quot;java.util.List&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    for (GenTableColumn column : columns)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if (!column.isSuperColumn() &amp;&amp; GenConstants.TYPE_DATE.equals(column.getJavaType()))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            importList.add(&quot;java.util.Date&quot;);</span><br><span class=\"line\">            importList.add(&quot;com.fasterxml.jackson.annotation.JsonFormat&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else if (!column.isSuperColumn() &amp;&amp; GenConstants.TYPE_BIGDECIMAL.equals(column.getJavaType()))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            importList.add(&quot;java.math.BigDecimal&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        //加入下面这些功能</span><br><span class=\"line\">        // 如果字段类型在前端选择的是LocalDateTime，则导入对应的包</span><br><span class=\"line\">        if (!column.isSuperColumn() &amp;&amp; &quot;LocalDateTime&quot;.equals(column.getJavaType()))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            importList.add(&quot;java.time.LocalDateTime&quot;);</span><br><span class=\"line\">            //导入这个是为了格式化日期</span><br><span class=\"line\">            importList.add(&quot;com.fasterxml.jackson.annotation.JsonFormat&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return importList;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>修改模块文件domain.java.vm文件，修改的内容如下：</p>\n<p><img src=\"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/Snipaste_2025-11-04_15-22-43.jpg\"></p>\n","popularPost_tmp_postPath":true,"eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/image.png","popularPost_tmp_gaData":{"updated":"Wed Nov 05 2025 10:15:07 GMT+0800 (中国标准时间)","title":"若依框架中使用Velocity模块引擎改造代码生成功能","path":"2025/09/04/若依框架中使用Velocity模块引擎改造代码生成功能/","eyeCatchImage":"https://raw.githubusercontent.com/zhangzc-hub/img/main/img/image.png","excerpt":null,"date":{"_isAMomentObject":true,"_i":"2025-09-04T06:10:15.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2025-09-04T06:10:15.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"Java","tags":["若依"],"internalLinks":[],"keywords":[],"keywordsLength":0}},{"title":"MySQL常见数据类型","date":"2024-04-05T02:12:54.000Z","_content":"\n# MySQL常见数据类型\n\nMySQL中的数据类型有很多，主要分为三类：**数值类型、字符串类型、日期时间类型**。\n\n## 1、**数值类型**\n\n| 类型        | 大小   | 有符号(SIGNED)范围                                    | 无符号(UNSIGNED)范围                                      | 描述               |\n| ----------- | ------ | ----------------------------------------------------- | --------------------------------------------------------- | ------------------ |\n| TINYINT     | 1byte  | (-128，127)                                           | (0，255)                                                  | 小整数值           |\n| SMALLINT    | 2bytes | (-32768，32767)                                       | (0，65535)                                                | 大整数值           |\n| MEDIUMINT   | 3bytes | (-8388608，8388607)                                   | (0，16777215)                                             | 大整数值           |\n| INT/INTEGER | 4bytes | (-2147483648，2147483647)                             | (0，4294967295)                                           | 大整数值           |\n| BIGINT      | 8bytes | (-2^63，2^63-1)                                       | (0，2^64-1)                                               | 极大整数值         |\n| FLOAT       | 4bytes | (-3.402823466 E+38，3.402823466351 E+38)              | 0 和 (1.175494351 E-38，3.402823466 E+38)                 | 单精度浮点数值     |\n| DOUBLE      | 8bytes | (-1.7976931348623157 E+308，1.7976931348623157 E+308) | 0 和 (2.2250738585072014 E-308，1.7976931348623157 E+308) | 双精度浮点数值     |\n| DECIMAL     |        | 依赖于M(精度)和D(标度)的值                            | 依赖于M(精度)和D(标度)的值                                | 小数值(精确定点数) |\n\n## 2、**字符串类型**\n\n| 类型       | 大小                  | 描述                         |\n| ---------- | --------------------- | ---------------------------- |\n| CHAR       | 0-255 bytes           | 定长字符串(需要指定长度)     |\n| VARCHAR    | 0-65535 bytes         | 变长字符串(需要指定长度)     |\n| TINYBLOB   | 0-255 bytes           | 不超过255个字符的二进制数据  |\n| TINYTEXT   | 0-255 bytes           | 短文本字符串                 |\n| BLOB       | 0-65 535 bytes        | 二进制形式的长文本数据       |\n| TEXT       | 0-65 535 bytes        | 长文本数据                   |\n| MEDIUMBLOB | 0-16 777 215 bytes    | 二进制形式的中等长度文本数据 |\n| MEDIUMTEXT | 0-16 777 215 bytes    | 中等长度文本数据             |\n| LONGBLOB   | 0-4 294 967 295 bytes | 二进制形式的极大文本数据     |\n| LONGTEXT   | 0-4 294 967 295 bytes | 极大文本数据                 |\n\nchar 与 varchar 都可以描述字符串，char是定长字符串，指定长度多长，就占用多少个字符，和字段值的长度无关 。而varchar是变长字符串，指定的长度为最大占用长度 。相对来说，char的性能会更高些。\n\n## 3、**日期时间类型**\n\n| 类型      | 大小 | 范围                                       | 格式                | 描述                     |\n| --------- | ---- | ------------------------------------------ | ------------------- | ------------------------ |\n| DATE      | 3    | 1000-01-01 至 9999-12-31                   | YYYY-MM-DD          | 日期值                   |\n| TIME      | 3    | -838:59:59 至 838:59:59                    | HH:MM:SS            | 时间值或持续时间         |\n| YEAR      | 1    | 1901 至 2155                               | YYYY                | 年份值                   |\n| DATETIME  | 8    | 1000-01-01 00:00:00 至 9999-12-31 23:59:59 | YYYY-MM-DD HH:MM:SS | 混合日期和时间值         |\n| TIMESTAMP | 4    | 1970-01-01 00:00:01 至 2038-01-19 03:14:07 | YYYY-MM-DD HH:MM:SS | 混合日期和时间值，时间戳 |\n","source":"_posts/MySQL常见数据类型.md","raw":"---\ntitle: MySQL常见数据类型\ndate: 2024-04-05 10:12:54\ntags:\n- MySQL\ncategories:\n- MySQL\n---\n\n# MySQL常见数据类型\n\nMySQL中的数据类型有很多，主要分为三类：**数值类型、字符串类型、日期时间类型**。\n\n## 1、**数值类型**\n\n| 类型        | 大小   | 有符号(SIGNED)范围                                    | 无符号(UNSIGNED)范围                                      | 描述               |\n| ----------- | ------ | ----------------------------------------------------- | --------------------------------------------------------- | ------------------ |\n| TINYINT     | 1byte  | (-128，127)                                           | (0，255)                                                  | 小整数值           |\n| SMALLINT    | 2bytes | (-32768，32767)                                       | (0，65535)                                                | 大整数值           |\n| MEDIUMINT   | 3bytes | (-8388608，8388607)                                   | (0，16777215)                                             | 大整数值           |\n| INT/INTEGER | 4bytes | (-2147483648，2147483647)                             | (0，4294967295)                                           | 大整数值           |\n| BIGINT      | 8bytes | (-2^63，2^63-1)                                       | (0，2^64-1)                                               | 极大整数值         |\n| FLOAT       | 4bytes | (-3.402823466 E+38，3.402823466351 E+38)              | 0 和 (1.175494351 E-38，3.402823466 E+38)                 | 单精度浮点数值     |\n| DOUBLE      | 8bytes | (-1.7976931348623157 E+308，1.7976931348623157 E+308) | 0 和 (2.2250738585072014 E-308，1.7976931348623157 E+308) | 双精度浮点数值     |\n| DECIMAL     |        | 依赖于M(精度)和D(标度)的值                            | 依赖于M(精度)和D(标度)的值                                | 小数值(精确定点数) |\n\n## 2、**字符串类型**\n\n| 类型       | 大小                  | 描述                         |\n| ---------- | --------------------- | ---------------------------- |\n| CHAR       | 0-255 bytes           | 定长字符串(需要指定长度)     |\n| VARCHAR    | 0-65535 bytes         | 变长字符串(需要指定长度)     |\n| TINYBLOB   | 0-255 bytes           | 不超过255个字符的二进制数据  |\n| TINYTEXT   | 0-255 bytes           | 短文本字符串                 |\n| BLOB       | 0-65 535 bytes        | 二进制形式的长文本数据       |\n| TEXT       | 0-65 535 bytes        | 长文本数据                   |\n| MEDIUMBLOB | 0-16 777 215 bytes    | 二进制形式的中等长度文本数据 |\n| MEDIUMTEXT | 0-16 777 215 bytes    | 中等长度文本数据             |\n| LONGBLOB   | 0-4 294 967 295 bytes | 二进制形式的极大文本数据     |\n| LONGTEXT   | 0-4 294 967 295 bytes | 极大文本数据                 |\n\nchar 与 varchar 都可以描述字符串，char是定长字符串，指定长度多长，就占用多少个字符，和字段值的长度无关 。而varchar是变长字符串，指定的长度为最大占用长度 。相对来说，char的性能会更高些。\n\n## 3、**日期时间类型**\n\n| 类型      | 大小 | 范围                                       | 格式                | 描述                     |\n| --------- | ---- | ------------------------------------------ | ------------------- | ------------------------ |\n| DATE      | 3    | 1000-01-01 至 9999-12-31                   | YYYY-MM-DD          | 日期值                   |\n| TIME      | 3    | -838:59:59 至 838:59:59                    | HH:MM:SS            | 时间值或持续时间         |\n| YEAR      | 1    | 1901 至 2155                               | YYYY                | 年份值                   |\n| DATETIME  | 8    | 1000-01-01 00:00:00 至 9999-12-31 23:59:59 | YYYY-MM-DD HH:MM:SS | 混合日期和时间值         |\n| TIMESTAMP | 4    | 1970-01-01 00:00:01 至 2038-01-19 03:14:07 | YYYY-MM-DD HH:MM:SS | 混合日期和时间值，时间戳 |\n","slug":"MySQL常见数据类型","published":1,"updated":"2025-11-05T02:20:27.322Z","comments":1,"layout":"post","photos":[],"_id":"cmhldgkcb0000d8am4p373syb","content":"<h1 id=\"MySQL常见数据类型\"><a href=\"#MySQL常见数据类型\" class=\"headerlink\" title=\"MySQL常见数据类型\"></a>MySQL常见数据类型</h1><p>MySQL中的数据类型有很多，主要分为三类：<strong>数值类型、字符串类型、日期时间类型</strong>。</p>\n<h2 id=\"1、数值类型\"><a href=\"#1、数值类型\" class=\"headerlink\" title=\"1、数值类型\"></a>1、<strong>数值类型</strong></h2><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>大小</th>\n<th>有符号(SIGNED)范围</th>\n<th>无符号(UNSIGNED)范围</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>TINYINT</td>\n<td>1byte</td>\n<td>(-128，127)</td>\n<td>(0，255)</td>\n<td>小整数值</td>\n</tr>\n<tr>\n<td>SMALLINT</td>\n<td>2bytes</td>\n<td>(-32768，32767)</td>\n<td>(0，65535)</td>\n<td>大整数值</td>\n</tr>\n<tr>\n<td>MEDIUMINT</td>\n<td>3bytes</td>\n<td>(-8388608，8388607)</td>\n<td>(0，16777215)</td>\n<td>大整数值</td>\n</tr>\n<tr>\n<td>INT&#x2F;INTEGER</td>\n<td>4bytes</td>\n<td>(-2147483648，2147483647)</td>\n<td>(0，4294967295)</td>\n<td>大整数值</td>\n</tr>\n<tr>\n<td>BIGINT</td>\n<td>8bytes</td>\n<td>(-2^63，2^63-1)</td>\n<td>(0，2^64-1)</td>\n<td>极大整数值</td>\n</tr>\n<tr>\n<td>FLOAT</td>\n<td>4bytes</td>\n<td>(-3.402823466 E+38，3.402823466351 E+38)</td>\n<td>0 和 (1.175494351 E-38，3.402823466 E+38)</td>\n<td>单精度浮点数值</td>\n</tr>\n<tr>\n<td>DOUBLE</td>\n<td>8bytes</td>\n<td>(-1.7976931348623157 E+308，1.7976931348623157 E+308)</td>\n<td>0 和 (2.2250738585072014 E-308，1.7976931348623157 E+308)</td>\n<td>双精度浮点数值</td>\n</tr>\n<tr>\n<td>DECIMAL</td>\n<td></td>\n<td>依赖于M(精度)和D(标度)的值</td>\n<td>依赖于M(精度)和D(标度)的值</td>\n<td>小数值(精确定点数)</td>\n</tr>\n</tbody></table>\n<h2 id=\"2、字符串类型\"><a href=\"#2、字符串类型\" class=\"headerlink\" title=\"2、字符串类型\"></a>2、<strong>字符串类型</strong></h2><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>大小</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>CHAR</td>\n<td>0-255 bytes</td>\n<td>定长字符串(需要指定长度)</td>\n</tr>\n<tr>\n<td>VARCHAR</td>\n<td>0-65535 bytes</td>\n<td>变长字符串(需要指定长度)</td>\n</tr>\n<tr>\n<td>TINYBLOB</td>\n<td>0-255 bytes</td>\n<td>不超过255个字符的二进制数据</td>\n</tr>\n<tr>\n<td>TINYTEXT</td>\n<td>0-255 bytes</td>\n<td>短文本字符串</td>\n</tr>\n<tr>\n<td>BLOB</td>\n<td>0-65 535 bytes</td>\n<td>二进制形式的长文本数据</td>\n</tr>\n<tr>\n<td>TEXT</td>\n<td>0-65 535 bytes</td>\n<td>长文本数据</td>\n</tr>\n<tr>\n<td>MEDIUMBLOB</td>\n<td>0-16 777 215 bytes</td>\n<td>二进制形式的中等长度文本数据</td>\n</tr>\n<tr>\n<td>MEDIUMTEXT</td>\n<td>0-16 777 215 bytes</td>\n<td>中等长度文本数据</td>\n</tr>\n<tr>\n<td>LONGBLOB</td>\n<td>0-4 294 967 295 bytes</td>\n<td>二进制形式的极大文本数据</td>\n</tr>\n<tr>\n<td>LONGTEXT</td>\n<td>0-4 294 967 295 bytes</td>\n<td>极大文本数据</td>\n</tr>\n</tbody></table>\n<p>char 与 varchar 都可以描述字符串，char是定长字符串，指定长度多长，就占用多少个字符，和字段值的长度无关 。而varchar是变长字符串，指定的长度为最大占用长度 。相对来说，char的性能会更高些。</p>\n<h2 id=\"3、日期时间类型\"><a href=\"#3、日期时间类型\" class=\"headerlink\" title=\"3、日期时间类型\"></a>3、<strong>日期时间类型</strong></h2><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>大小</th>\n<th>范围</th>\n<th>格式</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>DATE</td>\n<td>3</td>\n<td>1000-01-01 至 9999-12-31</td>\n<td>YYYY-MM-DD</td>\n<td>日期值</td>\n</tr>\n<tr>\n<td>TIME</td>\n<td>3</td>\n<td>-838:59:59 至 838:59:59</td>\n<td>HH:MM:SS</td>\n<td>时间值或持续时间</td>\n</tr>\n<tr>\n<td>YEAR</td>\n<td>1</td>\n<td>1901 至 2155</td>\n<td>YYYY</td>\n<td>年份值</td>\n</tr>\n<tr>\n<td>DATETIME</td>\n<td>8</td>\n<td>1000-01-01 00:00:00 至 9999-12-31 23:59:59</td>\n<td>YYYY-MM-DD HH:MM:SS</td>\n<td>混合日期和时间值</td>\n</tr>\n<tr>\n<td>TIMESTAMP</td>\n<td>4</td>\n<td>1970-01-01 00:00:01 至 2038-01-19 03:14:07</td>\n<td>YYYY-MM-DD HH:MM:SS</td>\n<td>混合日期和时间值，时间戳</td>\n</tr>\n</tbody></table>\n","excerpt":"","more":"<h1 id=\"MySQL常见数据类型\"><a href=\"#MySQL常见数据类型\" class=\"headerlink\" title=\"MySQL常见数据类型\"></a>MySQL常见数据类型</h1><p>MySQL中的数据类型有很多，主要分为三类：<strong>数值类型、字符串类型、日期时间类型</strong>。</p>\n<h2 id=\"1、数值类型\"><a href=\"#1、数值类型\" class=\"headerlink\" title=\"1、数值类型\"></a>1、<strong>数值类型</strong></h2><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>大小</th>\n<th>有符号(SIGNED)范围</th>\n<th>无符号(UNSIGNED)范围</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>TINYINT</td>\n<td>1byte</td>\n<td>(-128，127)</td>\n<td>(0，255)</td>\n<td>小整数值</td>\n</tr>\n<tr>\n<td>SMALLINT</td>\n<td>2bytes</td>\n<td>(-32768，32767)</td>\n<td>(0，65535)</td>\n<td>大整数值</td>\n</tr>\n<tr>\n<td>MEDIUMINT</td>\n<td>3bytes</td>\n<td>(-8388608，8388607)</td>\n<td>(0，16777215)</td>\n<td>大整数值</td>\n</tr>\n<tr>\n<td>INT&#x2F;INTEGER</td>\n<td>4bytes</td>\n<td>(-2147483648，2147483647)</td>\n<td>(0，4294967295)</td>\n<td>大整数值</td>\n</tr>\n<tr>\n<td>BIGINT</td>\n<td>8bytes</td>\n<td>(-2^63，2^63-1)</td>\n<td>(0，2^64-1)</td>\n<td>极大整数值</td>\n</tr>\n<tr>\n<td>FLOAT</td>\n<td>4bytes</td>\n<td>(-3.402823466 E+38，3.402823466351 E+38)</td>\n<td>0 和 (1.175494351 E-38，3.402823466 E+38)</td>\n<td>单精度浮点数值</td>\n</tr>\n<tr>\n<td>DOUBLE</td>\n<td>8bytes</td>\n<td>(-1.7976931348623157 E+308，1.7976931348623157 E+308)</td>\n<td>0 和 (2.2250738585072014 E-308，1.7976931348623157 E+308)</td>\n<td>双精度浮点数值</td>\n</tr>\n<tr>\n<td>DECIMAL</td>\n<td></td>\n<td>依赖于M(精度)和D(标度)的值</td>\n<td>依赖于M(精度)和D(标度)的值</td>\n<td>小数值(精确定点数)</td>\n</tr>\n</tbody></table>\n<h2 id=\"2、字符串类型\"><a href=\"#2、字符串类型\" class=\"headerlink\" title=\"2、字符串类型\"></a>2、<strong>字符串类型</strong></h2><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>大小</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>CHAR</td>\n<td>0-255 bytes</td>\n<td>定长字符串(需要指定长度)</td>\n</tr>\n<tr>\n<td>VARCHAR</td>\n<td>0-65535 bytes</td>\n<td>变长字符串(需要指定长度)</td>\n</tr>\n<tr>\n<td>TINYBLOB</td>\n<td>0-255 bytes</td>\n<td>不超过255个字符的二进制数据</td>\n</tr>\n<tr>\n<td>TINYTEXT</td>\n<td>0-255 bytes</td>\n<td>短文本字符串</td>\n</tr>\n<tr>\n<td>BLOB</td>\n<td>0-65 535 bytes</td>\n<td>二进制形式的长文本数据</td>\n</tr>\n<tr>\n<td>TEXT</td>\n<td>0-65 535 bytes</td>\n<td>长文本数据</td>\n</tr>\n<tr>\n<td>MEDIUMBLOB</td>\n<td>0-16 777 215 bytes</td>\n<td>二进制形式的中等长度文本数据</td>\n</tr>\n<tr>\n<td>MEDIUMTEXT</td>\n<td>0-16 777 215 bytes</td>\n<td>中等长度文本数据</td>\n</tr>\n<tr>\n<td>LONGBLOB</td>\n<td>0-4 294 967 295 bytes</td>\n<td>二进制形式的极大文本数据</td>\n</tr>\n<tr>\n<td>LONGTEXT</td>\n<td>0-4 294 967 295 bytes</td>\n<td>极大文本数据</td>\n</tr>\n</tbody></table>\n<p>char 与 varchar 都可以描述字符串，char是定长字符串，指定长度多长，就占用多少个字符，和字段值的长度无关 。而varchar是变长字符串，指定的长度为最大占用长度 。相对来说，char的性能会更高些。</p>\n<h2 id=\"3、日期时间类型\"><a href=\"#3、日期时间类型\" class=\"headerlink\" title=\"3、日期时间类型\"></a>3、<strong>日期时间类型</strong></h2><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>大小</th>\n<th>范围</th>\n<th>格式</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>DATE</td>\n<td>3</td>\n<td>1000-01-01 至 9999-12-31</td>\n<td>YYYY-MM-DD</td>\n<td>日期值</td>\n</tr>\n<tr>\n<td>TIME</td>\n<td>3</td>\n<td>-838:59:59 至 838:59:59</td>\n<td>HH:MM:SS</td>\n<td>时间值或持续时间</td>\n</tr>\n<tr>\n<td>YEAR</td>\n<td>1</td>\n<td>1901 至 2155</td>\n<td>YYYY</td>\n<td>年份值</td>\n</tr>\n<tr>\n<td>DATETIME</td>\n<td>8</td>\n<td>1000-01-01 00:00:00 至 9999-12-31 23:59:59</td>\n<td>YYYY-MM-DD HH:MM:SS</td>\n<td>混合日期和时间值</td>\n</tr>\n<tr>\n<td>TIMESTAMP</td>\n<td>4</td>\n<td>1970-01-01 00:00:01 至 2038-01-19 03:14:07</td>\n<td>YYYY-MM-DD HH:MM:SS</td>\n<td>混合日期和时间值，时间戳</td>\n</tr>\n</tbody></table>\n","popularPost_tmp_postPath":true,"eyeCatchImage":null,"popularPost_tmp_gaData":{"updated":"Wed Nov 05 2025 10:20:27 GMT+0800 (中国标准时间)","title":"MySQL常见数据类型","path":"2024/04/05/MySQL常见数据类型/","eyeCatchImage":null,"excerpt":null,"date":{"_isAMomentObject":true,"_i":"2024-04-05T02:12:54.000Z","_isUTC":false,"_pf":{"empty":false,"unusedTokens":[],"unusedInput":[],"overflow":-2,"charsLeftOver":0,"nullInput":false,"invalidEra":null,"invalidMonth":null,"invalidFormat":false,"userInvalidated":false,"iso":false,"parsedDateParts":[],"era":null,"meridiem":null,"rfc2822":false,"weekdayMismatch":false},"_locale":{"_calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"_longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"_invalidDate":"Invalid date","_dayOfMonthOrdinalParse":{},"_relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"_months":["January","February","March","April","May","June","July","August","September","October","November","December"],"_monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"_week":{"dow":0,"doy":6},"_weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"_weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"_weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"_meridiemParse":{},"_eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"_abbr":"en","_config":{"calendar":{"sameDay":"[Today at] LT","nextDay":"[Tomorrow at] LT","nextWeek":"dddd [at] LT","lastDay":"[Yesterday at] LT","lastWeek":"[Last] dddd [at] LT","sameElse":"L"},"longDateFormat":{"LTS":"h:mm:ss A","LT":"h:mm A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY h:mm A","LLLL":"dddd, MMMM D, YYYY h:mm A"},"invalidDate":"Invalid date","dayOfMonthOrdinalParse":{},"relativeTime":{"future":"in %s","past":"%s ago","s":"a few seconds","ss":"%d seconds","m":"a minute","mm":"%d minutes","h":"an hour","hh":"%d hours","d":"a day","dd":"%d days","w":"a week","ww":"%d weeks","M":"a month","MM":"%d months","y":"a year","yy":"%d years"},"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"week":{"dow":0,"doy":6},"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiemParse":{},"eras":[{"since":"0001-01-01","until":null,"offset":1,"name":"Anno Domini","narrow":"AD","abbr":"AD"},{"since":"0000-12-31","until":null,"offset":1,"name":"Before Christ","narrow":"BC","abbr":"BC"}],"abbr":"en"},"_dayOfMonthOrdinalParseLenient":{}},"_d":"2024-04-05T02:12:54.000Z","_isValid":true,"_z":null},"pv":0,"totalPV":0,"categories":"MySQL","tags":["MySQL"],"internalLinks":[],"keywords":[],"keywordsLength":0}}],"PostAsset":[],"PostCategory":[{"post_id":"cmck4zyra0001t0am67c6c7ro","category_id":"cmck4zyrd0004t0amay293dk5","_id":"cmck4zyri000gt0amdq8bbdlx"},{"post_id":"cmck4zyrg000at0am2uh4esnk","category_id":"cmck4zyrd0004t0amay293dk5","_id":"cmck4zyrj000jt0amcieo8nly"},{"post_id":"cmck4zyrc0003t0amd29efswv","category_id":"cmck4zyrh000bt0am0g674ay6","_id":"cmck4zyrk000mt0am4h7k1nhw"},{"post_id":"cmck4zyrf0007t0am1vz09i00","category_id":"cmck4zyrd0004t0amay293dk5","_id":"cmck4zyrk000pt0am8wfj9vaz"},{"post_id":"cmck4zyrg0009t0am58zccmnq","category_id":"cmck4zyrk000lt0amgpw1dykj","_id":"cmck4zyrl000tt0amesrl8721"},{"post_id":"cmck4zyrh000et0amfm3jdcuv","category_id":"cmck4zyrk000qt0am35jbetna","_id":"cmck4zyrl000xt0amf1jqg197"},{"post_id":"cmck4zyri000ft0am1z624h36","category_id":"cmck4zyrl000ut0amgxa6ae4v","_id":"cmck4zyrm0010t0am3ao12now"},{"post_id":"cme2819ck00009wam7kw0hmou","category_id":"cme2819co00019wam3h18ecda","_id":"cme2819cq00039wam7b5k2fww"},{"post_id":"cme9p6cfc0000xoamd92a6st8","category_id":"cme9p6cff0001xoam3gm3dqgg","_id":"cme9p6cfi0004xoamfmx948aw"},{"post_id":"cmhk8wmwn0000x0amb7mwh1kf","category_id":"cme2819co00019wam3h18ecda","_id":"cmhk8wmwp0002x0am2tuzbchi"},{"post_id":"cmhldgkcb0000d8am4p373syb","category_id":"cme9p6cff0001xoam3gm3dqgg","_id":"cmhldgkcd0002d8am9hjl86qi"}],"PostTag":[{"post_id":"cmck4zyra0001t0am67c6c7ro","tag_id":"cmck4zyre0005t0am81rxadm0","_id":"cmck4zyrh000dt0amhjjsaj32"},{"post_id":"cmck4zyrc0003t0amd29efswv","tag_id":"cmck4zyrh000ct0am6kenhd49","_id":"cmck4zyrk000kt0amg3rt8lmu"},{"post_id":"cmck4zyrf0007t0am1vz09i00","tag_id":"cmck4zyri000it0am9wr710cz","_id":"cmck4zyrk000ot0amczny9gov"},{"post_id":"cmck4zyrg0009t0am58zccmnq","tag_id":"cmck4zyrk000nt0am6jqt89c2","_id":"cmck4zyrl000st0amb13s97cg"},{"post_id":"cmck4zyrg000at0am2uh4esnk","tag_id":"cmck4zyrl000rt0am1mghecr5","_id":"cmck4zyrl000wt0am9aj8dfwq"},{"post_id":"cmck4zyrh000et0amfm3jdcuv","tag_id":"cmck4zyrl000vt0am1cha3rhy","_id":"cmck4zyrm000zt0am52f8c0oj"},{"post_id":"cmck4zyri000ft0am1z624h36","tag_id":"cmck4zyrl000yt0amdj7x06mp","_id":"cmck4zyrm0011t0am8r9l92bi"},{"post_id":"cme2819ck00009wam7kw0hmou","tag_id":"cmck4zyri000it0am9wr710cz","_id":"cme2819cq00029wamhp6odvhb"},{"post_id":"cme9p6cfc0000xoamd92a6st8","tag_id":"cme9p6cfh0002xoam1uo7g453","_id":"cme9p6cfh0003xoam1d4oe8xt"},{"post_id":"cmhk8wmwn0000x0amb7mwh1kf","tag_id":"cmhk8wmwn0001x0amb878fyet","_id":"cmhk8wmwp0003x0am5se3dt7p"},{"post_id":"cmhldgkcb0000d8am4p373syb","tag_id":"cme9p6cfh0002xoam1uo7g453","_id":"cmhldgkcc0001d8am6xd409c1"}],"Tag":[{"name":"docker","_id":"cmck4zyre0005t0am81rxadm0"},{"name":"ssl","_id":"cmck4zyrh000ct0am6kenhd49"},{"name":"redis","_id":"cmck4zyri000it0am9wr710cz"},{"name":"Hello World","_id":"cmck4zyrk000nt0am6jqt89c2"},{"name":"yum","_id":"cmck4zyrl000rt0am1mghecr5"},{"name":"语雀","_id":"cmck4zyrl000vt0am1cha3rhy"},{"name":"博客","_id":"cmck4zyrl000yt0amdj7x06mp"},{"name":"MySQL","_id":"cme9p6cfh0002xoam1uo7g453"},{"name":"若依","_id":"cmhk8wmwn0001x0amb878fyet"}]}}